
R version 3.1.3 (2015-03-09) -- "Smooth Sidewalk"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # wd <- "SET WORKING DIRECTORY HERE"
> wd <- "D:/Dropbox/Werk/Onderzoek/Reproducibility project"
> 
> ######################################################################################
> # Master script Tilburg University Analyses                                          #
> # Responsible for this file: CHJ Hartgerink (c.h.j.hartgerink@tilburguniversity.edu) # 
> #                            RCM van Aert (r.c.m.vanaert@tilburguniversity.edu)      #
> #                            MALM van Assen (m.a.l.m.vanassen@tilburguniversity.edu) #
> ######################################################################################
> 
> setwd(wd)
> # Read in Tilburg data
> MASTER <- read.csv('Copy of tilburg data 37 final.csv', sep = ";")[1:167, ]
> # source functions
> source('functions.r')
> library(Hmisc)
Loading required package: grid
Loading required package: lattice
Loading required package: survival
Loading required package: Formula
Loading required package: ggplot2

Attaching package: ‘Hmisc’

The following objects are masked from ‘package:base’:

    format.pval, round.POSIXt, trunc.POSIXt, units

> 
> # ALL ANALYSES INCLUDE PAIRWISE SELECTION.
> 
> #-----------------------------
> 
> # Writing out data for table
> # https://docs.google.com/spreadsheets/d/16aqIekNerZcflSJwM7dOiXnN24-KvZqaa3eTg4js41U/edit#gid=0
> # Columns B-E
> ### Recode "Publishing journal and subdiscipline"
> jour <- numeric()
> 
> for(i in 1:nrow(MASTER)) {
+   if(as.character(MASTER$Journal..O.[i]) == "JEPLMC") {
+     jour[i] <- 1
+   } else if(as.character(MASTER$Journal..O.[i]) == "JPSP") {
+     jour[i] <- 2
+   } else if(as.character(MASTER$Journal..O.[i]) == "PS") {
+     if(as.character(MASTER$Discipline..O.[i]) == "Cognitive") {
+       jour[i] <- 3
+     } else if(as.character(MASTER$Discipline..O.[i]) == "Social") {
+       jour[i] <- 4
+     } else { jour[i] <- 5 }
+   }
+   else { jour[i] <- NA }
+ }
> 
> # Overall 
> sel <- MASTER[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R),]
> 
> # Column B
> # Relations tested
> reltest <- dim(sel)[1]
> # Relations both significant
> relsig <- sum((sel$T_sign_O) & (sel$T_sign_R), na.rm = TRUE)
> cat(
+   paste0("Column B Overall ",
+          round(relsig, 0),
+          " / ",
+          round(reltest, 0)
+   )
+ )
Column B Overall 35 / 100> 
> # Column C
> # Percent
> cat(paste0("Column C overall ", round((relsig / reltest), 2)))
Column C overall 0.35> 
> # Column D
> # Mean
> temp1 <- mean(sel$T_r..O., na.rm = TRUE)
> # SD
> temp2 <- sd(sel$T_r..O., na.rm = TRUE)
> 
> cat(paste0("Column D overall ", round(temp1, 2), " (", round(temp2, 2), ")"))
Column D overall 0.39 (0.19)> 
> # Column E
> # Mean
> temp1 <- mean(sel$T_r..R., na.rm = TRUE)
> # SD
> temp2 <- sd(sel$T_r..R., na.rm = TRUE)
> 
> cat(paste0("Column F overall ", round(temp1, 2), " (", round(temp2, 2), ")"))
Column F overall 0.2 (0.25)> 
> 
> # Per journal 
> journals <- c("JEPLMC", "JPSP", "PS Cognitive", "PS social", "PS other")
> for(journal in c(2,1,4,3,5)){
+   
+   sel <- MASTER[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == journal,]
+   
+   # Column B
+   # Relations tested
+   reltest <- dim(sel)[1]
+   # Relations both significant
+   relsig <- sum((sel$T_sign_O) & (sel$T_sign_R), na.rm = TRUE)
+   cat(
+     paste0("Column B ", journals[journal], " ",
+            round(relsig, 0),
+            " / ",
+            round(reltest, 0)
+     )
+   )
+   cat("\n")
+   
+   # Column C
+   # Percent
+   cat(paste0("Column C ", journals[journal], " ",
+              as.character(round((relsig / reltest), 2))))
+   cat("\n")
+   
+   # Column D
+   # Mean
+   temp1 <- mean(sel$T_r..O., na.rm = TRUE)
+   # SD
+   temp2 <- sd(sel$T_r..O., na.rm = TRUE)
+   
+   cat(paste0("Column D ", journals[journal], " ",
+              round(temp1, 2), " (", round(temp2, 2), ")"))
+   cat("\n")
+   # Column F
+   # Mean
+   temp1 <- mean(sel$T_r..R., na.rm = TRUE)
+   # SD
+   temp2 <- sd(sel$T_r..R., na.rm = TRUE)
+   
+   cat(paste0("Column F ", journals[journal], " ",round(temp1, 2), " (", round(temp2, 2), ")"))
+   cat("\n")
+ }
Column B JPSP 7 / 32
Column C JPSP 0.22
Column D JPSP 0.28 (0.1)
Column F JPSP 0.07 (0.1)
Column B JEPLMC 13 / 28
Column C JEPLMC 0.46
Column D JEPLMC 0.46 (0.18)
Column F JEPLMC 0.27 (0.24)
Column B PS social 7 / 24
Column C PS social 0.29
Column D PS social 0.37 (0.21)
Column F PS social 0.21 (0.29)
Column B PS Cognitive 7 / 10
Column C PS Cognitive 0.7
Column D PS Cognitive 0.53 (0.23)
Column F PS Cognitive 0.36 (0.24)
Column B PS other 1 / 6
Column C PS other 0.17
Column D PS other 0.52 (0.13)
Column F PS other 0.14 (0.44)
> 
> #---------------
> 
> # P-value analyses
> # Written by CHJ Hartgerink
> 
> #  McNemar test
> tab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R)],
+              MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R)])
> 
> mcnemarchi <- (tab[1,2]-tab[2,1])^2/(tab[1,2]+tab[2,1])
> mcnemarp <- pchisq(q = mcnemarchi, df = 1, lower.tail = FALSE)
> 
> # Dependent t-test p-values
> t.test(x = MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)],
+        y = MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)],
+        paired = TRUE)

        Paired t-test

data:  MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)] and MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]
t = -8.2165, df = 98, p-value = 8.736e-13
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.3402255 -0.2078530
sample estimates:
mean of the differences 
             -0.2740393 

> 
> # Wilcoxon signed-rank test p-values
> wilcox.test(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)],
+             MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)],
+             alternative="two.sided")

        Wilcoxon rank sum test with continuity correction

data:  MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)] and MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]
W = 2406, p-value = 6.162e-10
alternative hypothesis: true location shift is not equal to 0

> 
> sd(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])
[1] 0.1028656
> summary(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
0.0000000 0.0004249 0.0068910 0.0282800 0.0233300 0.9124000 
> sd(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])
[1] 0.3172161
> summary(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.000000 0.007754 0.198200 0.302300 0.536500 0.974800 
> 
> # Percent significant and nonsignificant for original studies
> # Significant
> sum(tab[2,])/sum(tab)
[1] 0.97
> # Nonsignificant
> sum(tab[1,])/sum(tab)
[1] 0.03
> 
> # Percent significant and nonsignificant for replication studies
> # Significant
> sum(tab[,2])/sum(tab)
[1] 0.36
> # Nonsignificant
> sum(tab[1,])/sum(tab)
[1] 0.03
> 
> # Deviation from uniformity in nonsignificant replication studies
> FisherMethod(x = MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..R.)],
+              id = 1,
+              alpha = .05)
      Fish      PFish CountNSig CountSig PercentNonSig
1 155.8262 0.04765856        64       35     0.6464646
> 
> # Distribution p-values
> pdf('pvalue distributions.pdf', onefile = TRUE, width = 11, height = 9.2)
> #PDF
> plot(density(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]),
+      lty=1,
+      frame.plot=F, 
+      main="P-value distributions (PDF)",
+      xlim=c(0,1),
+      xaxs="i",
+      yaxs="i",
+      xlab="P-value",
+      ylab = "Density",
+      cex.axis=.6,
+      cex.lab=.7,
+      col = "grey")
> lines(density(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]))
> legend(x=.4,y=4,legend=c(paste('Original p-values, k = ',
+                                length(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])),
+                          paste('Replication p-values, k = ',
+                                length(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]))),
+        cex=1,
+        lty=c(1,1), bty = 'n',
+        col = c("grey","black"),box.lwd=0)
> 
> # CDF
> plot(ecdf(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]),
+      lty=1,
+      frame.plot=F, 
+      main="P-value distributions (CDF)",
+      xlim=c(0,1),
+      xaxs="i",
+      yaxs="i",
+      xlab="P-value",
+      ylab = "Density",
+      cex.axis=.6,
+      cex.lab=.7,
+      col = "grey")
> lines(ecdf(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]))
> legend(x=.5,y=.3,legend=c(paste('Original p-values, k = ',
+                                 length(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])),
+                           paste('Replication p-values, k = ',
+                                 length(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]))),
+        cex=1,
+        lty=c(1,1), bty = 'n',
+        col = c("grey","black"),box.lwd=0)
> dev.off()
null device 
          1 
> 
> # Significance per journal
> 
> # Table significance, per journal
> 
> # JEPLMC
> JEPLMCtab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 1],
+                    MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 1])
> # JPSP
> JPSPtab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 2],
+                  MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 2])
> # PS
> PStab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & (jour == 3 | jour == 4 | jour == 5)],
+                MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & (jour == 3 | jour == 4 | jour == 5)])
> 
> labels <- c("Original", "Replication", "Replication | sig original")
> 
> JPSP <- c(sum(JPSPtab[2,]),
+           sum(JPSPtab[,2]),
+           sum(JPSPtab[2,2]))
> JPSPperc <- c(sum(JPSPtab[2,])/sum(JPSPtab),
+               sum(JPSPtab[,2])/sum(JPSPtab),
+               sum(JPSPtab[2,2])/sum(JPSPtab[2,]))
> 
> JEPLMC <- c(sum(JEPLMCtab[2,]),
+             sum(JEPLMCtab[,2]),
+             sum(JEPLMCtab[2,2]))
> JEPLMCperc <- c(sum(JEPLMCtab[2,])/sum(JEPLMCtab),
+                 sum(JEPLMCtab[,2])/sum(JEPLMCtab),
+                 sum(JEPLMCtab[2,2])/sum(JEPLMCtab[2,]))
> 
> PS <- c(sum(PStab[2,]),
+         sum(PStab[,2]),
+         sum(PStab[2,2]))
> PSperc <- c(sum(PStab[2,])/sum(PStab),
+             sum(PStab[,2])/sum(PStab),
+             sum(PStab[2,2])/sum(PStab[2,]))
> 
> 
> cbind(labels, JPSP, JPSPperc, JEPLMC, JEPLMCperc, PS, PSperc)
     labels                       JPSP JPSPperc            JEPLMC
[1,] "Original"                   "31" "0.96875"           "27"  
[2,] "Replication"                "7"  "0.21875"           "13"  
[3,] "Replication | sig original" "7"  "0.225806451612903" "13"  
     JEPLMCperc          PS   PSperc             
[1,] "0.964285714285714" "39" "0.975"            
[2,] "0.464285714285714" "16" "0.4"              
[3,] "0.481481481481481" "15" "0.384615384615385"
> #---------------
> 
> # Effect size distributions
> # Written by CHJ Hartgerink
> 
> # Original effects recomputed
> length(MASTER$T_r..O.[!is.na(MASTER$T_r..O.)])
[1] 142
> # Replication effects recopmuted
> length(MASTER$T_r..R.[!is.na(MASTER$T_r..R.)])
[1] 97
> 
> # Number of pairs
> sum(!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.))
[1] 97
> 
> # Spearman correlation original and replicated effect sizes
> cor(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+     MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+     method = "spearman")
[1] 0.510666
> 
> # Dependent t-test effects (r values)
> t.test(x = MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+        y = MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+        paired = TRUE)

        Paired t-test

data:  MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)] and MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]
t = 9.3317, df = 96, p-value = 4.059e-15
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.1561618 0.2405474
sample estimates:
mean of the differences 
              0.1983546 

> 
> 
> # Wilcox test effects (r values)
> wilcox.test(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+             MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+             alternative="two.sided")

        Wilcoxon rank sum test with continuity correction

data:  MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)] and MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]
W = 7132, p-value = 5.406e-10
alternative hypothesis: true location shift is not equal to 0

> 
> summary(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.00464 0.22550 0.37480 0.39620 0.55120 0.85960 
> sd(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
[1] 0.1928085
> summary(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.45020  0.02384  0.12050  0.19790  0.32270  0.92290 
> sd(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
[1] 0.254985
> 
> mean(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])-mean(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
[1] 0.1983546
> 
> # Binomial test to see if replicated effect is larger than original
> temp <- MASTER$T_O_larger
> prop <- sum(temp[!is.na(temp)])/length(temp[!is.na(temp)])
> binom.test(x = sum(temp[!is.na(temp)]), n = length(temp[!is.na(temp)]), 
+            p = .5, alternative = "two.sided")

        Exact binomial test

data:  sum(temp[!is.na(temp)]) and length(temp[!is.na(temp)])
number of successes = 82, number of trials = 99, p-value = 2.181e-11
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.7393611 0.8966667
sample estimates:
probability of success 
             0.8282828 

> 
> pdf('effect plots.pdf', width = 11.2, height = 9, onefile = TRUE)
> # Effect replication and original
> plot(y = MASTER$T_r..R., x = MASTER$T_r..O., xlab = "Effect size r (original)",
+      ylab = "Effect size r (replication)", col = "white", xlim = c(-.3, 1), ylim = c(-.3, 1),
+      frame.plot=F,
+      xaxs="i",
+      yaxs="i"
+ )
> abline(v=0, col = "grey")
> abline(h=0, col = "grey")
> points(y = MASTER$T_r..R.[MASTER$T_sign_O == 0 & MASTER$T_sign_R == 0],
+        x = MASTER$T_r..O.[MASTER$T_sign_O == 0 & MASTER$T_sign_R == 0], 
+        pch = 4, col = 1)
> points(y = MASTER$T_r..R.[MASTER$T_sign_O == 1 & MASTER$T_sign_R == 0],
+        x = MASTER$T_r..O.[MASTER$T_sign_O == 1 & MASTER$T_sign_R == 0],
+        pch = 21, col = 10)
> points(y = MASTER$T_r..R.[MASTER$T_sign_O == 1 & MASTER$T_sign_R == 1],
+        x = MASTER$T_r..O.[MASTER$T_sign_O == 1 & MASTER$T_sign_R == 1], 
+        pch = 10, col = 3)
> lines(x = seq(-.5, 2, .0001), y = seq(-.5, 2, .0001), type = 'l')
> 
> # Regression line
> x1 <- MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]
> y1 <- MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]
> 
> # Linear
> xx <- lm(y1 ~ x1)
> lines(loess.smooth(x = x1, y = y1), lty = 2)
> curve(expr = (xx$coefficients[1] + xx$coefficients[2] * x), from = min(x1),
+       to = max(x1), add = TRUE, col = "blue")
> 
> legend(x=-.2,y=.8,legend=c('Both nonsignificant',
+                            'Original significant',
+                            'Both significant',
+                            'Repl. predicted by orig.',
+                            'Loess curve'),
+        cex=1,
+        lty=c(0, 0, 0, 1, 2), bty = 'n', pch = c(4, 21, 10, NA, NA),
+        col = c("black", 10, 3, "blue", "black"), box.lwd=0)
> 
> # R2
> xr2 <- x1 * x1
> yr2 <- y1 * y1
> 
> plot(y = yr2, x = xr2, xlab = "Effect size r (original)",
+      ylab = "Effect size r (replication)", col = "white", ylim = c(0,1), xlim = c(0,1))
> points(y = yr2[MASTER$T_pval_USE..O. > .05 & MASTER$T_pval_USE..R. > .05],
+        x = xr2[MASTER$T_pval_USE..O. > .05 & MASTER$T_pval_USE..R. > .05], pch = 4)
> points(y = yr2[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. > .05],
+        x = xr2[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. > .05], pch = 21)
> points(y = yr2[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. <= .05],
+        x = xr2[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. <= .05], pch = 10)
> lines(x = seq(0, 1, .001), y = seq(0, 1, .001), type = 'l')
> 
> r2 <- lm(yr2 ~ xr2)
> lines(loess.smooth(x = xr2, y = yr2), lty = 2)
> curve(expr = (r2$coefficients[1] + r2$coefficients[2] * x), from = 0, to = 1, add = TRUE, col = "blue")
> 
> legend(x=0,y=.8,legend=c('Both nonsignificant',
+                          'Original significant',
+                          'Both significant',
+                          'Repl. predicted by orig.',
+                          'Loess curve'),
+        cex=1,
+        lty=c(0, 0, 0, 1, 2), bty = 'n', pch = c(4, 21, 10, NA, NA),
+        col = c("black", "black", "black", "blue", "black"),box.lwd=0)
> # Histogram effects 
> par(mfrow=c(1,2))
> hist1 <- hist(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)], breaks=15)
> hist2 <- hist(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)], breaks=20)
> plot(hist1, xlim = c(-.6, 1.2), ylim = c(0, 50), xlab = "Effect size r",
+      main = "Effect histograms")
> plot(hist2, add = TRUE, col = addTrans("grey",150))
> legend(x = .45, y = 25,
+        leg=c(paste("Original, k = ",
+                    length(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])),
+              paste("Replication, k = ",
+                    length(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]))),
+        fill=c("white", "grey"),
+        bty = 'n')
> 
> # CDF effects
> plot(ecdf(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]),
+      lty=1,
+      frame.plot=F, 
+      main="Cumulative effect distributions",
+      xlim=c(0,1),
+      xaxs="i",
+      yaxs="i",
+      xlab="Correlation coefficient",
+      ylab = "Cumulative density",
+      cex.axis=.6,
+      cex.lab=.7,
+      col = "grey")
> lines(ecdf(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]))
> legend(x=.45,y=.5,legend=c(paste("Original, k = ",
+                                  length(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])),
+                            paste("Replication, k = ",
+                                  length(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]))),
+        cex=1,
+        lty=c(1,1), bty = 'n',
+        col = c("grey","black"),box.lwd=0)
> 
> dev.off()
null device 
          1 
> 
> #----------------------
> 
> # Meta-analysis
> # Written by RCM van Aert
> 
> ##########################################
> ### Create correct order of categories ###
> ##########################################
> 
> ### Create the right order of the variable "Perceived expertise required"
> fac.expe <- factor(MASTER$Methodology.expertise.required..O., levels = c("No expertise required", "Slight expertise required",
+                                                                          "Moderate expertise required", "Strong expertise required", 
+                                                                          "Extreme expertise required"))
> 
> ### Create the right order of the variable "Opportunity for expectancy biases"
> fac.oppo.expe <- factor(MASTER$Opportunity.for.expectancy.bias..O., levels = c("No opportunity for researcher expectations to influence results",
+                                                                                "Slight opportunity for researcher expectations to influence results",
+                                                                                "Moderate opportunity for researcher expectations to influence results",
+                                                                                "Strong opportunity for researcher expectations to influence results",
+                                                                                "Extreme opportunity for researcher expectations to influence results"))
> 
> ### Create the right order of the variable "Opportunity for lack of diligence"
> fac.oppo.dili <- factor(MASTER$Opportunity.for.lack.of.diligence..O., levels = c("No opportunity for lack of diligence to affect the results",
+                                                                                  "Slight opportunity for lack of diligence to affect the results",
+                                                                                  "Moderate opportunity for lack of diligence to affect the results",
+                                                                                  "Strong opportunity for lack of diligence to affect the results",
+                                                                                  "Extreme opportunity for lack of diligence to affect the results"))
> 
> ### Create the right order of the variable "Current position"
> fac.posi <- factor(MASTER$Current.position..R., levels = c("Professor (or equivalent)", "Associate Professor (or equivalent)", "Assistant Professor (or equivalent)",
+                                                            "Post-doc or Research Scientist", "PhD student", "Master's student", "Undergraduate student", 
+                                                            "Faculty (non-tenure track) full-time lecturer", "Private sector researcher"))
> 
> ### Change "Faculty (non-tenure track) full-time lecturer" into "Assistant Professor (or equivalent)"
> tmp <- numeric()
> for(i in 1:length(fac.posi)) {
+   if(is.na(fac.posi[i] == TRUE)) { tmp[i] <- NA }
+   else if(as.character(fac.posi[i]) == "Faculty (non-tenure track) full-time lecturer") { tmp[i] <- "Assistant Professor (or equivalent)"
+   } else if (as.character(fac.posi[i]) == "Private sector researcher") { tmp[i] <- "Post-doc or Research Scientist"
+   } else { tmp[i] <- as.character(fac.posi[i]) }
+ }
> fac.posi <- as.factor(tmp)
> 
> ### Create the right order of the variable "Degree"
> fac.degr <- factor(MASTER$Degree..R., levels = c("PhD or equivalent", "Master's degree or equivalent", "Some graduate school", "Bachelor's degree or equivalent", "some college/university",
+                                                  "high school/equivalent"))
> 
> ### Create the right order of the variable "Domain expertise"
> fac.doma <- factor(MASTER$Domain.expertise..R., levels = c("No Expertise", "Slight Expertise", "Some Expertise", "Moderate Expertise", "High Expertise"))
> 
> ### Create the right order of the variable "Method expertise"
> fac.meth <- factor(MASTER$Method.expertise..R., levels = c("No Expertise", "Slight Expertise", "Some Expertise", "Moderate Expertise", "High Expertise"))
> 
> ### Create the right order of the variable "Implementation quality"
> fac.impl <- factor(MASTER$Implementation.quality..R., levels = c("was of much higher quality than the original study", "was of moderately higher quality than the original study",
+                                                                  "was of slightly higher quality than the original study", "was about the same quality as the original study", 
+                                                                  "was of slightly lower quality than the original study", "was of moderately lower quality than the original study"))
> 
> ### Create the right order of the variable "Data collection quality"
> fac.data <- factor(MASTER$Data.collection.quality..R., levels = c("was much better than the average study", "was better than the average study", "was slightly better than the average study",
+                                                                   "was about the same as the average study", "was slightly worse than the average study", "was worse than the average study",
+                                                                   "was much worse than the average study"))
> 
> ### Create the right order of the variable "Replication similarity"
> fac.repl <- factor(MASTER$Replication.similarity..R., levels = c("Not at all similar", "Slightly similar", "Somewhat similar", "Moderately similar", "Very similar", "Extremely similar",
+                                                                  "Virtually identical"))
> 
> ### Create the right order of the variable "Difficulty of implementation"
> fac.diff <- factor(MASTER$Difficulty.of.implimentation..R., levels = c("Extremely challenging", "Very challenging", "Moderately challenging", "Somewhat challenging", "Slightly challenging",
+                                                                        "Not at all challenging"))
> 
> ### Create the right order of the variable "Surprise of outcome (R)"
> fac.sur.out <- factor(MASTER$Surprise.of.outcome..R., levels = c("Results were exactly as anticipated", "Results were slightly surprising", "Results were somewhat surprising",
+                                                                  "Results were moderately surprising", "Results were extremely surprising"))
> 
> ###########################################
> ### Prepare variables for meta-analyses ###
> ###########################################
> 
> ### Function for standardizing variables
> stand <- function(x) {
+   res <- (x-mean(x, na.rm = TRUE))/sd(x, na.rm = TRUE)
+   return(res)
+ }
> 
> # a. PUBLISHING JOURNAL AND SUBDISCIPLINE
> 
> ### Create dummy variables for "Publishing journal and subdiscipline"
> ### JPSP is reference category because it has the most cases
> d.JEP <- ifelse(jour == 1, 1, 0)
> d.PSCog <- ifelse(jour == 3, 1, 0)
> d.PSSoc <- ifelse(jour == 4, 1, 0)
> d.PSOth <- ifelse(jour == 5, 1, 0)
> 
> # b. IMPORTANCE OF THE EFFECT
> 
> ### Standardizing "Citation count, paper (O)"
> st.impa <- stand(MASTER$Citation.count..paper..O.)
> 
> ### Standardizing "Exciting/important effect"
> st.exci <- stand(as.numeric(levels(MASTER$Exciting.result..O.))[MASTER$Exciting.result..O.])
Warning message:
In stand(as.numeric(levels(MASTER$Exciting.result..O.))[MASTER$Exciting.result..O.]) :
  NAs introduced by coercion
> 
> ### Creating scale
> sc.impo <- (st.impa + st.exci)/2
> 
> # c. SURPRISING EFFECT
> 
> ### Standardizing "Surprising effect" and creating scale
> sc.surp <- stand(as.numeric(levels(MASTER$Surprising.result..O.))[MASTER$Surprising.result..O.])
Warning message:
In stand(as.numeric(levels(MASTER$Surprising.result..O.))[MASTER$Surprising.result..O.]) :
  NAs introduced by coercion
> 
> # d. EXPERIENCE AND EXPERTISE OF ORIGINAL TEAM
> 
> ### Taking the average and then standardizing "Institution prestige of 1st author and senior author" 
> ave.pres <- (MASTER$Institution.prestige..1st.author..O.+MASTER$Institution.prestige..senior.author..O.)/2
> st.pres <- stand(ave.pres)
> 
> ### Standardizing "Citation Count, 1st author (O)"
> st.impa.1st <- stand(MASTER$Citation.Count..1st.author..O.)
> 
> ### Standardizing "Citation count, senior author (O)"
> st.impa.sen <- stand(MASTER$Citation.count..senior.author..O.)
> 
> ### Creating scale
> sc.expe1 <- (st.pres + st.impa.1st + st.impa.sen)/3
> 
> # e. CHALLENGE OF CONDUCTING REPLICATION
> 
> ### Standardizing "Perceived expertise required"
> st.expe <- stand(as.numeric(fac.expe))
> 
> ### Standardizing "Perceived opportunity for expectancy biases"
> st.oppo.expe <- stand(as.numeric(fac.oppo.expe))
> 
> ### Standardizing "Perceived opportunity for impact of lack of diligence"
> st.oppo.dili <- stand(as.numeric(fac.oppo.dili))
> 
> ### Create scale
> sc.chal <- (st.expe + st.oppo.expe + st.oppo.dili)/3
> 
> # f. EXPERIENCE AND EXPERTISE OF REPLICATION TEAM
> 
> ### Standardizing "Position of senior member of replication team"
> st.posi <- stand(as.numeric(fac.posi))
> 
> ### Standardizing "Highest degree of replication team's senior member"
> st.degr <- stand(as.numeric(fac.degr))
> 
> ### Standardizing "Replication team domain expertise"
> st.doma <- stand(as.numeric(fac.doma))
> 
> ### Standardizing "Replication team method expertise"
> st.meth <- stand(as.numeric(fac.meth))
> 
> ### Standardizing "Replication team senior member's total publications"
> st.publ <- stand(MASTER$Total.publications..R.)
> 
> ### Standardizing "Replication team senior member's total publications and total number of peer-reviewed articles"
> st.peer <- stand(MASTER$Peer.reviewed.articles..R.)
> 
> ### Standardizing "Replication team senior member's total citations"
> st.cita <- stand(MASTER$Citations..R.)
> 
> ### Create scale
> sc.expe2 <- (st.posi + st.degr + st.doma + st.meth + st.publ + st.cita)/6
> 
> # g. SELF-ASSESSED QUALITY OF REPLICATION
> 
> ### Standardizing "Self-assessed quality of replication"
> st.impl <- stand(as.numeric(fac.impl))
> 
> ### Standardizing "Self-assessed data collection quality of replication"
> st.data <- stand(as.numeric(fac.data))
> 
> ### Standardizing "Self-assessed replication similarity to original"
> st.repl <- stand(as.numeric(fac.repl))
> 
> ### Standardizing "Self-assessed difficulty of implementation"
> st.diff <- stand(as.numeric(fac.diff))
> 
> ### Create a scale
> sc.self <- (st.impl + st.data + st.repl + st.diff)/4
> 
> ###########################################
> ### Transforming correlations to Fisher ###
> ###########################################
> 
> ri.o <- MASTER$T_r..O.
> ri.r <- MASTER$T_r..R.
> N.o <- MASTER$T_df2..O.+2
> N.r <- MASTER$T_df2..R.+2
> 
> ### Partial correlation, so degrees of freedom plus 2 in order to get N
> N.o[MASTER$ID == 82] <- MASTER$T_df1..O.[82]+2
> N.r[MASTER$ID == 82] <- MASTER$T_df1..R.[82]+2
> 
> ### Correlation
> N.o[MASTER$ID == 120] <- MASTER$T_N..O.[120]
> N.r[MASTER$ID == 120] <- MASTER$T_N..R.[120]
> N.o[MASTER$ID == 154] <- MASTER$T_N..O.[154]
> N.r[MASTER$ID == 154] <- MASTER$T_N..R.[154]
> N.o[MASTER$ID == 155] <- MASTER$T_N..O.[155]
> N.r[MASTER$ID == 155] <- MASTER$T_N..R.[155]
> 
> ### t
> N.o[MASTER$ID == 121] <- MASTER$T_N..O.[121]
> N.r[MASTER$ID == 121] <- MASTER$T_N..R.[121]
> 
> ### Transform to Fisher's z
> fis.o <- 0.5*log((1 + ri.o) / (1 - ri.o)) 
Warning message:
In log((1 + ri.o)/(1 - ri.o)) : NaNs produced
> fis.r <- 0.5*log((1 + ri.r) / (1 - ri.r))
> 
> ### Difference in Fisher's z scores
> yi <- numeric()
> for(i in 1:length(fis.o)) {
+   
+   if(is.na(fis.o[i]) == TRUE | is.na(fis.r[i]) == TRUE) { yi[i] <- NA }
+   else if(fis.o[i] < 0 & fis.r[i] < 0) { yi[i] <- fis.o[i]*-1-fis.r[i]*-1 } 
+   else if(fis.o[i] < 0 & fis.r[i] > 0) { yi[i] <- fis.o[i]*-1+fis.r[i] }
+   else {  yi[i] <- fis.o[i]-fis.r[i] }
+   
+ }
> 
> ### Standard errors original and replication study
> sei.o <- sqrt(1/(N.o-3))
> sei.r <- sqrt(1/(N.r-3))
> 
> ### p-values original and replication study
> pval.o <- pnorm(fis.o, sd = sei.o, lower.tail = FALSE)
> pval.r <- pnorm(fis.r, sd = sei.r, lower.tail = FALSE)
> 
> ### Standard error of difference score
> sei <- sqrt(1/(N.o-3) + 1/(N.r-3))
> 
> 
> #######################################
> ### Coverage F(>1,df2) and Chi2     ###
> #######################################
> # Written by MALM van Assen
> 
> tol <- 1e-7
> xm <- 0
>  
> df1.or <- df2.or <- F.or <- df1.rep <- df2.rep <- F.rep <- 1:17
> ncp.L <- ncp.U <- ncp.o <- in.ci <- 1:17
>  
> ### study 12
> df1.or[1] <- 2
> df2.or[1] <- 92
> F.or[1] <- 3.13
> df1.rep[1] <- 2
> df2.rep[1] <- 232
> F.rep[1] <- 1.63
>  
> ### study 13
> df1.or[2] <- 2
> df2.or[2] <- 68
> F.or[2] <- 41.59
> df1.rep[2] <- 2
> df2.rep[2] <- 68
> F.rep[2] <- 41.603
>  
> ### study 17
> df1.or[3] <- 2
> df2.or[3] <- 76
> F.or[3] <- 8.67
> df1.rep[3] <- 1.58
> df2.rep[3] <- 72.4
> F.rep[3] <- 19.48
>  
> ### study 22
> df1.or[4] <- 3
> df2.or[4] <- 93
> F.or[4] <- 5.23
> df1.rep[4] <- 2.33
> df2.rep[4] <- 90
> F.rep[4] <- 0.38
>  
> ### study 43
> df1.or[5] <- 2
> df2.or[5] <- 64
> F.or[5] <- 10.17
> df1.rep[5] <- 2
> df2.rep[5] <- 72
> F.rep[5] <- 1.97
>  
> ### study 46
> df1.or[6] <- 21
> df2.or[6] <- 230025
> F.or[6] <- 118.15
> df1.rep[6] <- 21
> df2.rep[6] <- 455304
> F.rep[6] <- 261.93
>  
> ### study 50
> df1.or[7] <- 2
> df2.or[7] <- 92
> F.or[7] <- 4.36
> df1.rep[7] <- 2
> df2.rep[7] <- 103
> F.rep[7] <- 2.601
>  
> ### study 55
> df1.or[8] <- 2
> df2.or[8] <- 54
> F.or[8] <- 3.19
> df1.rep[8] <- 2
> df2.rep[8] <- 68
> F.rep[8] <- 0.3
>  
> ### study 64
> df1.or[9] <- 2
> df2.or[9] <- 76
> F.or[9] <- 21.57
> df1.rep[9] <- 2
> df2.rep[9] <- 65
> F.rep[9] <- 0.865
>  
> ### study 80
> df1.or[10] <- 2
> df2.or[10] <- 43
> F.or[10] <- 3.36
> df1.rep[10] <- 2
> df2.rep[10] <- 67
> F.rep[10] <- 1.7
>  
> ### study 86
> df1.or[11] <- 2
> df2.or[11] <- 82
> F.or[11] <- 4.05
> df1.rep[11] <- 2
> df2.rep[11] <- 137
> F.rep[11] <- 1.99
>  
> ### study 117
> df1.or[12] <- 18
> df2.or[12] <- 660
> F.or[12] <- 16.31
> df1.rep[12] <- 18
> df2.rep[12] <- 660
> F.rep[12] <- 12.98
>  
> ### study 132
> df1.or[13] <- 3
> df2.or[13] <- 69
> F.or[13] <- 5.15
> df1.rep[13] <- 1.48
> df2.rep[13] <- 41.458
> F.rep[13] <- 1.401
>  
> ### study 139
> df1.or[14] <- 3
> df2.or[14] <- 9
> F.or[14] <- 8.5
> df1.rep[14] <- 3
> df2.rep[14] <- 12
> F.rep[14] <- 13.06
>  
> ### study 140
> df1.or[15] <- 2
> df2.or[15] <- 81
> F.or[15] <- 4.97
> df1.rep[15] <- 2
> df2.rep[15] <- 122
> F.rep[15] <- 0.24
>  
> ### study 142
> df1.or[16] <- 2
> df2.or[16] <- 162
> F.or[16] <- 192.89
> df1.rep[16] <- 2
> df2.rep[16] <- 174
> F.rep[16] <- 252.83
>  
> ### study 143
> df1.or[17] <- 4
> df2.or[17] <- 108
> F.or[17] <- 3.67
> df1.rep[17] <- 4
> df2.rep[17] <- 150
> F.rep[17] <- 0.58
>  
> ### loop
> for (i in 1:length(F.or)) {
+   df1.o <- df1.or[i]
+   df2.o <- df2.or[i]
+   F.o <- F.or[i]
+   df1.r <- df1.rep[i]
+   df2.r <- df2.rep[i]
+   F.r <- F.rep[i]
+ 
+   ### ncp lower bound
+   if (pf(F.r,df1.r,df2.r,0) < .975)
+   {ncp.L[i] <- 0} else
+   {
+ x0 <- 0
+ x1 <- df1.r*F.r
+ print(x1)
+ ym <- 1  
+ while(abs(ym-0.975) > tol) {
+   xm <- (x0+x1)/2
+   ym <- pf(F.r,df1.r,df2.r,xm)
+   if (ym > 0.975) x0 <- xm
+   if (ym < 0.975) x1 <- xm  
+   print(xm)
+   print(ym)
+ }
+ ncp.L[i] <- xm
+   }
+  
+   ### ncp upper bound
+   x0 <- df1.r*F.r
+   x1 <- 20*df1.r*F.r
+   print(x0)
+   print(x1)
+   ym <- 1  
+   while(abs(ym-0.025) > tol) {
+ xm <- (x0+x1)/2
+ ym <- pf(F.r,df1.r,df2.r,xm)
+ if (ym > 0.025) x0 <- xm
+ if (ym < 0.025) x1 <- xm
+ print(xm)
+   }
+   ncp.U[i] <- xm
+  
+   ### check if original is in ci of replication
+   ncp.o[i] <- F.o*df1.o*(df2.o-2)/df2.o-df1.o
+   in.ci[i] <- ( (ncp.L[i] < ncp.o[i]) & (ncp.U[i] > ncp.o[i]) )
+ }
[1] 3.26
[1] 65.2
[1] 34.23
[1] 18.745
[1] 11.0025
[1] 14.87375
[1] 12.93812
[1] 11.97031
[1] 12.45422
[1] 12.69617
[1] 12.81715
[1] 12.75666
[1] 12.7869
[1] 12.77178
[1] 12.76422
[1] 12.76044
[1] 12.75855
[1] 12.7595
[1] 12.75902
[1] 12.75879
[1] 12.7589
[1] 12.75885
[1] 12.75882
[1] 83.206
[1] 41.603
[1] 0.9791052
[1] 62.4045
[1] 0.8128141
[1] 52.00375
[1] 0.9239496
[1] 46.80338
[1] 0.9577572
[1] 44.20319
[1] 0.9698144
[1] 42.90309
[1] 0.9747808
[1] 42.25305
[1] 0.97702
[1] 42.57807
[1] 0.9759201
[1] 42.74058
[1] 0.9753554
[1] 42.82184
[1] 0.9750693
[1] 42.86247
[1] 0.9749254
[1] 42.84215
[1] 0.9749974
[1] 42.83199
[1] 0.9750334
[1] 42.83707
[1] 0.9750154
[1] 42.83961
[1] 0.9750064
[1] 42.84088
[1] 0.9750019
[1] 42.84152
[1] 0.9749997
[1] 42.8412
[1] 0.9750008
[1] 42.84136
[1] 0.9750003
[1] 42.84144
[1] 0.975
[1] 83.206
[1] 1664.12
[1] 873.663
[1] 478.4345
[1] 280.8202
[1] 182.0131
[1] 132.6096
[1] 157.3113
[1] 144.9605
[1] 138.785
[1] 135.6973
[1] 134.1534
[1] 133.3815
[1] 132.9955
[1] 133.1885
[1] 133.092
[1] 133.1403
[1] 133.1644
[1] 133.1764
[1] 133.1825
[1] 133.1795
[1] 133.181
[1] 133.1802
[1] 30.7784
[1] 15.3892
[1] 0.9194413
[1] 7.6946
[1] 0.9926028
[1] 11.5419
[1] 0.969646
[1] 9.61825
[1] 0.9839232
[1] 10.58008
[1] 0.9775744
[1] 11.06099
[1] 0.9738179
[1] 10.82053
[1] 0.9757469
[1] 10.94076
[1] 0.9747952
[1] 10.88065
[1] 0.9752742
[1] 10.9107
[1] 0.9750355
[1] 10.92573
[1] 0.9749156
[1] 10.91822
[1] 0.9749756
[1] 10.91446
[1] 0.9750056
[1] 10.91634
[1] 0.9749906
[1] 10.9154
[1] 0.9749981
[1] 10.91493
[1] 0.9750018
[1] 10.91516
[1] 0.975
[1] 30.7784
[1] 615.568
[1] 323.1732
[1] 176.9758
[1] 103.8771
[1] 67.32775
[1] 49.05308
[1] 58.19041
[1] 62.75908
[1] 60.47475
[1] 59.33258
[1] 58.7615
[1] 58.47595
[1] 58.33318
[1] 58.40457
[1] 58.44026
[1] 58.45811
[1] 58.46703
[1] 58.46257
[1] 58.4648
[1] 58.46592
[1] 58.46536
[1] 58.46508
[1] 58.46494
[1] 58.46487
[1] 0.8854
[1] 17.708
[1] 9.2967
[1] 5.09105
[1] 7.193875
[1] 6.142463
[1] 5.616756
[1] 5.879609
[1] 6.011036
[1] 5.945323
[1] 5.912466
[1] 5.928894
[1] 5.937108
[1] 5.933001
[1] 5.930948
[1] 5.929921
[1] 5.930434
[1] 5.930178
[1] 5.930049
[1] 5.929985
[1] 5.930017
[1] 3.94
[1] 78.8
[1] 41.37
[1] 22.655
[1] 13.2975
[1] 17.97625
[1] 15.63687
[1] 14.46719
[1] 13.88234
[1] 14.17477
[1] 14.32098
[1] 14.24787
[1] 14.28442
[1] 14.3027
[1] 14.31184
[1] 14.30727
[1] 14.30498
[1] 14.30613
[1] 14.3067
[1] 14.30698
[1] 14.30684
[1] 14.30691
[1] 5500.53
[1] 2750.265
[1] 1
[1] 4125.398
[1] 1
[1] 4812.964
[1] 0.9999982
[1] 5156.747
[1] 0.9864931
[1] 5328.638
[1] 0.8482542
[1] 5242.693
[1] 0.9471393
[1] 5199.72
[1] 0.9721842
[1] 5178.233
[1] 0.9804181
[1] 5188.977
[1] 0.9766023
[1] 5194.348
[1] 0.9744726
[1] 5191.662
[1] 0.9755568
[1] 5193.005
[1] 0.9750196
[1] 5193.677
[1] 0.9747473
[1] 5193.341
[1] 0.9748838
[1] 5193.173
[1] 0.9749518
[1] 5193.089
[1] 0.9749857
[1] 5193.047
[1] 0.9750027
[1] 5193.068
[1] 0.9749942
[1] 5193.058
[1] 0.9749984
[1] 5193.052
[1] 0.9750005
[1] 5193.055
[1] 0.9749995
[1] 5193.054
[1] 0.975
[1] 5500.53
[1] 110010.6
[1] 57755.57
[1] 31628.05
[1] 18564.29
[1] 12032.41
[1] 8766.47
[1] 7133.5
[1] 6317.015
[1] 5908.772
[1] 5704.651
[1] 5806.712
[1] 5755.682
[1] 5781.197
[1] 5768.439
[1] 5774.818
[1] 5778.007
[1] 5776.413
[1] 5775.615
[1] 5776.014
[1] 5775.815
[1] 5775.715
[1] 5775.765
[1] 5775.74
[1] 5775.727
[1] 5775.721
[1] 5775.724
[1] 5775.726
[1] 5775.727
[1] 5775.727
[1] 5.202
[1] 104.04
[1] 54.621
[1] 29.9115
[1] 17.55675
[1] 11.37937
[1] 14.46806
[1] 16.01241
[1] 16.78458
[1] 16.39849
[1] 16.59154
[1] 16.68806
[1] 16.73632
[1] 16.76045
[1] 16.77251
[1] 16.77855
[1] 16.78156
[1] 16.78307
[1] 16.78232
[1] 16.78269
[1] 16.7825
[1] 16.78241
[1] 16.78236
[1] 0.6
[1] 12
[1] 6.3
[1] 3.45
[1] 4.875
[1] 5.5875
[1] 5.23125
[1] 5.409375
[1] 5.498438
[1] 5.453906
[1] 5.431641
[1] 5.420508
[1] 5.414941
[1] 5.417725
[1] 5.416333
[1] 5.417029
[1] 5.417377
[1] 5.417551
[1] 5.417638
[1] 1.73
[1] 34.6
[1] 18.165
[1] 9.9475
[1] 5.83875
[1] 7.893125
[1] 8.920312
[1] 9.433906
[1] 9.177109
[1] 9.048711
[1] 9.11291
[1] 9.14501
[1] 9.16106
[1] 9.169084
[1] 9.165072
[1] 9.167078
[1] 9.168081
[1] 9.168583
[1] 9.168834
[1] 9.168959
[1] 9.169022
[1] 9.169053
[1] 3.4
[1] 68
[1] 35.7
[1] 19.55
[1] 11.475
[1] 15.5125
[1] 13.49375
[1] 12.48438
[1] 12.98906
[1] 13.24141
[1] 13.11523
[1] 13.17832
[1] 13.14678
[1] 13.16255
[1] 13.17043
[1] 13.16649
[1] 13.16452
[1] 3.98
[1] 79.6
[1] 41.79
[1] 22.885
[1] 13.4325
[1] 18.15875
[1] 15.79562
[1] 14.61406
[1] 14.02328
[1] 14.31867
[1] 14.17098
[1] 14.24482
[1] 14.28175
[1] 14.30021
[1] 14.30944
[1] 14.31406
[1] 14.31175
[1] 14.31059
[1] 14.31002
[1] 14.31031
[1] 14.31045
[1] 14.31038
[1] 14.31041
[1] 233.64
[1] 116.82
[1] 0.9997719
[1] 175.23
[1] 0.9078433
[1] 146.025
[1] 0.9909444
[1] 160.6275
[1] 0.966675
[1] 153.3263
[1] 0.9819424
[1] 156.9769
[1] 0.9752402
[1] 158.8022
[1] 0.9712097
[1] 157.8895
[1] 0.9732855
[1] 157.4332
[1] 0.9742777
[1] 157.205
[1] 0.9747626
[1] 157.091
[1] 0.9750023
[1] 157.148
[1] 0.9748827
[1] 157.1195
[1] 0.9749426
[1] 157.1052
[1] 0.9749724
[1] 157.0981
[1] 0.9749874
[1] 157.0945
[1] 0.9749948
[1] 157.0927
[1] 0.9749986
[1] 157.0918
[1] 0.9750004
[1] 157.0923
[1] 0.9749995
[1] 157.0921
[1] 0.975
[1] 233.64
[1] 4672.8
[1] 2453.22
[1] 1343.43
[1] 788.535
[1] 511.0875
[1] 372.3638
[1] 303.0019
[1] 268.3209
[1] 285.6614
[1] 276.9912
[1] 281.3263
[1] 283.4938
[1] 284.5776
[1] 285.1195
[1] 284.8486
[1] 284.984
[1] 285.0518
[1] 285.0179
[1] 285.0348
[1] 285.0264
[1] 285.0221
[1] 285.02
[1] 285.0211
[1] 285.0216
[1] 285.0214
[1] 285.0215
[1] 2.07348
[1] 41.4696
[1] 21.77154
[1] 11.92251
[1] 6.997995
[1] 9.460253
[1] 10.69138
[1] 11.30695
[1] 10.99916
[1] 10.84527
[1] 10.92222
[1] 10.96069
[1] 10.94145
[1] 10.93184
[1] 10.92703
[1] 10.92462
[1] 10.92582
[1] 10.92522
[1] 10.92492
[1] 10.92507
[1] 10.92515
[1] 10.92511
[1] 39.18
[1] 19.59
[1] 0.8220625
[1] 9.795
[1] 0.9581424
[1] 4.8975
[1] 0.9892403
[1] 7.34625
[1] 0.9767486
[1] 8.570625
[1] 0.9682423
[1] 7.958437
[1] 0.9726918
[1] 7.652344
[1] 0.9747688
[1] 7.499297
[1] 0.9757708
[1] 7.57582
[1] 0.9752728
[1] 7.614082
[1] 0.9750216
[1] 7.633213
[1] 0.9748954
[1] 7.623647
[1] 0.9749585
[1] 7.618865
[1] 0.9749901
[1] 7.616473
[1] 0.9750058
[1] 7.617669
[1] 0.974998
[1] 7.617071
[1] 0.9750019
[1] 7.61737
[1] 0.9749999
[1] 39.18
[1] 783.6
[1] 411.39
[1] 225.285
[1] 132.2325
[1] 85.70625
[1] 62.44312
[1] 74.07469
[1] 79.89047
[1] 82.79836
[1] 84.2523
[1] 84.97928
[1] 85.34276
[1] 85.52451
[1] 85.61538
[1] 85.56994
[1] 85.59266
[1] 85.5813
[1] 85.57562
[1] 85.57846
[1] 85.57988
[1] 85.58059
[1] 85.58024
[1] 0.48
[1] 9.6
[1] 5.04
[1] 2.76
[1] 3.9
[1] 4.47
[1] 4.755
[1] 4.8975
[1] 4.82625
[1] 4.790625
[1] 4.808438
[1] 4.817344
[1] 4.821797
[1] 4.824023
[1] 4.825137
[1] 4.825693
[1] 4.825415
[1] 4.825554
[1] 4.825624
[1] 4.825589
[1] 4.825572
[1] 505.66
[1] 252.83
[1] 0.9999888
[1] 379.245
[1] 0.971187
[1] 316.0375
[1] 0.9986673
[1] 347.6413
[1] 0.9926016
[1] 363.4431
[1] 0.984794
[1] 371.3441
[1] 0.9788635
[1] 375.2945
[1] 0.975263
[1] 377.2698
[1] 0.9732869
[1] 376.2821
[1] 0.9742902
[1] 375.7883
[1] 0.9747804
[1] 375.5414
[1] 0.9750226
[1] 375.6649
[1] 0.9749017
[1] 375.6032
[1] 0.9749622
[1] 375.5723
[1] 0.9749925
[1] 375.5569
[1] 0.9750076
[1] 375.5646
[1] 0.975
[1] 505.66
[1] 10113.2
[1] 5309.43
[1] 2907.545
[1] 1706.602
[1] 1106.131
[1] 805.8956
[1] 655.7778
[1] 580.7189
[1] 618.2484
[1] 637.0131
[1] 646.3954
[1] 651.0866
[1] 653.4322
[1] 652.2594
[1] 651.673
[1] 651.3798
[1] 651.2332
[1] 651.3065
[1] 651.3432
[1] 651.3249
[1] 651.3157
[1] 651.3203
[1] 2.32
[1] 46.4
[1] 24.36
[1] 13.34
[1] 7.83
[1] 5.075
[1] 6.4525
[1] 7.14125
[1] 7.485625
[1] 7.313438
[1] 7.399531
[1] 7.442578
[1] 7.464102
[1] 7.45334
[1] 7.458721
[1] 7.45603
[1] 7.457375
[1] 7.456703
[1] 7.456367
[1] 7.456535
[1] 7.456619
[1] 7.456577
[1] 7.456598
>  
> cbind(ncp.L,ncp.o,ncp.U,in.ci)
           ncp.L       ncp.o       ncp.U in.ci
 [1,]    0.00000    4.123913   12.758816     1
 [2,]   42.84144   78.733529  133.180218     1
 [3,]   10.91516   14.883684   58.464870     1
 [4,]    0.00000   12.352581    5.930017     0
 [5,]    0.00000   17.704375   14.306912     0
 [6,] 5193.05377 2460.128427 5775.726990     0
 [7,]    0.00000    6.530435   16.782363     1
 [8,]    0.00000    4.143704    5.417638     1
 [9,]    0.00000   40.004737    9.169053     0
[10,]    0.00000    4.407442   13.164520     1
[11,]    0.00000    5.902439   14.310414     1
[12,]  157.09207  274.690364  285.021484     1
[13,]    0.00000   12.002174   10.925111     0
[14,]    7.61737   16.833333   85.580237     1
[15,]    0.00000    7.694568    4.825572     0
[16,]  375.56458  379.017284  651.320274     1
[17,]    0.00000   10.408148    7.456598     0
> sum(in.ci)
[1] 10
> mean(in.ci)
[1] 0.5882353
>  
> ### ch2
> ## if probability calculated with pchisq is between .025
> ## and .975 then the ncp of original is in ci of replication
>  
> ## Study 73
> chi2.o <- 3.85
> chi2.r <- 4.8
> pchisq(chi2.r,1,chi2.o-1)
[1] 0.6923585
>  
> ## Study 84
> chi2.o <- 13.18
> chi2.r <- 7.1
> pchisq(chi2.r,1,chi2.o-1)
[1] 0.2045714
>  
> ## Study 104
> chi2.o <- 3.83
> chi2.r <- 0.387
> pchisq(chi2.r,1,chi2.o-1)
[1] 0.1339329
>  
> ## Study 165
> chi2.o <- 4.51
> chi2.r <- 1.57
> pchisq(chi2.r,1,chi2.o-1)
[1] 0.2665788
> 
> 
> #######################################
> ### Select studies for the analyses ###
> #######################################
> 
> # Written by RCM van Aert
> 
> df <- data.frame(ID = MASTER$ID, stat = as.character(MASTER$T_Test.Statistic..O.), df1 = MASTER$T_df1..O., yi, sei, fis.o, sei.o, N.o, pval.o, fis.r, sei.r, N.r, pval.r, 
+                  d.JEP, d.PSCog, d.PSSoc, d.PSOth, sc.impo, sc.surp, sc.expe1, sc.chal, sc.expe2, sc.self, power.r = as.numeric(levels(MASTER$Power..R.))[MASTER$Power..R.],
+                  N.o.tab = MASTER$T_N_O_for_tables, N.r.tab = MASTER$T_N_R_for_tables)
Warning message:
In data.frame(ID = MASTER$ID, stat = as.character(MASTER$T_Test.Statistic..O.),  :
  NAs introduced by coercion
> 
> ### Select: F(df1 = 1, df2), t, and r
> sub <- subset(df, (df$stat == "F" & df$df1 == 1) | df$stat == "t" | df$stat == "r")
> 
> ### Remove rows when NA on yi
> final <- sub[!is.na(sub$yi) & !is.na(sub$sei), ]
> 
> ####################
> ### Tables Brian ###
> ####################
> 
> ### Load metafor package
> library(metafor)
Loading 'metafor' package (version 1.9-5). For an overview 
and introduction to the package please type: help(metafor).
> 
> ### Meta-analytic mean and sd of the estimate combining per pair the original study and replication 
> est <- pval <- numeric()
> 
> for(i in 1:length(final$fis.o)) {
+   tmp <- rma(yi = c(final$fis.o[i], final$fis.r[i]), sei = c(final$sei.o[i], final$sei.r[i]), method = "FE")
+   est[i] <- tmp$b[1]
+   if (tmp$pval < 0.05) { pval[i] <- TRUE
+   } else { pval[i] <- FALSE }
+ }
> 
> ### Transforming Fisher z values into raw correlations
> cor <- (exp(2*est)-1)/(exp(2*est)+1)
> 
> mean(cor)
[1] 0.3170789
> sd(cor)
[1] 0.2281235
> sum(pval)/(length(pval)+2) # Proportion of statistically significant studies plus two because of two non-significant p-values for odds rations (ID = 84 and 165)
[1] 0.6842105
> 
> ### Per discipline
> mean(cor[final$d.JEP == 0 & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])
[1] 0.1416324
> mean(cor[final$d.JEP == 1])
[1] 0.3930916
> mean(cor[final$d.PSSoc == 1])
[1] 0.309368
> mean(cor[final$d.PSCog == 1])
[1] 0.4991458
> mean(cor[final$d.PSOth == 1])
[1] 0.4035643
> 
> sd(cor[final$d.JEP == 0 & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])
[1] 0.08370758
> sd(cor[final$d.JEP == 1])
[1] 0.2088261
> sd(cor[final$d.PSSoc == 1])
[1] 0.2584464
> sd(cor[final$d.PSCog == 1])
[1] 0.2012314
> sd(cor[final$d.PSOth == 1])
[1] 0.2354535
> 
> sum(pval[final$d.JEP == 0 & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])/(length(pval[final$d.JEP == 0 # Plus one because of one odds ratio (ID = 84)
+                                                                                                         & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])+1)
[1] 0.4285714
> sum(pval[final$d.JEP == 1])/length(pval[final$d.JEP == 1])
[1] 0.8636364
> sum(pval[final$d.PSSoc == 1])/(length(pval[final$d.PSSoc == 1])+1) # Plus one because of one odds ratio (ID = 165)
[1] 0.5789474
> sum(pval[final$d.PSCog == 1])/length(pval[final$d.PSCog == 1])
[1] 1
> sum(pval[final$d.PSOth == 1])/length(pval[final$d.PSOth == 1])
[1] 0.8333333
> 
> ### Subset of data with all cases which were replicated
> tmp <- subset(df, is.na(MASTER$T_pval_USE..R.) == FALSE)
> mean(tmp$power.r, na.rm = TRUE)
[1] 0.9203125
> 
> ### Subset of data with all cases published in JPSP
> tmp.JPSP <- subset(tmp, tmp$d.JEP == 0 & tmp$d.PSSoc == 0 & tmp$d.PSCog == 0 & tmp$d.PSOth == 0)
> mean(tmp.JPSP$power.r, na.rm = TRUE)
[1] 0.9045161
> 
> ### Subset of data with all cases published in JEP
> tmp.JEP <- subset(tmp, tmp$d.JEP == 1)
> mean(tmp.JEP$power.r, na.rm = TRUE)
[1] 0.9333333
> 
> ### Subset of data with all cases published in PSSoc
> tmp.PSSoc <- subset(tmp, tmp$d.PSSoc == 1)
> mean(tmp.PSSoc$power.r, na.rm = TRUE)
[1] 0.9154167
> 
> ### Subset of data with all cases published in PSCog
> tmp.PSCog <- subset(tmp, tmp$d.PSCog == 1)
> mean(tmp.PSCog$power.r, na.rm = TRUE)
[1] 0.974
> 
> ### Subset of data with all cases published in PSOth
> tmp.PSOth <- subset(tmp, tmp$d.PSOth == 1)
> mean(tmp.PSOth$power.r, na.rm = TRUE)
[1] 0.85
> 
> ### Subset of data with complete data on effect size
> tmp <- subset(df, is.na(MASTER$T_r..R.) == FALSE)
> summary(tmp$N.o.tab)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      7      30      54    2454      94  230000 
> summary(tmp$N.r.tab)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      7      31      68    4850     150  455300 
> 
> ### Subset of complete data JPSP
> tmp.JPSP <- subset(tmp, tmp$d.JEP == 0 & tmp$d.PSSoc == 0 & tmp$d.PSCog == 0 & tmp$d.PSOth == 0)
> summary(tmp.JPSP$N.o)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.     NA's 
    28.0     49.0     78.0   8610.0    105.5 230000.0        2 
> summary(tmp.JPSP$N.r)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.     NA's 
    28.0     69.5    113.0  17030.0    186.0 455300.0        2 
> 
> ### Subset of complete data JEP
> tmp.JEP <- subset(tmp, tmp$d.JEP == 1)
> summary(tmp.JEP$N.o)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   9.00   25.50   38.00   57.78   94.50  192.00       1 
> summary(tmp.JEP$N.r)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  16.00   30.50   41.00   70.31   83.20  270.00       1 
> 
> ### Subset of complete data PSSoc
> tmp.PSSoc <- subset(tmp, tmp$d.PSSoc == 1)
> summary(tmp.PSSoc$N.o)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   12.0    37.0    80.5   113.1   123.8   564.0       2 
> summary(tmp.PSSoc$N.r)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   24.0    60.0   125.0   276.6   172.0  3513.0       2 
> 
> ### Subset of complete data PSCog
> tmp.PSCog <- subset(tmp, tmp$d.PSCog == 1)
> summary(tmp.PSCog$N.o)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   9.00   12.00   22.00  101.10   50.25  662.00 
> summary(tmp.PSCog$N.r)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   9.00   18.50   25.00  107.10   98.25  662.00 
> 
> ### Subset of comlete data PSOth
> tmp.PSOth <- subset(tmp, tmp$d.PSOth == 1)
> summary(tmp.PSOth$N.o)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  11.00   20.25   34.50   35.33   43.50   70.00 
> summary(tmp.PSOth$N.r)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  10.00   11.50   14.50   23.83   38.50   47.00 
> 
> ### How often is original study within CI of replication
> ### Create confidence interval for replications
> ci.lb <- final$fis.r-qnorm(.975)*final$sei.r
> ci.ub <- final$fis.r+qnorm(.975)*final$sei.r
> 
> in.ci <- numeric()
> 
> for(i in 1:length(final$fis.r)) {
+   
+   if (final$fis.o[i] > ci.lb[i] & final$fis.o[i] < ci.ub[i]) {
+     in.ci[i] <- TRUE
+   } else { in.ci[i] <- FALSE }
+   
+ }
> 
> (sum(in.ci)+2)/(length(in.ci)+2) # Proportion of times the original study is within the CI of the replication plus two for the studies with odds ratios
[1] 0.4342105
> 
> ### Per discipline
> (sum(in.ci[final$d.JEP == 0 & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])+1)/(length(in.ci[final$d.JEP == 0 # Plus one because of one odds ratio (ID = 84)
+                                                                                                               & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])+1)
[1] 0.2380952
> sum(in.ci[final$d.JEP == 1])/length(in.ci[final$d.JEP == 1])
[1] 0.5909091
> (sum(in.ci[final$d.PSSoc == 1])+1)/(length(in.ci[final$d.PSSoc == 1])+1) # Plus one because of one odds ratio (ID = 165)
[1] 0.3684211
> sum(in.ci[final$d.PSCog == 1])/length(in.ci[final$d.PSCog == 1])
[1] 0.625
> sum(in.ci[final$d.PSOth == 1])/length(in.ci[final$d.PSOth == 1])
[1] 0.5
> 
> ### Two meta-analyses per pair for odds ratios
> ### Study 84
> logodds1 <- log((63*70)/(48*55))
> var1 <- 1/63 + 1/55 + 1/48 + 1/70
> logodds2 <- log((231*350)/(213*352))
> var2 <- 1/231 + 1/352 + 1/213 + 1/350
> 
> rma(yi = c(logodds1, logodds2), vi = c(var1, var2), method = "FE")

Fixed-Effects Model (k = 2)

Test for Heterogeneity: 
Q(df = 1) = 2.2832, p-val = 0.1308

Model Results:

estimate       se     zval     pval    ci.lb    ci.ub          
  0.1522   0.1102   1.3817   0.1671  -0.0637   0.3682          

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> # study 165
> logodds1 <- log((15*21)/(12*8))
> var1 <- 1/15 + 1/21 + 1/12 + 1/8
> logodds2 <- log((11*10)/(14*16))
> var2 <- 1/11 + 1/10 + 1/14 + 1/16
> 
> rma(yi = c(logodds1, logodds2), vi = c(var1, var2), method = "FE")

Fixed-Effects Model (k = 2)

Test for Heterogeneity: 
Q(df = 1) = 5.5721, p-val = 0.0182

Model Results:

estimate       se     zval     pval    ci.lb    ci.ub          
  0.2418   0.4023   0.6010   0.5479  -0.5468   1.0303          

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> #################################################################################
> ### Meta-analyses based on differences between original study and replication ###
> #################################################################################
> 
> ### Meta-analysis of null model
> res <- rma(yi = final$yi, sei = final$sei, method = "REML")
> res

Random-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of total heterogeneity): 0.0220 (SE = 0.0086)
tau (square root of estimated tau^2 value):      0.1482
I^2 (total heterogeneity / total variability):   47.15%
H^2 (total variability / sampling variability):  1.89

Test for Heterogeneity: 
Q(df = 73) = 151.4605, p-val < .0001

Model Results:

estimate       se     zval     pval    ci.lb    ci.ub          
  0.2113   0.0281   7.5117   <.0001   0.1562   0.2665      *** 

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> # pdf("C:/Users/S787802/Desktop/Funnel RPP.pdf", width = 11.2, height = 9, onefile = TRUE)
> funnel(res, main = "Funnel plot based on difference original and replication study")
> 
> ### Meta-analysis with a. PUBLISHING JOURNAL AND SUBDISCIPLINE as moderator (JPSP is reference category)
> rma(yi = final$yi, sei = final$sei, mods = ~ final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0198 (SE = 0.0084)
tau (square root of estimated tau^2 value):             0.1408
I^2 (residual heterogeneity / unaccounted variability): 43.53%
H^2 (unaccounted variability / sampling variability):   1.77
R^2 (amount of heterogeneity accounted for):            9.74%

Test for Residual Heterogeneity: 
QE(df = 69) = 127.6528, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5): 
QM(df = 4) = 5.9127, p-val = 0.2058

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt          0.2483  0.0463   5.3657  <.0001   0.1576  0.3390  ***
final$d.JEP     -0.0275  0.0733  -0.3756  0.7072  -0.1712  0.1162     
final$d.PSCog   -0.1162  0.1135  -1.0233  0.3062  -0.3387  0.1063     
final$d.PSSoc   -0.1037  0.0679  -1.5273  0.1267  -0.2368  0.0294     
final$d.PSOth    0.1985  0.1466   1.3534  0.1759  -0.0889  0.4859     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with sei.o as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sei.o, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0190 (SE = 0.0080)
tau (square root of estimated tau^2 value):             0.1378
I^2 (residual heterogeneity / unaccounted variability): 42.97%
H^2 (unaccounted variability / sampling variability):   1.75
R^2 (amount of heterogeneity accounted for):            13.47%

Test for Residual Heterogeneity: 
QE(df = 72) = 131.0991, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 3.4941, p-val = 0.0616

Model Results:

             estimate      se    zval    pval    ci.lb   ci.ub   
intrcpt        0.1047  0.0621  1.6866  0.0917  -0.0170  0.2264  .
final$sei.o    0.8241  0.4409  1.8693  0.0616  -0.0400  1.6881  .

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with sei.o as moderator with "ML" as estimator for tau2 (model comparison)
> res0 <- rma(yi = final$yi, sei = final$sei, mods = ~ final$sei.o, method = "ML")
> res0

Mixed-Effects Model (k = 74; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0180 (SE = 0.0076)
tau (square root of estimated tau^2 value):             0.1340
I^2 (residual heterogeneity / unaccounted variability): 41.59%
H^2 (unaccounted variability / sampling variability):   1.71
R^2 (amount of heterogeneity accounted for):            15.77%

Test for Residual Heterogeneity: 
QE(df = 72) = 131.0991, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 3.6421, p-val = 0.0563

Model Results:

             estimate      se    zval    pval    ci.lb   ci.ub   
intrcpt        0.1031  0.0613  1.6835  0.0923  -0.0169  0.2232  .
final$sei.o    0.8337  0.4369  1.9084  0.0563  -0.0225  1.6899  .

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with a. PUBLISHING JOURNAL AND SUBDISCIPLINE and sei.o as moderators (JPSP is reference category)
> rma(yi = final$yi, sei = final$sei, mods = ~ final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth + final$sei.o, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0171 (SE = 0.0079)
tau (square root of estimated tau^2 value):             0.1309
I^2 (residual heterogeneity / unaccounted variability): 39.65%
H^2 (unaccounted variability / sampling variability):   1.66
R^2 (amount of heterogeneity accounted for):            21.96%

Test for Residual Heterogeneity: 
QE(df = 68) = 115.0114, p-val = 0.0003

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 9.6215, p-val = 0.0867

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub   
intrcpt          0.1543  0.0683   2.2587  0.0239   0.0204  0.2881  *
final$d.JEP     -0.0635  0.0737  -0.8614  0.3890  -0.2081  0.0810   
final$d.PSCog   -0.1689  0.1139  -1.4838  0.1378  -0.3921  0.0542   
final$d.PSSoc   -0.1041  0.0654  -1.5923  0.1113  -0.2323  0.0240   
final$d.PSOth    0.1383  0.1482   0.9334  0.3506  -0.1521  0.4287   
final$sei.o      0.8480  0.4710   1.8002  0.0718  -0.0753  1.7712  .

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with a. PUBLISHING JOURNAL AND SUBDISCIPLINE and sei.o as moderators (JPSP is reference category) with "ML" as estimator for tau2 (model comparison)
> res1 <- rma(yi = final$yi, sei = final$sei, mods = ~ final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth + final$sei.o, method = "ML")
> res1

Mixed-Effects Model (k = 74; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0143 (SE = 0.0067)
tau (square root of estimated tau^2 value):             0.1194
I^2 (residual heterogeneity / unaccounted variability): 35.35%
H^2 (unaccounted variability / sampling variability):   1.55
R^2 (amount of heterogeneity accounted for):            33.12%

Test for Residual Heterogeneity: 
QE(df = 68) = 115.0114, p-val = 0.0003

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 10.6561, p-val = 0.0586

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub   
intrcpt          0.1508  0.0657   2.2959  0.0217   0.0221  0.2795  *
final$d.JEP     -0.0654  0.0712  -0.9186  0.3583  -0.2049  0.0741   
final$d.PSCog   -0.1724  0.1101  -1.5661  0.1173  -0.3881  0.0434   
final$d.PSSoc   -0.1053  0.0626  -1.6838  0.0922  -0.2279  0.0173  .
final$d.PSOth    0.1374  0.1453   0.9456  0.3443  -0.1474  0.4223   
final$sei.o      0.8761  0.4579   1.9132  0.0557  -0.0214  1.7737  .

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Comparing models with and without discipline
> anova(res0, res1)
        df    AIC     BIC    AICc  logLik    LRT   pval       QE  tau^2    R^2
Full     7 9.4276 25.5561 11.1246  2.2862               115.0114 0.0143       
Reduced  3 7.4640 14.3762  7.8069 -0.7320 6.0364 0.1964 131.0991 0.0180 20.59%
> 
> ### Meta-analysis with b. IMPORTANCE OF THE EFFECT as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.impo, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0226 (SE = 0.0088)
tau (square root of estimated tau^2 value):             0.1503
I^2 (residual heterogeneity / unaccounted variability): 47.35%
H^2 (unaccounted variability / sampling variability):   1.90
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity: 
QE(df = 72) = 148.6458, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.1157, p-val = 0.7338

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt          0.2128  0.0285   7.4700  <.0001   0.1570  0.2686  ***
final$sc.impo   -0.0118  0.0348  -0.3401  0.7338  -0.0799  0.0563     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with c. SURPRISING EFFECT as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.surp, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0226 (SE = 0.0088)
tau (square root of estimated tau^2 value):             0.1502
I^2 (residual heterogeneity / unaccounted variability): 47.63%
H^2 (unaccounted variability / sampling variability):   1.91
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity: 
QE(df = 72) = 151.3475, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.0001, p-val = 0.9920

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.2118  0.0284  7.4643  <.0001   0.1562  0.2674  ***
final$sc.surp    0.0003  0.0269  0.0100  0.9920  -0.0524  0.0529     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with d. EXPERIENCE AND EXPERTISE OF ORIGINAL TEAM as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.expe1, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0227 (SE = 0.0089)
tau (square root of estimated tau^2 value):             0.1508
I^2 (residual heterogeneity / unaccounted variability): 47.56%
H^2 (unaccounted variability / sampling variability):   1.91
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity: 
QE(df = 72) = 151.4551, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.0014, p-val = 0.9706

Model Results:

                estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt           0.2119  0.0284   7.4667  <.0001   0.1563  0.2675  ***
final$sc.expe1   -0.0014  0.0387  -0.0369  0.9706  -0.0773  0.0744     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with e. CHALLENGE OF CONDUCTING REPLICATION as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.chal, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0224 (SE = 0.0088)
tau (square root of estimated tau^2 value):             0.1497
I^2 (residual heterogeneity / unaccounted variability): 47.49%
H^2 (unaccounted variability / sampling variability):   1.90
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity: 
QE(df = 72) = 151.3050, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.4487, p-val = 0.5029

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.2115  0.0283  7.4792  <.0001   0.1561  0.2669  ***
final$sc.chal    0.0226  0.0338  0.6699  0.5029  -0.0436  0.0889     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with f. EXPERIENCE AND EXPERTISE OF REPLICATION TEAM
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.expe2, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0181 (SE = 0.0078)
tau (square root of estimated tau^2 value):             0.1345
I^2 (residual heterogeneity / unaccounted variability): 42.07%
H^2 (unaccounted variability / sampling variability):   1.73
R^2 (amount of heterogeneity accounted for):            17.62%

Test for Residual Heterogeneity: 
QE(df = 72) = 132.6556, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 6.1509, p-val = 0.0131

Model Results:

                estimate      se    zval    pval   ci.lb   ci.ub     
intrcpt           0.2086  0.0269  7.7553  <.0001  0.1559  0.2613  ***
final$sc.expe2    0.1250  0.0504  2.4801  0.0131  0.0262  0.2238    *

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with g. SELF-ASSESSED QUALITY OF REPLICATION
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.self, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0216 (SE = 0.0086)
tau (square root of estimated tau^2 value):             0.1470
I^2 (residual heterogeneity / unaccounted variability): 46.36%
H^2 (unaccounted variability / sampling variability):   1.86
R^2 (amount of heterogeneity accounted for):            1.58%

Test for Residual Heterogeneity: 
QE(df = 72) = 143.7578, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.4854, p-val = 0.4860

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt          0.2114  0.0280   7.5429  <.0001   0.1565  0.2664  ***
final$sc.self   -0.0394  0.0565  -0.6967  0.4860  -0.1502  0.0714     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ####################################################
> ### Meta-analyses based on only original studies ###
> ####################################################
> 
> ### Meta-analysis of null model
> res <- rma(yi = final$fis.o, sei = final$sei.o, method = "REML")
> res

Random-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of total heterogeneity): 0.0380 (SE = 0.0098)
tau (square root of estimated tau^2 value):      0.1949
I^2 (total heterogeneity / total variability):   73.80%
H^2 (total variability / sampling variability):  3.82

Test for Heterogeneity: 
Q(df = 73) = 310.4487, p-val < .0001

Model Results:

estimate       se     zval     pval    ci.lb    ci.ub          
  0.4279   0.0289  14.7878   <.0001   0.3712   0.4846      *** 

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> funnel(res, main = "Funnel plot based on original studies")
> 
> ### Meta-analysis with se in original study as moderator
> rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0235 (SE = 0.0071)
tau (square root of estimated tau^2 value):             0.1532
I^2 (residual heterogeneity / unaccounted variability): 63.24%
H^2 (unaccounted variability / sampling variability):   2.72
R^2 (amount of heterogeneity accounted for):            38.26%

Test for Residual Heterogeneity: 
QE(df = 72) = 207.8784, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 36.2618, p-val < .0001

Model Results:

             estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt        0.1028  0.0574  1.7897  0.0735  -0.0098  0.2154    .
final$sei.o    2.3291  0.3868  6.0218  <.0001   1.5710  3.0872  ***

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in original study as moderator with "ML" as estimator for tau2 (model comparison)
> res0 <- rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o, method = "ML")
> res0

Mixed-Effects Model (k = 74; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0226 (SE = 0.0068)
tau (square root of estimated tau^2 value):             0.1504
I^2 (residual heterogeneity / unaccounted variability): 62.38%
H^2 (unaccounted variability / sampling variability):   2.66
R^2 (amount of heterogeneity accounted for):            39.24%

Test for Residual Heterogeneity: 
QE(df = 72) = 207.8784, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 36.8419, p-val < .0001

Model Results:

             estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt        0.1028  0.0568  1.8107  0.0702  -0.0085  0.2142    .
final$sei.o    2.3289  0.3837  6.0698  <.0001   1.5769  3.0809  ***

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in original study and dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0231 (SE = 0.0072)
tau (square root of estimated tau^2 value):             0.1519
I^2 (residual heterogeneity / unaccounted variability): 61.99%
H^2 (unaccounted variability / sampling variability):   2.63
R^2 (amount of heterogeneity accounted for):            39.25%

Test for Residual Heterogeneity: 
QE(df = 68) = 199.1557, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 41.6224, p-val < .0001

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.0498  0.0642  0.7756  0.4380  -0.0760  0.1756     
final$sei.o      2.1120  0.4209  5.0182  <.0001   1.2871  2.9368  ***
final$d.JEP      0.1319  0.0672  1.9614  0.0498   0.0001  0.2636    *
final$d.PSCog    0.1224  0.1047  1.1690  0.2424  -0.0828  0.3276     
final$d.PSSoc    0.1148  0.0638  1.8008  0.0717  -0.0101  0.2398    .
final$d.PSOth    0.1090  0.1120  0.9731  0.3305  -0.1106  0.3286     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in original study and dummy variables for journal and discipline (JPSP is reference category) with "ML" as estimator for tau2 (model comparison)
> res1 <- rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "ML")
> res1

Mixed-Effects Model (k = 74; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0205 (SE = 0.0064)
tau (square root of estimated tau^2 value):             0.1432
I^2 (residual heterogeneity / unaccounted variability): 59.18%
H^2 (unaccounted variability / sampling variability):   2.45
R^2 (amount of heterogeneity accounted for):            44.86%

Test for Residual Heterogeneity: 
QE(df = 68) = 199.1557, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 43.8068, p-val < .0001

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.0499  0.0620  0.8048  0.4209  -0.0716  0.1714     
final$sei.o      2.1159  0.4099  5.1622  <.0001   1.3125  2.9192  ***
final$d.JEP      0.1308  0.0650  2.0134  0.0441   0.0035  0.2581    *
final$d.PSCog    0.1204  0.1015  1.1865  0.2354  -0.0785  0.3192     
final$d.PSSoc    0.1143  0.0614  1.8632  0.0624  -0.0059  0.2346    .
final$d.PSOth    0.1085  0.1090  0.9961  0.3192  -0.1050  0.3221     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Comparing models with and without discipline
> anova(res0, res1)
        df      AIC      BIC     AICc  logLik    LRT   pval       QE  tau^2
Full     7 -16.6631  -0.5347 -14.9662 15.3316               199.1557 0.0205
Reduced  3 -19.3724 -12.4602 -19.0296 12.6862 5.2907 0.2587 207.8784 0.0226
          R^2
Full         
Reduced 9.26%
> 
> ### Meta-analysis with dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0339 (SE = 0.0093)
tau (square root of estimated tau^2 value):             0.1841
I^2 (residual heterogeneity / unaccounted variability): 70.70%
H^2 (unaccounted variability / sampling variability):   3.41
R^2 (amount of heterogeneity accounted for):            10.79%

Test for Residual Heterogeneity: 
QE(df = 69) = 275.9879, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5): 
QM(df = 4) = 14.0819, p-val = 0.0070

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.2908  0.0494  5.8903  <.0001   0.1940  0.3875  ***
final$d.JEP      0.2289  0.0730  3.1333  0.0017   0.0857  0.3720   **
final$d.PSCog    0.2885  0.1116  2.5852  0.0097   0.0698  0.5073   **
final$d.PSSoc    0.1251  0.0727  1.7195  0.0855  -0.0175  0.2676    .
final$d.PSOth    0.2536  0.1199  2.1147  0.0345   0.0185  0.4886    *

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in original study, dummy variables for journal and discipline (JPSP is reference category), and its interactions as moderators
> rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth + final$sei.o*final$d.JEP + final$sei.o*final$d.PSSoc + final$sei.o*final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0241 (SE = 0.0076)
tau (square root of estimated tau^2 value):             0.1553
I^2 (residual heterogeneity / unaccounted variability): 62.84%
H^2 (unaccounted variability / sampling variability):   2.69
R^2 (amount of heterogeneity accounted for):            36.51%

Test for Residual Heterogeneity: 
QE(df = 65) = 195.9150, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6,7,8,9): 
QM(df = 8) = 40.8856, p-val < .0001

Model Results:

                           estimate      se     zval    pval    ci.lb   ci.ub
intrcpt                      0.0619  0.0920   0.6735  0.5006  -0.1183  0.2422
final$sei.o                  2.0028  0.7150   2.8011  0.0051   0.6014  3.4041
final$d.JEP                  0.1037  0.1561   0.6639  0.5067  -0.2024  0.4097
final$d.PSCog                0.1308  0.1134   1.1526  0.2491  -0.0916  0.3531
final$d.PSSoc                0.0935  0.1426   0.6557  0.5120  -0.1860  0.3731
final$d.PSOth                0.1372  0.3161   0.4339  0.6643  -0.4824  0.7568
final$sei.o:final$d.JEP      0.2134  1.0347   0.2062  0.8366  -1.8145  2.2413
final$sei.o:final$d.PSSoc    0.1878  1.1093   0.1693  0.8656  -1.9864  2.3621
final$sei.o:final$d.PSOth   -0.1153  1.7387  -0.0663  0.9471  -3.5231  3.2924
                             
intrcpt                      
final$sei.o                **
final$d.JEP                  
final$d.PSCog                
final$d.PSSoc                
final$d.PSOth                
final$sei.o:final$d.JEP      
final$sei.o:final$d.PSSoc    
final$sei.o:final$d.PSOth    

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> #######################################################
> ### Meta-analyses based on only replication studies ###
> #######################################################
> 
> ### Meta-analysis of null model
> res <- rma(yi = final$fis.r, sei = final$sei.r, method = "REML")
> res

Random-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of total heterogeneity): 0.0717 (SE = 0.0152)
tau (square root of estimated tau^2 value):      0.2677
I^2 (total heterogeneity / total variability):   90.67%
H^2 (total variability / sampling variability):  10.71

Test for Heterogeneity: 
Q(df = 73) = 468.2343, p-val < .0001

Model Results:

estimate       se     zval     pval    ci.lb    ci.ub          
  0.2125   0.0356   5.9659   <.0001   0.1427   0.2823      *** 

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> funnel(res, main = "Funnel plot based on replication studies")
> # dev.off()
> 
> ### Meta-analysis with se in replication study as moderator
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0565 (SE = 0.0126)
tau (square root of estimated tau^2 value):             0.2378
I^2 (residual heterogeneity / unaccounted variability): 87.52%
H^2 (unaccounted variability / sampling variability):   8.01
R^2 (amount of heterogeneity accounted for):            21.10%

Test for Residual Heterogeneity: 
QE(df = 72) = 414.1327, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 13.6138, p-val = 0.0002

Model Results:

             estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt       -0.0157  0.0687  -0.2279  0.8198  -0.1503  0.1190     
final$sei.r    1.7356  0.4704   3.6897  0.0002   0.8136  2.6575  ***

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in replication study as moderator with "ML" as estimator for tau2 (model comparison)
> res0 <- rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r, method = "ML")
> res0

Mixed-Effects Model (k = 74; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0543 (SE = 0.0120)
tau (square root of estimated tau^2 value):             0.2330
I^2 (residual heterogeneity / unaccounted variability): 87.07%
H^2 (unaccounted variability / sampling variability):   7.73
R^2 (amount of heterogeneity accounted for):            22.57%

Test for Residual Heterogeneity: 
QE(df = 72) = 414.1327, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 13.9926, p-val = 0.0002

Model Results:

             estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt       -0.0160  0.0676  -0.2372  0.8125  -0.1486  0.1165     
final$sei.r    1.7382  0.4647   3.7407  0.0002   0.8274  2.6489  ***

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in replication study and dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0480 (SE = 0.0114)
tau (square root of estimated tau^2 value):             0.2192
I^2 (residual heterogeneity / unaccounted variability): 84.04%
H^2 (unaccounted variability / sampling variability):   6.26
R^2 (amount of heterogeneity accounted for):            32.98%

Test for Residual Heterogeneity: 
QE(df = 68) = 334.0598, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 28.1507, p-val < .0001

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub    
intrcpt         -0.1297  0.0751  -1.7265  0.0843  -0.2769  0.0175   .
final$sei.r      1.8068  0.5498   3.2865  0.0010   0.7293  2.8843  **
final$d.JEP      0.1262  0.0869   1.4534  0.1461  -0.0440  0.2965    
final$d.PSCog    0.2614  0.1252   2.0879  0.0368   0.0160  0.5067   *
final$d.PSSoc    0.2038  0.0793   2.5706  0.0102   0.0484  0.3591   *
final$d.PSOth   -0.1647  0.1654  -0.9958  0.3194  -0.4890  0.1595    

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in replication study and dummy variables for journal and discipline (JPSP is reference category) with "ML" as estimator for tau2 (model comparison)
> res1 <- rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "ML")
> res1

Mixed-Effects Model (k = 74; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0421 (SE = 0.0098)
tau (square root of estimated tau^2 value):             0.2051
I^2 (residual heterogeneity / unaccounted variability): 82.18%
H^2 (unaccounted variability / sampling variability):   5.61
R^2 (amount of heterogeneity accounted for):            39.97%

Test for Residual Heterogeneity: 
QE(df = 68) = 334.0598, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 30.5683, p-val < .0001

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt         -0.1291  0.0714  -1.8084  0.0705  -0.2690  0.0108    .
final$sei.r      1.8079  0.5275   3.4275  0.0006   0.7741  2.8418  ***
final$d.JEP      0.1251  0.0827   1.5127  0.1303  -0.0370  0.2871     
final$d.PSCog    0.2611  0.1195   2.1842  0.0289   0.0268  0.4954    *
final$d.PSSoc    0.2020  0.0751   2.6901  0.0071   0.0548  0.3492   **
final$d.PSOth   -0.1655  0.1591  -1.0403  0.2982  -0.4773  0.1463     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Comparing models with and without discipline
> anova(res0, res1)
        df     AIC     BIC    AICc   logLik     LRT   pval       QE  tau^2
Full     7 32.6449 48.7733 34.3419  -9.3224                334.0598 0.0421
Reduced  3 37.6513 44.5635 37.9941 -15.8256 13.0064 0.0112 414.1327 0.0543
           R^2
Full          
Reduced 22.48%
> 
> ### Meta-analysis with se in replication study and dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0480 (SE = 0.0114)
tau (square root of estimated tau^2 value):             0.2192
I^2 (residual heterogeneity / unaccounted variability): 84.04%
H^2 (unaccounted variability / sampling variability):   6.26
R^2 (amount of heterogeneity accounted for):            32.98%

Test for Residual Heterogeneity: 
QE(df = 68) = 334.0598, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 28.1507, p-val < .0001

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub    
intrcpt         -0.1297  0.0751  -1.7265  0.0843  -0.2769  0.0175   .
final$sei.r      1.8068  0.5498   3.2865  0.0010   0.7293  2.8843  **
final$d.JEP      0.1262  0.0869   1.4534  0.1461  -0.0440  0.2965    
final$d.PSCog    0.2614  0.1252   2.0879  0.0368   0.0160  0.5067   *
final$d.PSSoc    0.2038  0.0793   2.5706  0.0102   0.0484  0.3591   *
final$d.PSOth   -0.1647  0.1654  -0.9958  0.3194  -0.4890  0.1595    

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0587 (SE = 0.0132)
tau (square root of estimated tau^2 value):             0.2422
I^2 (residual heterogeneity / unaccounted variability): 87.25%
H^2 (unaccounted variability / sampling variability):   7.84
R^2 (amount of heterogeneity accounted for):            18.13%

Test for Residual Heterogeneity: 
QE(df = 69) = 386.7867, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5): 
QM(df = 4) = 15.2444, p-val = 0.0042

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub    
intrcpt          0.0420  0.0589  0.7124  0.4762  -0.0735  0.1574    
final$d.JEP      0.2414  0.0863  2.7988  0.0051   0.0724  0.4105  **
final$d.PSCog    0.4124  0.1253  3.2900  0.0010   0.1667  0.6581  **
final$d.PSSoc    0.2167  0.0861  2.5158  0.0119   0.0479  0.3855   *
final$d.PSOth    0.0930  0.1551  0.5998  0.5487  -0.2110  0.3970    

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in replication study, dummy variables for journal and discipline (JPSP is reference category), and its interactions as moderators
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth + final$sei.r*final$d.JEP + final$sei.r*final$d.PSSoc + final$sei.r*final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 74; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0503 (SE = 0.0120)
tau (square root of estimated tau^2 value):             0.2244
I^2 (residual heterogeneity / unaccounted variability): 83.30%
H^2 (unaccounted variability / sampling variability):   5.99
R^2 (amount of heterogeneity accounted for):            29.77%

Test for Residual Heterogeneity: 
QE(df = 65) = 331.6538, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6,7,8,9): 
QM(df = 8) = 29.5223, p-val = 0.0003

Model Results:

                           estimate      se     zval    pval    ci.lb   ci.ub
intrcpt                     -0.0432  0.1045  -0.4134  0.6793  -0.2481  0.1616
final$sei.r                  0.8936  0.9346   0.9561  0.3390  -0.9382  2.7254
final$d.JEP                 -0.0052  0.1975  -0.0265  0.9789  -0.3924  0.3819
final$d.PSCog                0.3360  0.1413   2.3787  0.0174   0.0592  0.6129
final$d.PSSoc               -0.0183  0.1746  -0.1045  0.9167  -0.3605  0.3240
final$d.PSOth               -0.2001  0.3970  -0.5040  0.6143  -0.9782  0.5780
final$sei.r:final$d.JEP      1.2005  1.3667   0.8784  0.3797  -1.4782  3.8792
final$sei.r:final$d.PSSoc    2.2662  1.5712   1.4423  0.1492  -0.8133  5.3458
final$sei.r:final$d.PSOth    0.6956  1.7832   0.3901  0.6965  -2.7995  4.1907
                            
intrcpt                     
final$sei.r                 
final$d.JEP                 
final$d.PSCog              *
final$d.PSSoc               
final$d.PSOth               
final$sei.r:final$d.JEP     
final$sei.r:final$d.PSSoc   
final$sei.r:final$d.PSOth   

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ##############################
> ### Meta-analyses per pair ###
> ##############################
> 
> ### How often is the null hypotheses rejected in the meta-analysis
> in.ci <- es.meta <- se.meta <- ci.lb.meta <- ci.ub.meta <- pval.meta <- numeric()
> 
> for(i in 1:length(final$fis.o)) {
+   tmp <- rma(yi = c(final$fis.o[i], final$fis.r[i]), sei = c(final$sei.o[i], final$sei.r[i]), method = "FE")
+   es.meta[i] <- tmp$b[1]
+   se.meta[i] <- tmp$se
+   ci.lb.meta[i] <- tmp$ci.lb
+   ci.ub.meta[i] <- tmp$ci.ub
+   pval.meta[i] <- tmp$pval
+   
+   if(tmp$pval < 0.05) { in.ci[i] <- 1
+   } else { in.ci[i] <- 0 }
+ }
> 
> sum(in.ci)/length(in.ci) # Proportion of times the null hypothesis of no effect is rejected
[1] 0.7027027
> 
> ### Create data frame
> tab <- data.frame(ID = final$ID, fis.o = final$fis.o, sei.o = final$sei.o, pval.o = final$pval.o, fis.r = final$fis.r, sei.r = final$sei.r, 
+                   pval.r = final$pval.r, diff = final$yi, es.meta = es.meta, se.meta = se.meta, ci.lb.meta = ci.lb.meta, ci.ub.meta = ci.ub.meta, pval.meta = pval.meta)
> round(tab, 3)
    ID fis.o sei.o pval.o  fis.r sei.r pval.r   diff es.meta se.meta ci.lb.meta
1    1 0.685 0.289  0.009  0.149 0.192  0.219  0.535   0.314   0.160      0.000
2    2 0.711 0.213  0.000  0.234 0.213  0.136  0.477   0.472   0.151      0.177
3    3 0.454 0.209  0.015 -0.219 0.183  0.884  0.672   0.073   0.137     -0.196
4    4 0.233 0.073  0.001 -0.006 0.061  0.540  0.239   0.093   0.047      0.001
5    5 0.499 0.183  0.003  0.136 0.147  0.179  0.363   0.279   0.115      0.054
6    6 0.685 0.213  0.001  0.419 0.183  0.011  0.267   0.532   0.139      0.260
7    7 0.898 0.101  0.000  0.132 0.277  0.317  0.765   0.808   0.095      0.622
8    8 0.635 0.167  0.000 -0.111 0.183  0.729  0.746   0.296   0.123      0.055
9   10 0.865 0.192  0.000  1.047 0.189  0.000 -0.183   0.958   0.135      0.693
10  11 0.815 0.224  0.000  0.506 0.189  0.004  0.309   0.634   0.144      0.351
11  15 0.198 0.104  0.028  0.252 0.065  0.000 -0.054   0.237   0.055      0.129
12  19 0.634 0.183  0.000  0.426 0.236  0.035  0.208   0.556   0.144      0.273
13  20 0.228 0.104  0.014  0.019 0.098  0.421  0.209   0.117   0.071     -0.022
14  24 0.381 0.081  0.000  0.292 0.146  0.023  0.089   0.360   0.071      0.221
15  26 0.162 0.104  0.059  0.145 0.105  0.083  0.017   0.154   0.074      0.009
16  27 0.398 0.183  0.015  0.400 0.120  0.000 -0.002   0.399   0.101      0.202
17  28 0.356 0.183  0.026  0.104 0.106  0.164  0.252   0.167   0.092     -0.012
18  29 0.946 0.408  0.010  0.875 0.277  0.001  0.071   0.897   0.229      0.448
19  32 0.730 0.169  0.000  0.524 0.167  0.001  0.207   0.626   0.119      0.393
20  33 0.572 0.162  0.000  0.327 0.162  0.022  0.245   0.450   0.115      0.225
21  36 0.895 0.229  0.000  0.832 0.229  0.000  0.063   0.864   0.162      0.546
22  37 0.620 0.316  0.025  0.365 0.250  0.072  0.255   0.463   0.196      0.079
23  44 0.368 0.123  0.001  0.151 0.076  0.023  0.217   0.211   0.064      0.084
24  48 0.229 0.105  0.014  0.052 0.072  0.235  0.177   0.109   0.060     -0.007
25  49 0.398 0.174  0.011 -0.030 0.108  0.611  0.429   0.089   0.092     -0.091
26  52 0.209 0.088  0.009  0.094 0.095  0.161  0.114   0.156   0.065      0.030
27  53 0.397 0.183  0.015  0.077 0.118  0.257  0.320   0.171   0.099     -0.023
28  56 0.399 0.101  0.000 -0.042 0.164  0.601  0.441   0.278   0.086      0.109
29  58 0.169 0.074  0.012  0.037 0.060  0.270  0.132   0.089   0.047     -0.003
30  61 0.223 0.097  0.010 -0.005 0.068  0.528  0.228   0.070   0.055     -0.038
31  63 0.281 0.122  0.011  0.074 0.083  0.187  0.207   0.140   0.069      0.005
32  65 0.462 0.158  0.002  0.012 0.088  0.447  0.450   0.118   0.077     -0.033
33  68 0.188 0.093  0.022  0.003 0.067  0.482  0.185   0.066   0.055     -0.041
34  71 0.226 0.052  0.000  0.073 0.076  0.166  0.152   0.177   0.043      0.093
35  72 0.211 0.062  0.000  0.045 0.064  0.242  0.166   0.129   0.045      0.042
36  81 0.275 0.106  0.005 -0.102 0.086  0.883  0.377   0.047   0.067     -0.084
37  82 0.310 0.158  0.025  0.277 0.158  0.040  0.033   0.293   0.112      0.074
38  87 0.418 0.141  0.002  0.013 0.147  0.465  0.405   0.224   0.102      0.024
39  89 0.141 0.200  0.241  0.029 0.200  0.442  0.111   0.085   0.141     -0.192
40  93 0.329 0.110  0.001 -0.136 0.122  0.867  0.465   0.120   0.082     -0.041
41  94 0.359 0.200  0.036  0.298 0.131  0.012  0.061   0.317   0.110      0.101
42  97 0.398 0.118  0.000 -0.037 0.026  0.923  0.435  -0.017   0.025     -0.067
43 106 0.402 0.174  0.010 -0.227 0.151  0.934  0.629   0.043   0.114     -0.181
44 107 0.226 0.110  0.020  0.105 0.080  0.095  0.121   0.147   0.065      0.020
45 110 0.625 0.060  0.000  0.091 0.084  0.139  0.533   0.445   0.049      0.349
46 111 0.347 0.136  0.005  0.230 0.093  0.007  0.117   0.267   0.077      0.116
47 112 0.869 0.354  0.007  0.974 0.354  0.003 -0.104   0.922   0.250      0.432
48 113 0.831 0.090  0.000  1.005 0.076  0.000 -0.173   0.933   0.058      0.819
49 114 0.649 0.186  0.000  0.780 0.186  0.000 -0.131   0.714   0.131      0.457
50 115 0.552 0.183  0.001 -0.485 0.378  0.900  1.037   0.356   0.164      0.033
51 116 0.296 0.076  0.000  0.335 0.085  0.000 -0.039   0.313   0.057      0.202
52 118 0.217 0.095  0.011 -0.049 0.080  0.730  0.266   0.061   0.061     -0.059
53 120 0.400 0.189  0.017  0.255 0.158  0.053  0.145   0.315   0.121      0.077
54 121 1.262 0.333  0.000  1.054 0.218  0.000  0.208   1.116   0.183      0.759
55 122 0.912 0.408  0.013  1.608 0.258  0.000 -0.697   1.409   0.218      0.982
56 124 0.405 0.174  0.010 -0.034 0.122  0.611  0.439   0.111   0.100     -0.085
57 127 0.839 0.192  0.000  0.586 0.204  0.002  0.253   0.720   0.140      0.446
58 129 0.390 0.200  0.025  0.018 0.126  0.444  0.373   0.124   0.107     -0.085
59 133 0.479 0.213  0.012  0.452 0.167  0.003  0.027   0.462   0.131      0.205
60 134 0.213 0.094  0.011  0.550 0.066  0.000 -0.336   0.439   0.054      0.334
61 135 0.005 0.042  0.456  0.106 0.017  0.000 -0.102   0.092   0.016      0.062
62 136 0.547 0.192  0.002  0.103 0.135  0.223  0.444   0.249   0.110      0.033
63 145 1.017 0.115  0.000  0.780 0.169  0.000  0.237   0.942   0.095      0.755
64 146 0.775 0.277  0.003  0.545 0.316  0.042  0.230   0.675   0.209      0.267
65 148 0.191 0.072  0.004 -0.030 0.062  0.686  0.221   0.064   0.047     -0.028
66 149 0.191 0.072  0.004  0.018 0.057  0.373  0.173   0.084   0.044     -0.003
67 150 0.913 0.289  0.001  0.211 0.243  0.193  0.702   0.501   0.186      0.137
68 151 0.424 0.158  0.004  0.003 0.090  0.487  0.421   0.106   0.078     -0.047
69 153 1.292 0.408  0.001  0.121 0.408  0.384  1.171   0.706   0.289      0.140
70 154 0.460 0.122  0.000  0.110 0.277  0.345  0.349   0.403   0.112      0.184
71 155 0.321 0.141  0.012 -0.034 0.120  0.611  0.355   0.115   0.092     -0.065
72 158 0.394 0.164  0.008  0.437 0.104  0.000 -0.043   0.425   0.088      0.252
73 161 0.527 0.152  0.000  0.180 0.152  0.119  0.348   0.354   0.108      0.142
74 167 0.686 0.250  0.003  0.260 0.224  0.123  0.426   0.449   0.167      0.122
   ci.ub.meta pval.meta
1       0.628     0.050
2       0.768     0.002
3       0.342     0.594
4       0.185     0.047
5       0.504     0.015
6       0.803     0.000
7       0.994     0.000
8       0.537     0.016
9       1.222     0.000
10      0.917     0.000
11      0.344     0.000
12      0.839     0.000
13      0.257     0.099
14      0.499     0.000
15      0.298     0.037
16      0.596     0.000
17      0.347     0.068
18      1.347     0.000
19      0.858     0.000
20      0.674     0.000
21      1.182     0.000
22      0.848     0.018
23      0.337     0.001
24      0.226     0.066
25      0.270     0.332
26      0.283     0.015
27      0.365     0.084
28      0.447     0.001
29      0.181     0.057
30      0.179     0.205
31      0.275     0.042
32      0.268     0.125
33      0.173     0.224
34      0.261     0.000
35      0.217     0.004
36      0.178     0.480
37      0.512     0.009
38      0.424     0.028
39      0.362     0.547
40      0.280     0.144
41      0.532     0.004
42      0.033     0.506
43      0.266     0.707
44      0.274     0.023
45      0.541     0.000
46      0.418     0.001
47      1.412     0.000
48      1.047     0.000
49      0.972     0.000
50      0.678     0.031
51      0.425     0.000
52      0.181     0.322
53      0.553     0.009
54      1.474     0.000
55      1.837     0.000
56      0.307     0.268
57      0.995     0.000
58      0.333     0.246
59      0.720     0.000
60      0.544     0.000
61      0.123     0.000
62      0.465     0.024
63      1.129     0.000
64      1.084     0.001
65      0.157     0.171
66      0.171     0.058
67      0.865     0.007
68      0.260     0.176
69      1.272     0.014
70      0.622     0.000
71      0.295     0.210
72      0.597     0.000
73      0.565     0.001
74      0.776     0.007
> 
> ### Check how often effect size original study is within CI of meta-analysis
> in.ci.meta <- numeric()
> 
> for(i in 1:length(final$fis.o)) {
+   
+   if(final$fis.o[i] > ci.lb.meta[i] & final$fis.o[i] < ci.ub.meta[i]) {
+     in.ci.meta[i] <- TRUE
+   } else { in.ci.meta[i] <- FALSE }
+   
+ }
> 
> sum(in.ci.meta)/length(in.ci.meta) # Proportion of times the original study is within the CI of meta-analysis
[1] 0.5810811
> 
> ######################################################################################
> ### Predicting how often effect size of original study is within CI of replication ###
> ######################################################################################
> 
> ### Predicting how often effect size of original study is within CI of replication
> overlap <- numeric()
> points <- 1000000
> p <- 1:points/(points+1)
> 
> for (i in 1:length(final$N.r)) {
+   zu <- qnorm(p,0,1/sqrt(final$N.r[i]-3)) + qnorm(.975)/sqrt(final$N.r[i]-3)
+   zl <- zu - 2*qnorm(.975)/sqrt(final$N.r[i]-3)
+   overlap[i] <- mean(pnorm(zu,0,1/sqrt(final$N.o[i]-3))) - mean(pnorm(zl,0,1/sqrt(final$N.o[i]-3)))
+ }
> overlap
 [1] 0.7230489 0.8342246 0.8033464 0.7929864 0.7818304 0.7976371 0.9344699
 [8] 0.8522521 0.8303252 0.7941837 0.6996958 0.8787363 0.8208099 0.9130317
[15] 0.8365067 0.7193794 0.6749298 0.7292801 0.8312130 0.8342246 0.8342246
[22] 0.7758322 0.6949578 0.7344564 0.7000259 0.8508379 0.7121914 0.9050646
[29] 0.7820982 0.7385099 0.7306008 0.6582552 0.7484706 0.8942939 0.8383796
[36] 0.7823072 0.8342246 0.8427805 0.8342246 0.8540522 0.7179258 0.3265906
[43] 0.8005429 0.7529083 0.8894029 0.7320969 0.8342246 0.7928042 0.8342246
[50] 0.9224120 0.8551690 0.7916176 0.7914959 0.7169613 0.7051984 0.7397986
[57] 0.8461565 0.7038225 0.7726095 0.7387346 0.5331224 0.7392696 0.8944217
[64] 0.8593898 0.8002104 0.7738995 0.7926131 0.6684134 0.8342246 0.9271337
[71] 0.7960785 0.7061323 0.8342246 0.8086667
> mean(overlap)
[1] 0.7846
> 
> #######################################
> ### Correlations between moderators ###
> #######################################
> 
> ### Load package for correlation table
> library(Hmisc)
> 
> ### Create variable with meta-analysis estimate with NAs
> es.meta.all <- vector(length = nrow(df))
> s <- 1
> for(i in 1:max(final$ID)) {
+   if (i == final$ID[s]) {
+     es.meta.all[i] <- es.meta[s]
+     s <- s + 1
+   } else {
+     es.meta.all[i] <- NA
+   }
+ }
> 
> ### Create matrix for correlation table
> mat <- cbind(df$fis.o, df$fis.r, df$yi, es.meta.all, df$sc.imp, df$sc.surp, df$sc.expe1, df$sc.chal, df$sc.expe2, df$sc.self)
> colnames(mat) <- c("fis.o", "fis.r", "diff", "es.meta", "importance", "surprising", "experience.O", "challenge", "experience.R", "quality")
> 
> ### Subset of only the replicated studies
> mat <- subset(mat, is.na(df$fis.r) == FALSE)
> 
> ### Create table with correlations
> rcorr(mat, type = "spearman")
             fis.o fis.r  diff es.meta importance surprising experience.O
fis.o         1.00  0.51  0.31    0.80      -0.12      -0.16        -0.09
fis.r         0.51  1.00 -0.56    0.85      -0.14      -0.15        -0.09
diff          0.31 -0.56  1.00   -0.21       0.02       0.06        -0.03
es.meta       0.80  0.85 -0.21    1.00      -0.20      -0.23        -0.05
importance   -0.12 -0.14  0.02   -0.20       1.00       0.43         0.35
surprising   -0.16 -0.15  0.06   -0.23       0.43       1.00         0.09
experience.O -0.09 -0.09 -0.03   -0.05       0.35       0.09         1.00
challenge    -0.19 -0.24  0.09   -0.26       0.21       0.19         0.11
experience.R  0.15  0.05  0.13    0.05       0.05       0.12        -0.11
quality      -0.08 -0.03  0.01    0.05       0.18       0.01         0.23
             challenge experience.R quality
fis.o            -0.19         0.15   -0.08
fis.r            -0.24         0.05   -0.03
diff              0.09         0.13    0.01
es.meta          -0.26         0.05    0.05
importance        0.21         0.05    0.18
surprising        0.19         0.12    0.01
experience.O      0.11        -0.11    0.23
challenge         1.00         0.06    0.12
experience.R      0.06         1.00   -0.09
quality           0.12        -0.09    1.00

n
             fis.o fis.r diff es.meta importance surprising experience.O
fis.o           97    97   97      74         97         97           97
fis.r           97    97   97      74         97         97           97
diff            97    97   97      74         97         97           97
es.meta         74    74   74      97         74         74           74
importance      97    97   97      74         97         97           97
surprising      97    97   97      74         97         97           97
experience.O    97    97   97      74         97         97           97
challenge       97    97   97      74         97         97           97
experience.R    96    96   96      74         96         96           96
quality         97    97   97      74         97         97           97
             challenge experience.R quality
fis.o               97           96      97
fis.r               97           96      97
diff                97           96      97
es.meta             74           74      74
importance          97           96      97
surprising          97           96      97
experience.O        97           96      97
challenge           97           96      97
experience.R        96           97      96
quality             97           96      97

P
             fis.o  fis.r  diff   es.meta importance surprising experience.O
fis.o               0.0000 0.0020 0.0000  0.2309     0.1079     0.3969      
fis.r        0.0000        0.0000 0.0000  0.1581     0.1349     0.3765      
diff         0.0020 0.0000        0.0776  0.8498     0.5524     0.7842      
es.meta      0.0000 0.0000 0.0776         0.0885     0.0465     0.6729      
importance   0.2309 0.1581 0.8498 0.0885             0.0000     0.0004      
surprising   0.1079 0.1349 0.5524 0.0465  0.0000                0.3881      
experience.O 0.3969 0.3765 0.7842 0.6729  0.0004     0.3881                 
challenge    0.0600 0.0172 0.3816 0.0246  0.0364     0.0577     0.2888      
experience.R 0.1360 0.6328 0.1940 0.6779  0.6276     0.2448     0.3062      
quality      0.4232 0.8010 0.8844 0.6647  0.0845     0.8864     0.0213      
             challenge experience.R quality
fis.o        0.0600    0.1360       0.4232 
fis.r        0.0172    0.6328       0.8010 
diff         0.3816    0.1940       0.8844 
es.meta      0.0246    0.6779       0.6647 
importance   0.0364    0.6276       0.0845 
surprising   0.0577    0.2448       0.8864 
experience.O 0.2888    0.3062       0.0213 
challenge              0.5626       0.2607 
experience.R 0.5626                 0.3960 
quality      0.2607    0.3960              
> 
> #########################
> ##### TABLE 2 BRIAN #####
> #########################
> 
> # Notes:
> # p-value = recalculated p-value
> # effect size = correlation coefficient because we use Spearman's rank correlation transformation is not required
> # T_pval_USE..R is used to create a subset of replicated studies
> 
> ### Variables in the columns
> rows <- cbind(MASTER$T_pval_USE..O., MASTER$T_r..O., MASTER$T_N..O., df$sc.surp, df$sc.expe1, df$power.r, MASTER$T_N_R_for_tables, df$sc.chal, df$sc.expe2, df$sc.self, MASTER$T_pval_USE..R)
> colnames(rows) <- c("p-value", "Effect size", "Original sample size", "Surprising effect", "Experience and expertise of team O", "Power", 
+                     "Replication Sample size", "Challenge of conducting replication", "Experience and expertise of team R", "Self-assessed quality of replication", "sub")
> 
> ### "Replications p < 0.05 in original direction (all signicant replication studies are in the same direction as the original study)"
> mat <- cbind(MASTER$T_sign_R, rows)
> colnames(mat) <- c("rep.dir", "p-value", "Effect size", "Original sample size", "Surprising effect", "Experience and expertise of team O", "Power", 
+                    "Replication Sample size", "Challenge of conducting replication", "Experience and expertise of team R", "Self-assessed quality of replication", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -12) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
                             p-value                          Effect size 
                         -0.30905175                           0.28342015 
                Original sample size                    Surprising effect 
                         -0.15386122                          -0.25537726 
  Experience and expertise of team O                                Power 
                         -0.05360381                           0.38917571 
             Replication Sample size  Challenge of conducting replication 
                         -0.05157080                          -0.21951762 
  Experience and expertise of team R Self-assessed quality of replication 
                         -0.08931839                          -0.03957047 
> 
> ### "Effect size difference" (Fisher z)
> es.dif <- df$fis.o - df$fis.r
> 
> mat <- cbind(es.dif, rows)
> colnames(mat) <- c("Effect Size Difference", "p-value", "Effect size", "Original sample size", "Surprising effect", "Experience and expertise of team O", "Power", 
+                    "Replication Sample size", "Challenge of conducting replication", "Experience and expertise of team R", "Self-assessed quality of replication", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -12) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
                             p-value                          Effect size 
                         -0.07399956                           0.30973303 
                Original sample size                    Surprising effect 
                         -0.11428986                           0.06106272 
  Experience and expertise of team O                                Power 
                         -0.02816013                          -0.06508404 
             Replication Sample size  Challenge of conducting replication 
                         -0.24801920                           0.08982820 
  Experience and expertise of team R Self-assessed quality of replication 
                          0.13372310                           0.01495051 
> 
> ### "Meta-analytic estimate" (Fisher z)
> mat <- cbind(es.meta.all, rows)
> colnames(mat) <- c("Meta-analytic estimate", "p-value", "Effect size", "Original sample size", "Surprising effect", "Experience and expertise of team O", "Power", 
+                    "Replication Sample size", "Challenge of conducting replication", "Experience and expertise of team R", "Self-assessed quality of replication", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -12) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
                             p-value                          Effect size 
                         -0.47601983                           0.80049461 
                Original sample size                    Surprising effect 
                         -0.47907406                          -0.23223488 
  Experience and expertise of team O                                Power 
                         -0.04989300                           0.15855628 
             Replication Sample size  Challenge of conducting replication 
                         -0.69563091                          -0.26122543 
  Experience and expertise of team R Self-assessed quality of replication 
                          0.04909366                           0.05122811 
> 
> ### "original effect size within replication 95% CI"
> ### How often is original study within CI of replication
> ### Create confidence interval for replications
> ci.lb <- fis.r-qnorm(.975)*sei.r
> ci.ub <- fis.r+qnorm(.975)*sei.r
> 
> tmp <- in.ci <- rep(NA, length(ci.lb))
> 
> for(i in 1:length(fis.r)) {
+   
+   if (is.na(fis.o[i]) == TRUE) {
+     tmp[i] <- NA
+   } else if (any(is.na(c(ci.lb[i], ci.ub[i])) == TRUE)) {
+     tmp[i] <- NA
+   } else if (fis.o[i] > ci.lb[i] & fis.o[i] < ci.ub[i]) {
+     tmp[i] <- TRUE
+   } else { tmp[i] <- FALSE }
+   
+ }
> 
> ### Select only studies with test statistic t or F and df1 = 1
> dat <- data.frame(ID = MASTER$ID, stat = as.character(MASTER$T_Test.Statistic..O.), df1 = MASTER$T_df1..O., tmp)
> sub <- subset(dat, (dat$stat == "F" & dat$df1 == 1) | dat$stat == "t" | dat$stat == "r")
> in.ci[sub$ID] <- sub$tmp
> 
> ### Store results for other statistics
> in.ci[c(22,43,46,64,132,140,143)] <- FALSE
> in.ci[c(12,13,17,50,55,80,86,117,139,142,73,84,104,165)] <- TRUE
> 
> mat <- cbind(in.ci, rows)
> colnames(mat) <- c("Original in CI", "p-value", "Effect size", "Original sample size", "Surprising effect", "Experience and expertise of team O", "Power", 
+                    "Replication Sample size", "Challenge of conducting replication", "Experience and expertise of team R", "Self-assessed quality of replication", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -12) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
                             p-value                          Effect size 
                          0.01921947                           0.13684261 
                Original sample size                    Surprising effect 
                         -0.23882449                          -0.06773935 
  Experience and expertise of team O                                Power 
                         -0.09186970                          -0.03248774 
             Replication Sample size  Challenge of conducting replication 
                         -0.26640141                          -0.09447307 
  Experience and expertise of team R Self-assessed quality of replication 
                         -0.04395155                          -0.09113792 
> 
> ### "subjective 'yes' to 'Did it replicate?'"
> replic <- vector(mode = "logical", length = length(levels(MASTER$Replicate..R.)[MASTER$Replicate..R.]))
> for (i in 1:length(levels(MASTER$Replicate..R.)[MASTER$Replicate..R.])) {
+   if (levels(MASTER$Replicate..R.)[MASTER$Replicate..R.][i] == "yes") { replic[i] <- 1
+   } else { replic[i] <- 0 }
+ }
> 
> mat <- cbind(replic, rows)
> colnames(mat) <- c("Did it replicate?", "p-value", "Effect size", "Original sample size", "Surprising effect", "Experience and expertise of team O", "Power", 
+                    "Replication Sample size", "Challenge of conducting replication", "Experience and expertise of team R", "Self-assessed quality of replication", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -12) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
                             p-value                          Effect size 
                         -0.29370293                           0.26038784 
                Original sample size                    Surprising effect 
                         -0.18310529                          -0.21212333 
  Experience and expertise of team O                                Power 
                         -0.05881401                           0.33047065 
             Replication Sample size  Challenge of conducting replication 
                         -0.13580467                          -0.15609342 
  Experience and expertise of team R Self-assessed quality of replication 
                         -0.07996884                          -0.07601129 
> 
> #########################
> ##### TABLE 3 BRIAN #####
> #########################
> 
> mat <- cbind(MASTER$T_sign_R, es.dif, es.meta.all, replic, in.ci, MASTER$T_pval_USE..R)
> colnames(mat) <- c("rep.dir", "Effect Size Difference", "Meta-analytic estimate", "Original in CI", "Did it replicate?", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -6) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r # Create table with correlations
                          rep.dir Effect Size Difference Meta-analytic estimate
rep.dir                 1.0000000             -0.5903284              0.5731672
Effect Size Difference -0.5903284              1.0000000             -0.2064569
Meta-analytic estimate  0.5731672             -0.2064569              1.0000000
Original in CI          0.9136069             -0.5708311              0.5578860
Did it replicate?       0.5033612             -0.4835601              0.5250944
                       Original in CI Did it replicate?
rep.dir                     0.9136069         0.5033612
Effect Size Difference     -0.5708311        -0.4835601
Meta-analytic estimate      0.5578860         0.5250944
Original in CI              1.0000000         0.5865557
Did it replicate?           0.5865557         1.0000000
> 
> #########################
> ##### TABLE 4 BRIAN #####
> #########################
> 
> ### Create data frame
> dat <- data.frame(Original.effect.size = MASTER$T_r..O., Original.pvalue = MASTER$T_pval_USE..O., Original.sample.size = MASTER$T_N_O_for_tables, 
+                   Inst.1st.author = MASTER$Institution.prestige..1st.author..O., Inst.sen.author = MASTER$Institution.prestige..senior.author..O.,
+                   Cit.1st.author = MASTER$Citation.Count..1st.author..O., Cit.sen.author = MASTER$Citation.count..senior.author..O.,
+                   Cit.impact = MASTER$Citation.count..paper..O., concep.repl = MASTER$Internal.conceptual.replications..O.,
+                   dir.repl = MASTER$Internal.direct.replications..O., expe.req = as.numeric(fac.expe), oppo.expec.bias = as.numeric(fac.oppo.expe),
+                   oppo.dili = as.numeric(fac.oppo.dili), surp.res = as.numeric(levels(MASTER$Surprising.result..O.))[MASTER$Surprising.result..O.],
+                   exci.res = as.numeric(levels(MASTER$Exciting.result..O.))[MASTER$Exciting.result..O.], sub = MASTER$T_pval_USE..R.)
Warning messages:
1: In data.frame(Original.effect.size = MASTER$T_r..O., Original.pvalue = MASTER$T_pval_USE..O.,  :
  NAs introduced by coercion
2: In data.frame(Original.effect.size = MASTER$T_r..O., Original.pvalue = MASTER$T_pval_USE..O.,  :
  NAs introduced by coercion
> 
> sub <- subset(dat, is.na(dat$sub) == FALSE, select = -16) # Select only the replicated studies
> 
> ### Descriptives
> summary(sub) 
 Original.effect.size Original.pvalue     Original.sample.size Inst.1st.author
 Min.   :0.00464      Min.   :0.0000000   Min.   :     7.0     Min.   :1.280  
 1st Qu.:0.22444      1st Qu.:0.0004249   1st Qu.:    30.5     1st Qu.:2.585  
 Median :0.37328      Median :0.0068912   Median :    55.0     Median :3.450  
 Mean   :0.39424      Mean   :0.0282780   Mean   :  2408.8     Mean   :3.783  
 3rd Qu.:0.54451      3rd Qu.:0.0233323   3rd Qu.:    96.5     3rd Qu.:4.710  
 Max.   :0.85955      Max.   :0.9124486   Max.   :230025.0     Max.   :6.740  
 NA's   :1                                                                    
 Inst.sen.author Cit.1st.author    Cit.sen.author    Cit.impact    
 Min.   :1.280   Min.   :   54.0   Min.   :  240   Min.   :  6.00  
 1st Qu.:2.655   1st Qu.:  624.5   1st Qu.: 3734   1st Qu.: 35.50  
 Median :3.650   Median : 1539.0   Median : 8475   Median : 56.00  
 Mean   :3.957   Mean   : 3073.9   Mean   :13656   Mean   : 84.91  
 3rd Qu.:5.175   3rd Qu.: 3820.5   3rd Qu.:16130   3rd Qu.:123.00  
 Max.   :6.740   Max.   :44032.0   Max.   :86172   Max.   :341.00  
                                                                   
  concep.repl        dir.repl          expe.req     oppo.expec.bias
 Min.   :0.0000   Min.   :0.00000   Min.   :1.000   Min.   :1.000  
 1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:1.000   1st Qu.:1.000  
 Median :0.0000   Median :0.00000   Median :2.000   Median :2.000  
 Mean   :0.9091   Mean   :0.06061   Mean   :2.253   Mean   :1.737  
 3rd Qu.:2.0000   3rd Qu.:0.00000   3rd Qu.:3.000   3rd Qu.:2.000  
 Max.   :5.0000   Max.   :3.00000   Max.   :5.000   Max.   :4.000  
                                                                   
   oppo.dili        surp.res        exci.res    
 Min.   :1.000   Min.   :1.250   Min.   :1.330  
 1st Qu.:2.000   1st Qu.:2.365   1st Qu.:2.835  
 Median :2.000   Median :3.000   Median :3.200  
 Mean   :2.212   Mean   :2.959   Mean   :3.260  
 3rd Qu.:2.500   3rd Qu.:3.500   3rd Qu.:3.750  
 Max.   :5.000   Max.   :5.200   Max.   :4.750  
                                                
> 
> ### Variables in the columns
> rows <- cbind(MASTER$T_r..O., MASTER$T_pval_USE..O., MASTER$T_N..O., MASTER$Institution.prestige..1st.author..O., MASTER$Institution.prestige..senior.author..O.,
+               MASTER$Citation.Count..1st.author..O., MASTER$Citation.count..senior.author..O., MASTER$Citation.count..paper..O., MASTER$Internal.conceptual.replications..O.,
+               MASTER$Internal.direct.replications..O., as.numeric(fac.expe), as.numeric(fac.oppo.expe), as.numeric(fac.oppo.dili), 
+               as.numeric(levels(MASTER$Surprising.result..O.))[MASTER$Surprising.result..O.], as.numeric(levels(MASTER$Exciting.result..O.))[MASTER$Exciting.result..O.], MASTER$T_pval_USE..R.)
Warning messages:
1: In cbind(MASTER$T_r..O., MASTER$T_pval_USE..O., MASTER$T_N..O.,  :
  NAs introduced by coercion
2: In cbind(MASTER$T_r..O., MASTER$T_pval_USE..O., MASTER$T_N..O.,  :
  NAs introduced by coercion
> 
> colnames(rows) <- c("Original.effect.size", "Original.pvalue", "Original.sample.size", "Inst.1st.author", "Inst.sen.author", "Cit.1st.author", "Cit.sen.author",
+                     "Cit.impact", "concep.repl", "dir.repl", "expe.req", "oppo.expec.bias", "oppo.dili", "surp.res", "exci.res", "sub") 
> 
> ### "Replications p < 0.05 in original direction (all signicant replication studies are in the same direction as the original study)"
> mat <- cbind(MASTER$T_sign_R, rows)
> colnames(mat) <- c("rep.dir", "Original.effect.size", "Original.pvalue", "Original.sample.size", "Inst.1st.author", "Inst.sen.author", "Cit.1st.author", "Cit.sen.author",
+                    "Cit.impact", "concep.repl", "dir.repl", "expe.req", "oppo.expec.bias", "oppo.dili", "surp.res", "exci.res", "sub") 
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -17) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
Original.effect.size      Original.pvalue Original.sample.size 
         0.283420146         -0.309051752         -0.153861225 
     Inst.1st.author      Inst.sen.author       Cit.1st.author 
        -0.009983806         -0.040681187          0.117928736 
      Cit.sen.author           Cit.impact          concep.repl 
        -0.078373425         -0.012940010         -0.169016957 
            dir.repl             expe.req      oppo.expec.bias 
         0.060688019         -0.118055977         -0.209451482 
           oppo.dili             surp.res             exci.res 
        -0.199100956         -0.255377263         -0.119941995 
> 
> ### "Effect size difference" (Fisher z)
> mat <- cbind(es.dif, rows)
> colnames(mat) <- c("es.dif", "Original.effect.size", "Original.pvalue", "Original.sample.size", "Inst.1st.author", "Inst.sen.author", "Cit.1st.author", "Cit.sen.author",
+                    "Cit.impact", "concep.repl", "dir.repl", "expe.req", "oppo.expec.bias", "oppo.dili", "surp.res", "exci.res", "sub") 
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -17) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
Original.effect.size      Original.pvalue Original.sample.size 
          0.30973303          -0.07399956          -0.11428986 
     Inst.1st.author      Inst.sen.author       Cit.1st.author 
          0.03020498          -0.05989549          -0.11137191 
      Cit.sen.author           Cit.impact          concep.repl 
         -0.06135740          -0.04443714           0.03056003 
            dir.repl             expe.req      oppo.expec.bias 
          0.02145324           0.06099523           0.09785035 
           oppo.dili             surp.res             exci.res 
          0.08829772           0.06106272           0.04338253 
> 
> ### "Meta-analytic estimate" (Fisher z)
> mat <- cbind(es.meta.all, rows)
> colnames(mat) <- c("Meta-analytic estimate", "Original.effect.size", "Original.pvalue", "Original.sample.size", "Inst.1st.author", "Inst.sen.author", "Cit.1st.author", "Cit.sen.author",
+                    "Cit.impact", "concep.repl", "dir.repl", "expe.req", "oppo.expec.bias", "oppo.dili", "surp.res", "exci.res", "sub") 
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -17) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
Original.effect.size      Original.pvalue Original.sample.size 
          0.80049461          -0.47601983          -0.47907406 
     Inst.1st.author      Inst.sen.author       Cit.1st.author 
         -0.04060140           0.02252002           0.08617613 
      Cit.sen.author           Cit.impact          concep.repl 
         -0.15631710          -0.12595066          -0.20400198 
            dir.repl             expe.req      oppo.expec.bias 
          0.06402882          -0.01550209          -0.36054033 
           oppo.dili             surp.res             exci.res 
         -0.28579661          -0.23223488          -0.21537384 
> 
> ### "original effect size within replication 95% CI"
> mat <- cbind(in.ci, rows)
> colnames(mat) <- c("Original in CI", "Original.effect.size", "Original.pvalue", "Original.sample.size", "Inst.1st.author", "Inst.sen.author", "Cit.1st.author", "Cit.sen.author",
+                    "Cit.impact", "concep.repl", "dir.repl", "expe.req", "oppo.expec.bias", "oppo.dili", "surp.res", "exci.res", "sub") 
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -17) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
Original.effect.size      Original.pvalue Original.sample.size 
         0.136842608          0.019219467         -0.238824487 
     Inst.1st.author      Inst.sen.author       Cit.1st.author 
        -0.119573548         -0.082680464          0.001921967 
      Cit.sen.author           Cit.impact          concep.repl 
        -0.046896484         -0.061124109         -0.066808797 
            dir.repl             expe.req      oppo.expec.bias 
         0.112689354         -0.056937486         -0.119541071 
           oppo.dili             surp.res             exci.res 
        -0.023997970         -0.067739345         -0.021248236 
> 
> ### "subjective 'yes' to 'Did it replicate?'"
> mat <- cbind(replic, rows)
> colnames(mat) <- c("Did it replicate?", "Original.effect.size", "Original.pvalue", "Original.sample.size", "Inst.1st.author", "Inst.sen.author", "Cit.1st.author", "Cit.sen.author",
+                    "Cit.impact", "concep.repl", "dir.repl", "expe.req", "oppo.expec.bias", "oppo.dili", "surp.res", "exci.res", "sub") 
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -17) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
Original.effect.size      Original.pvalue Original.sample.size 
        0.2603878379        -0.2937029302        -0.1831052899 
     Inst.1st.author      Inst.sen.author       Cit.1st.author 
       -0.0369046479        -0.0456812754         0.1362589598 
      Cit.sen.author           Cit.impact          concep.repl 
       -0.0887700692         0.0003653372        -0.1738409847 
            dir.repl             expe.req      oppo.expec.bias 
        0.0514024086        -0.0442233719        -0.1839747429 
           oppo.dili             surp.res             exci.res 
       -0.1479575932        -0.2121233344        -0.1093483642 
> 
> #########################
> ##### TABLE 5 BRIAN #####
> #########################
> 
> ### Create data frame
> dat <- data.frame(Inst.1st.author = MASTER$Institution.prestige..1st.author..R., Inst.senior.author = MASTER$Institution.prestige..senior.author..R., 
+                   Cit.1st.author = MASTER$Citation.count..1st.author..R., Cit.senior.author = MASTER$Citation.count..senior.author..R., position = as.numeric(fac.posi),
+                   degree = as.numeric(fac.degr), total.publ = MASTER$Total.publications..R., domain = as.numeric(fac.doma), method = as.numeric(fac.meth),
+                   imple = as.numeric(fac.impl), data.coll = as.numeric(fac.data), repl.sim = as.numeric(fac.repl), diff.impl = as.numeric(fac.diff),
+                   repl.N = MASTER$T_N..R, power.R = MASTER$Power..R., sur.out = as.numeric(fac.sur.out), sub = MASTER$T_pval_USE..R.)
> 
> sub <- subset(dat, is.na(dat$sub) == FALSE, select = -17) # Select only the replicated studies
> 
> ### Descriptives
> summary(sub) 
 Inst.1st.author Inst.senior.author Cit.1st.author   Cit.senior.author
 Min.   :1.310   Min.   :1.310      Min.   :   0.0   Min.   :    0.0  
 1st Qu.:1.945   1st Qu.:1.945      1st Qu.:   2.5   1st Qu.:   33.5  
 Median :2.530   Median :2.610      Median :  91.0   Median :  378.0  
 Mean   :3.031   Mean   :3.019      Mean   : 570.2   Mean   : 1448.4  
 3rd Qu.:3.890   3rd Qu.:3.740      3rd Qu.: 474.0   3rd Qu.: 1317.5  
 Max.   :6.740   Max.   :6.740      Max.   :6853.0   Max.   :15770.0  
                                                                      
    position         degree        total.publ         domain     
 Min.   :1.000   Min.   :1.000   Min.   :  0.00   Min.   :1.000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:  7.00   1st Qu.:2.000  
 Median :2.000   Median :1.000   Median : 18.50   Median :3.000  
 Mean   :2.898   Mean   :1.232   Mean   : 45.26   Mean   :3.172  
 3rd Qu.:4.750   3rd Qu.:1.000   3rd Qu.: 45.50   3rd Qu.:4.000  
 Max.   :7.000   Max.   :4.000   Max.   :400.00   Max.   :5.000  
 NA's   :1                       NA's   :1                       
     method          imple         data.coll        repl.sim    
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :3.000  
 1st Qu.:3.000   1st Qu.:4.000   1st Qu.:3.000   1st Qu.:5.000  
 Median :3.000   Median :4.000   Median :4.000   Median :6.000  
 Mean   :3.439   Mean   :3.848   Mean   :3.596   Mean   :5.717  
 3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:4.000   3rd Qu.:6.000  
 Max.   :5.000   Max.   :6.000   Max.   :6.000   Max.   :7.000  
 NA's   :1                                                      
   diff.impl         repl.N          power.R      sur.out     
 Min.   :1.000   Min.   :     5   0.99   :34   Min.   :1.000  
 1st Qu.:3.000   1st Qu.:    32   0.95   :15   1st Qu.:2.000  
 Median :4.000   Median :    71   0.9    : 8   Median :2.000  
 Mean   :4.061   Mean   : 12516   0.8    : 6   Mean   :2.505  
 3rd Qu.:5.000   3rd Qu.:   146   0.82   : 3   3rd Qu.:3.000  
 Max.   :6.000   Max.   :768703   0.86   : 3   Max.   :5.000  
                                  (Other):30                  
> 
> ### Variables in the columns
> rows <- cbind(MASTER$Institution.prestige..1st.author..R., MASTER$Institution.prestige..senior.author..R., MASTER$Citation.count..1st.author..R., MASTER$Citation.count..senior.author..R., 
+               as.numeric(fac.posi), as.numeric(fac.degr), MASTER$Total.publications..R., as.numeric(fac.doma), as.numeric(fac.meth), as.numeric(fac.impl), as.numeric(fac.data), 
+               as.numeric(fac.repl), as.numeric(fac.diff), MASTER$T_N..R, MASTER$Power..R., as.numeric(fac.sur.out), MASTER$T_pval_USE..R.)
> colnames(rows) <- c("Inst.1st.author", "Inst.senior.author", "Cit.1st.author", "Cit.senior.author", "position", "degree", "total.publ", "domain", "method", "imple", "data.coll", 
+                     "repl.sim", "diff.impl", "repl.N", "power.R", "sur.out", "sub")
> 
> ### "Replications p < 0.05 in original direction (all signicant replication studies are in the same direction as the original study)"
> mat <- cbind(MASTER$T_sign_R, rows)
> colnames(mat) <- c("rep.dir", "Inst.1st.author", "Inst.senior.author", "Cit.1st.author", "Cit.senior.author", "position", "degree", "total.publ", "domain", "method", "imple", "data.coll", 
+                    "repl.sim", "diff.impl", "repl.N", "power.R", "sur.out", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -18) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
   Inst.1st.author Inst.senior.author     Cit.1st.author  Cit.senior.author 
       -0.21785825        -0.22304414         0.08209427        -0.06884254 
          position             degree         total.publ             domain 
       -0.12950772        -0.03263622        -0.02447852         0.05437981 
            method              imple          data.coll           repl.sim 
       -0.04483431        -0.06944968        -0.06395416         0.01823290 
         diff.impl             repl.N            power.R            sur.out 
       -0.07167093        -0.12053403         0.39792293        -0.43032527 
> 
> ### "Effect size difference" (Fisher z)
> mat <- cbind(es.dif, rows)
> colnames(mat) <- c("es.dif", "Inst.1st.author", "Inst.senior.author", "Cit.1st.author", "Cit.senior.author", "position", "degree", "total.publ", "domain", "method", "imple", "data.coll", 
+                    "repl.sim", "diff.impl", "repl.N", "power.R", "sur.out", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -18) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
   Inst.1st.author Inst.senior.author     Cit.1st.author  Cit.senior.author 
      0.1198284477       0.1001950800      -0.0867242292       0.1072070152 
          position             degree         total.publ             domain 
      0.0735815540      -0.0327003710       0.0798266083       0.0350320376 
            method              imple          data.coll           repl.sim 
      0.1475730240       0.0830741599       0.0534615554      -0.0786649883 
         diff.impl             repl.N            power.R            sur.out 
     -0.0004583268      -0.1609450877      -0.0930031687       0.3324981928 
> 
> ### "Meta-analytic estimate" (Fisher z)
> mat <- cbind(es.meta.all, rows)
> colnames(mat) <- c("es.meta.all", "Inst.1st.author", "Inst.senior.author", "Cit.1st.author", "Cit.senior.author", "position", "degree", "total.publ", "domain", "method", "imple", "data.coll", 
+                    "repl.sim", "diff.impl", "repl.N", "power.R", "sur.out", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -18) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
   Inst.1st.author Inst.senior.author     Cit.1st.author  Cit.senior.author 
       -0.40631282        -0.39371988        -0.01773721        -0.02202619 
          position             degree         total.publ             domain 
       -0.23318751        -0.05433130         0.07030933         0.15028058 
            method              imple          data.coll           repl.sim 
        0.25611740        -0.09659044         0.22938354        -0.05190658 
         diff.impl             repl.N            power.R            sur.out 
       -0.02775467        -0.69376332         0.19962181        -0.35738936 
> 
> ### "original effect size within replication 95% CI"
> mat <- cbind(in.ci, rows)
> colnames(mat) <- c("Original in CI", "Inst.1st.author", "Inst.senior.author", "Cit.1st.author", "Cit.senior.author", "position", "degree", "total.publ", "domain", "method", "imple", "data.coll", 
+                    "repl.sim", "diff.impl", "repl.N", "power.R", "sur.out", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -18) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
   Inst.1st.author Inst.senior.author     Cit.1st.author  Cit.senior.author 
      -0.252695948       -0.291169256        0.232727706        0.051563781 
          position             degree         total.publ             domain 
      -0.195459321       -0.158529341        0.063072085        0.175819620 
            method              imple          data.coll           repl.sim 
       0.033814508        0.043629687        0.030504895       -0.053324006 
         diff.impl             repl.N            power.R            sur.out 
      -0.107512072       -0.291418135        0.008251902       -0.371353149 
> 
> ### "subjective 'yes' to 'Did it replicate?'"
> mat <- cbind(replic, rows)
> colnames(mat) <- c("Did it replicate?", "Inst.1st.author", "Inst.senior.author", "Cit.1st.author", "Cit.senior.author", "position", "degree", "total.publ", "domain", "method", "imple", "data.coll", 
+                    "repl.sim", "diff.impl", "repl.N", "power.R", "sur.out", "sub")
> 
> sub <- subset(mat, is.na(mat[ , "sub"]) == FALSE, select = -18) # Select only the replicated studies
> 
> rcorr(sub, type = "spearman")$r[-1,1] # Create table with correlations and select the appropriate rows
   Inst.1st.author Inst.senior.author     Cit.1st.author  Cit.senior.author 
      -0.216740817       -0.222596377        0.030099668       -0.098383777 
          position             degree         total.publ             domain 
      -0.130689919        0.005277241       -0.013772474        0.117310889 
            method              imple          data.coll           repl.sim 
      -0.062811442       -0.025792846       -0.116134651        0.039867457 
         diff.impl             repl.N            power.R            sur.out 
      -0.087310091       -0.182679325        0.376017898       -0.490386486 
> 
