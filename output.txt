> # wd <- "SET WORKING DIRECTORY HERE"
> wd <- "C:/Users/chjh/Dropbox/projects/2014rpp/master"
> 
> ######################################################################################
> # Master script Tilburg University Analyses                                          #
> # Responsible for this file: CHJ Hartgerink (c.h.j.hartgerink@tilburguniversity.edu) #
> ######################################################################################
> 
> setwd(wd)
> # Read in Tilburg data
> MASTER <- read.csv('tilburg data.csv')[1:167,]
> # source functions
> source('functions.r')
> library(Hmisc)
> 
> # ALL ANALYSES INCLUDE PAIRWISE SELECTION.
> 
> #-----------------------------
> 
> # Writing out data for table
> # https://docs.google.com/spreadsheets/d/16aqIekNerZcflSJwM7dOiXnN24-KvZqaa3eTg4js41U/edit#gid=0
> # Columns B-E
> ### Recode "Publishing journal and subdiscipline"
> jour <- numeric()
> 
> for(i in 1:nrow(MASTER)) {
+   if(as.character(MASTER$Journal..O.[i]) == "JEPLMC") {
+     jour[i] <- 1
+   } else if(as.character(MASTER$Journal..O.[i]) == "JPSP") {
+     jour[i] <- 2
+   } else if(as.character(MASTER$Journal..O.[i]) == "PS") {
+     if(as.character(MASTER$Discipline..O.[i]) == "Cognitive") {
+       jour[i] <- 3
+     } else if(as.character(MASTER$Discipline..O.[i]) == "Social") {
+       jour[i] <- 4
+     } else { jour[i] <- 5 }
+   }
+   else { jour[i] <- NA }
+ }
> 
> # Overall 
> sel <- MASTER[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.),]
> 
> # Column B
> # Relations tested
> reltest <- dim(sel)[1]
> # Relations both significant
> relsig <- sum((sel$T_pval_USE..O.) <= .05 & (sel$T_pval_USE..R. <= .05), na.rm = TRUE)
> writeClipboard(
+   paste0(
+     round(relsig, 0),
+     " / ",
+     round(reltest, 0)
+   )
+ )
> cat("\014")
> readline("Paste into column B, then press ENTER key")
Paste into column B, then press ENTER key
[1] ""
> # Column C
> # Percent
> writeClipboard(as.character(round((relsig / reltest), 2)))
> cat("\014")
> readline("Paste into column C, then press ENTER key")
Paste into column C, then press ENTER key
[1] ""
> # Column D
> # Mean
> temp1 <- mean(sel$T_r..O., na.rm = TRUE)
> # SD
> temp2 <- sd(sel$T_r..O., na.rm = TRUE)
> 
> writeClipboard(paste0(round(temp1, 2), " (", round(temp2, 2), ")"))
> cat("\014")
> readline("Paste into column D, then press ENTER key")
Paste into column D, then press ENTER key
[1] ""
> # Column E
> # Mean
> temp1 <- mean(sel$T_r..R., na.rm = TRUE)
> # SD
> temp2 <- sd(sel$T_r..R., na.rm = TRUE)
> 
> writeClipboard(paste0(round(temp1, 2), " (", round(temp2, 2), ")"))
> cat("\014")
> readline("Paste into column E, then press ENTER key")
Paste into column E, then press ENTER key
[1] ""
> # Per journal 
> for(journal in c(2,1,4,3,5)){
+ 
+   sel <- MASTER[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.) & jour == journal,]
+   
+   # Column B
+   # Relations tested
+   reltest <- dim(sel)[1]
+   # Relations both significant
+   relsig <- sum((sel$T_pval_USE..O.) <= .05 & (sel$T_pval_USE..R. <= .05), na.rm = TRUE)
+   writeClipboard(
+     paste0(
+       round(relsig, 0),
+       " / ",
+       round(reltest, 0)
+     )
+   )
+   cat("\014")
+   readline("Paste into column B, then press ENTER key")
+   
+   # Column C
+   # Percent
+   writeClipboard(as.character(round((relsig / reltest) * 100, 0)))
+   cat("\014")
+   readline("Paste into column C, then press ENTER key")
+   
+   # Column D
+   # Mean
+   temp1 <- mean(sel$T_r..O., na.rm = TRUE)
+   # SD
+   temp2 <- sd(sel$T_r..O., na.rm = TRUE)
+   
+   writeClipboard(paste0(round(temp1, 2), " (", round(temp2, 2), ")"))
+   cat("\014")
+   readline("Paste into column D, then press ENTER key")
+   
+   # Column E
+   # Mean
+   temp1 <- mean(sel$T_r..R., na.rm = TRUE)
+   # SD
+   temp2 <- sd(sel$T_r..R., na.rm = TRUE)
+   
+   writeClipboard(paste0(round(temp1, 2), " (", round(temp2, 2), ")"))
+   cat("\014")
+   readline("Paste into column E, then press ENTER key")
+ }
Paste into column B, then press ENTER key
Paste into column C, then press ENTER key#---------------
Paste into column D, then press ENTER key
Paste into column E, then press ENTER key# P-value analyses
Paste into column B, then press ENTER key# Written by CHJ Hartgerink
Paste into column C, then press ENTER key
Paste into column D, then press ENTER key#  McNemar test
Paste into column E, then press ENTER keytab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R)],
Paste into column B, then press ENTER key             MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R)])
Paste into column C, then press ENTER key
Paste into column D, then press ENTER keymcnemarchi <- (tab[1,2]-tab[2,1])^2/(tab[1,2]+tab[2,1])
Paste into column E, then press ENTER keymcnemarp <- pchisq(q = mcnemarchi, df = 1, lower.tail = FALSE)
Paste into column B, then press ENTER key
Paste into column C, then press ENTER key# Dependent t-test p-values
Paste into column D, then press ENTER keyt.test(x = MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)],
Paste into column E, then press ENTER key       y = MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)],
Paste into column B, then press ENTER key       paired = TRUE)
Paste into column C, then press ENTER key
Paste into column D, then press ENTER key# Wilcoxon signed-rank test p-values
Paste into column E, then press ENTER keywilcox.test(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)],
>             MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)],
Error: unexpected ',' in "            MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)],"
>             alternative="two.sided")
Error: unexpected ')' in "            alternative="two.sided")"
> 
> sd(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])
[1] 0.1028656
> summary(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
0.0000000 0.0004249 0.0068910 0.0282800 0.0233300 0.9124000 
> sd(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])
[1] 0.3172161
> summary(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.000000 0.007754 0.198200 0.302300 0.536500 0.974800 
> 
> # Percent significant and nonsignificant for original studies
> # Significant
> sum(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.)] <= .05) / length(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.)])
[1] 0.9230769
> # Nonsignificant
> sum(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.)] > .05) / length(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.)])
[1] 0.07692308
> 
> # Percent significant and nonsignificant for replication studies
> # Significant
> sum(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..R.)] <= .05) / length(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..R.)])
[1] 0.3535354
> # Nonsignificant
> sum(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..R.)] > .05) / length(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..R.)])
[1] 0.6464646
> 
> # Deviation from uniformity in nonsignificant replication studies
> FisherMethod(x = MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..R.)],
+              id = 1,
+              alpha = .05)
      Fish      PFish CountNSig CountSig PercentNonSig
1 155.8262 0.04765856        64       35     0.6464646
> 
> # Distribution p-values
> pdf('pvalue distributions.pdf', onefile = TRUE, width = 11, height = 9.2)
> #PDF
> plot(density(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]),
+      lty=1,
+      frame.plot=F, 
+      main="P-value distributions (PDF)",
+      xlim=c(0,1),
+      xaxs="i",
+      yaxs="i",
+      xlab="P-value",
+      ylab = "Density",
+      cex.axis=.6,
+      cex.lab=.7,
+      col = "grey")
> lines(density(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]))
> legend(x=.4,y=4,legend=c(paste('Original p-values, k = ',
+                                length(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])),
+                          paste('Replication p-values, k = ',
+                                length(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]))),
+        cex=1,
+        lty=c(1,1), bty = 'n',
+        col = c("grey","black"),box.lwd=0)
> 
> # CDF
> plot(ecdf(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]),
+      lty=1,
+      frame.plot=F, 
+      main="P-value distributions (CDF)",
+      xlim=c(0,1),
+      xaxs="i",
+      yaxs="i",
+      xlab="P-value",
+      ylab = "Density",
+      cex.axis=.6,
+      cex.lab=.7,
+      col = "grey")
> lines(ecdf(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]))
> legend(x=.5,y=.3,legend=c(paste('Original p-values, k = ',
+                                 length(MASTER$T_pval_USE..O.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)])),
+                           paste('Replication p-values, k = ',
+                                 length(MASTER$T_pval_USE..R.[!is.na(MASTER$T_pval_USE..O.) & !is.na(MASTER$T_pval_USE..R.)]))),
+        cex=1,
+        lty=c(1,1), bty = 'n',
+        col = c("grey","black"),box.lwd=0)
> dev.off()
null device 
          1 
> 
> # Significance per journal
> 
> # Table significance, per journal
> 
> # JEPLMC
> JEPLMCtab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 1],
+              MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 1])
> # JPSP
> JPSPtab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 2],
+       MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 2])
> # PS Cognitive
> PScogtab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 3],
+       MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 3])
> # PS Social
> PSsoctab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 4],
+       MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 4])
> # PS other
> PSothtab <- table(MASTER$T_sign_O[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 5],
+       MASTER$T_sign_R[!is.na(MASTER$T_sign_O) & !is.na(MASTER$T_sign_R) & jour == 5])
> 
> labels <- c("Original", "Replication", "Replication | sig original")
> 
> JPSP <- c(sum(JPSPtab[2,]),
+            sum(JPSPtab[,2]),
+            sum(JPSPtab[2,2]))
> JPSPperc <- c(sum(JPSPtab[2,])/sum(JPSPtab),
+                sum(JPSPtab[,2])/sum(JPSPtab),
+                sum(JPSPtab[2,2])/sum(JPSPtab[2,]))
> 
> JEPLMC <- c(sum(JEPLMCtab[2,]),
+              sum(JEPLMCtab[,2]),
+              sum(JEPLMCtab[2,2]))
> JEPLMCperc <- c(sum(JEPLMCtab[2,])/sum(JEPLMCtab),
+                  sum(JEPLMCtab[,2])/sum(JEPLMCtab),
+                  sum(JEPLMCtab[2,2])/sum(JEPLMCtab[2,]))
> 
> PScog <- c(sum(PScogtab[1,]), # Only significant effects in original
+             sum(PScogtab[,2]),
+             sum(PScogtab[1,2]))
> PScogperc <- c(sum(PScogtab[1,])/sum(PScogtab),
+                 sum(PScogtab[,2])/sum(PScogtab),
+                 sum(PScogtab[1,2])/sum(PScogtab[1,]))
> 
> PSsoc <- c(sum(PSsoctab[2,]),
+            sum(PSsoctab[,2]),
+            sum(PSsoctab[2,2]))
> PSsocperc <- c(sum(PSsoctab[2,])/sum(PSsoctab),
+                sum(PSsoctab[,2])/sum(PSsoctab),
+                sum(PSsoctab[2,2])/sum(PSsoctab[2,]))
> 
> PSoth <- c(sum(PSothtab[1,]), # Only significant effects in original
+            sum(PSothtab[,2]),
+            sum(PSothtab[1,2]))
> PSothperc <- c(sum(PSothtab[1,])/sum(PSothtab),
+                sum(PSothtab[,2])/sum(PSothtab),
+                sum(PSothtab[1,2])/sum(PSothtab[1,]))
> 
> cbind(labels, JPSP, JPSPperc, JEPLMC, JEPLMCperc, PScog, PScogperc, PSsoc, PSsocperc, PSoth, PSothperc)
     labels                       JPSP JPSPperc            JEPLMC
[1,] "Original"                   "31" "0.96875"           "27"  
[2,] "Replication"                "7"  "0.21875"           "13"  
[3,] "Replication | sig original" "7"  "0.225806451612903" "13"  
     JEPLMCperc          PScog PScogperc PSsoc PSsocperc           PSoth
[1,] "0.964285714285714" "10"  "1"       "23"  "0.958333333333333" "6"  
[2,] "0.464285714285714" "7"   "0.7"     "8"   "0.333333333333333" "1"  
[3,] "0.481481481481481" "7"   "0.7"     "7"   "0.304347826086957" "1"  
     PSothperc          
[1,] "1"                
[2,] "0.166666666666667"
[3,] "0.166666666666667"
> #---------------
> 
> # Effect size distributions
> # Written by CHJ Hartgerink
> 
> # Original effects recomputed
> length(MASTER$T_r..O.[!is.na(MASTER$T_r..O.)])
[1] 142
> # Replication effects recopmuted
> length(MASTER$T_r..R.[!is.na(MASTER$T_r..R.)])
[1] 97
> 
> # Number of pairs
> sum(!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.))
[1] 97
> 
> # Spearman correlation original and replicated effect sizes
> cor(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+     MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+     method = "spearman")
[1] 0.510666
> 
> # Dependent t-test effects (r values)
> t.test(x = MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+        y = MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+        paired = TRUE)

        Paired t-test

data:  MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)] and MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]
t = 9.3317, df = 96, p-value = 4.059e-15
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.1561618 0.2405474
sample estimates:
mean of the differences 
              0.1983546 

> 
> 
> # Wilcox test effects (r values)
> wilcox.test(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+             MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)],
+             alternative="two.sided")

        Wilcoxon rank sum test with continuity correction

data:  MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)] and MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]
W = 7132, p-value = 5.406e-10
alternative hypothesis: true location shift is not equal to 0

> 
> summary(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.00464 0.22550 0.37480 0.39620 0.55120 0.85960 
> sd(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
[1] 0.1928085
> summary(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.45020  0.02384  0.12050  0.19790  0.32270  0.92290 
> sd(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
[1] 0.254985
> 
> mean(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])-mean(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])
[1] 0.1983546
> 
> # Binomial test to see if replicated effect is larger than original
> temp <- MASTER$T_O_larger
> prop <- sum(temp[!is.na(temp)])/length(temp[!is.na(temp)])
> binom.test(x = sum(temp[!is.na(temp)]), n = length(temp[!is.na(temp)]),
+            p = .5,alternative = "two.sided")

        Exact binomial test

data:  sum(temp[!is.na(temp)]) and length(temp[!is.na(temp)])
number of successes = 82, number of trials = 99, p-value = 2.181e-11
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.7393611 0.8966667
sample estimates:
probability of success 
             0.8282828 

> 
> pdf('effect plots.pdf', width = 11.2, height = 9, onefile = TRUE)
> # Effect replication and original
> plot(y = MASTER$T_r..R., x = MASTER$T_r..O., xlab = "Effect size r (original)",
+      ylab = "Effect size r (replication)", col = "white", xlim = c(-.3, 1), ylim = c(-.3, 1),
+      frame.plot=F,
+      xaxs="i",
+      yaxs="i"
+ )
> points(y = MASTER$T_r..R.[MASTER$T_pval_USE..O. > .05 & MASTER$T_pval_USE..R. > .05],
+        x = MASTER$T_r..O.[MASTER$T_pval_USE..O. > .05 & MASTER$T_pval_USE..R. > .05], 
+        pch = 4, col = 1)
> points(y = MASTER$T_r..R.[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. > .05],
+        x = MASTER$T_r..O.[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. > .05],
+        pch = 21, col = 10)
> points(y = MASTER$T_r..R.[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. <= .05],
+        x = MASTER$T_r..O.[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. <= .05], 
+        pch = 10, col = 3)
> lines(x = seq(-.5, 2, .0001), y = seq(-.5, 2, .0001), type = 'l')
> 
> # Regression line
> x1 <- MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]
> y1 <- MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]
> 
> # Linear
> xx <- lm(y1 ~ x1)
> lines(loess.smooth(x = x1, y = y1), lty = 2)
> curve(expr = (xx$coefficients[1] + xx$coefficients[2] * x), from = min(x1),
+       to = max(x1), add = TRUE, col = "blue")
> 
> legend(x=-.2,y=.8,legend=c('Both nonsignificant',
+                           'Original significant',
+                           'Both significant',
+                           'Repl. predicted by orig.',
+                           'Loess curve'),
+        cex=1,
+        lty=c(0, 0, 0, 1, 2), bty = 'n', pch = c(4, 21, 10, NA, NA),
+        col = c("black", 10, 3, "blue", "black"), box.lwd=0)
> 
> # R2
> xr2 <- x1 * x1
> yr2 <- y1 * y1
> 
> plot(y = yr2, x = xr2, xlab = "Effect size r (original)",
+      ylab = "Effect size r (replication)", col = "white", ylim = c(0,1), xlim = c(0,1))
> points(y = yr2[MASTER$T_pval_USE..O. > .05 & MASTER$T_pval_USE..R. > .05],
+        x = xr2[MASTER$T_pval_USE..O. > .05 & MASTER$T_pval_USE..R. > .05], pch = 4)
> points(y = yr2[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. > .05],
+        x = xr2[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. > .05], pch = 21)
> points(y = yr2[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. <= .05],
+        x = xr2[MASTER$T_pval_USE..O. <= .05 & MASTER$T_pval_USE..R. <= .05], pch = 10)
> lines(x = seq(0, 1, .001), y = seq(0, 1, .001), type = 'l')
> 
> r2 <- lm(yr2 ~ xr2)
> lines(loess.smooth(x = xr2, y = yr2), lty = 2)
> curve(expr = (r2$coefficients[1] + r2$coefficients[2] * x), from = 0, to = 1, add = TRUE, col = "blue")
> 
> legend(x=0,y=.8,legend=c('Both nonsignificant',
+                           'Original significant',
+                           'Both significant',
+                           'Repl. predicted by orig.',
+                           'Loess curve'),
+        cex=1,
+        lty=c(0, 0, 0, 1, 2), bty = 'n', pch = c(4, 21, 10, NA, NA),
+        col = c("black", "black", "black", "blue", "black"),box.lwd=0)
> # Histogram effects 
> par(mfrow=c(1,2))
> hist1 <- hist(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)], breaks=15)
> hist2 <- hist(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)], breaks=20)
> plot(hist1, xlim = c(-.6, 1.2), ylim = c(0, 50), xlab = "Effect size r",
+      main = "Effect histograms")
> plot(hist2, add = TRUE, col = addTrans("grey",150))
> legend(x = .45, y = 25,
+        leg=c(paste("Original, k = ",
+                    length(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])),
+              paste("Replication, k = ",
+                    length(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]))),
+        fill=c("white", "grey"),
+        bty = 'n')
> 
> # CDF effects
> plot(ecdf(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]),
+      lty=1,
+      frame.plot=F, 
+      main="Cumulative effect distributions",
+      xlim=c(0,1),
+      xaxs="i",
+      yaxs="i",
+      xlab="Correlation coefficient",
+      ylab = "Cumulative density",
+      cex.axis=.6,
+      cex.lab=.7,
+      col = "grey")
> lines(ecdf(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]))
> legend(x=.45,y=.5,legend=c(paste("Original, k = ",
+                                 length(MASTER$T_r..O.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)])),
+                           paste("Replication, k = ",
+                                 length(MASTER$T_r..R.[!is.na(MASTER$T_r..O.) & !is.na(MASTER$T_r..R.)]))),
+        cex=1,
+        lty=c(1,1), bty = 'n',
+        col = c("grey","black"),box.lwd=0)
> 
> dev.off()
null device 
          1 
> 
> #----------------------
> 
> # Meta-analysis
> # Written by RCM van Aert
> 
> ##########################################
> ### Create correct order of categories ###
> ##########################################
> 
> ### Create the right order of the variable "Perceived expertise required"
> fac.expe <- factor(MASTER$Methodology.expertise.required..O., levels = c("No expertise required", "Slight expertise required",
+                                                                          "Moderate expertise required", "Strong expertise required", 
+                                                                          "Extreme expertise required"))
> 
> ### Create the right order of the variable "Opportunity for expectancy biases"
> fac.oppo.expe <- factor(MASTER$Opportunity.for.expectancy.bias..O., levels = c("No opportunity for researcher expectations to influence results",
+                                                                                "Slight opportunity for researcher expectations to influence results",
+                                                                                "Moderate opportunity for researcher expectations to influence results",
+                                                                                "Strong opportunity for researcher expectations to influence results",
+                                                                                "Extreme opportunity for researcher expectations to influence results"))
> 
> ### Create the right order of the variable "Opportunity for lack of diligence"
> fac.oppo.dili <- factor(MASTER$Opportunity.for.lack.of.diligence..O., levels = c("No opportunity for lack of diligence to affect the results",
+                                                                                  "Slight opportunity for lack of diligence to affect the results",
+                                                                                  "Moderate opportunity for lack of diligence to affect the results",
+                                                                                  "Strong opportunity for lack of diligence to affect the results",
+                                                                                  "Extreme opportunity for lack of diligence to affect the results"))
> 
> ### Create the right order of the variable "Current position"
> fac.posi <- factor(MASTER$Current.position..R., levels = c("Professor (or equivalent)", "Associate Professor (or equivalent)", "Assistant Professor (or equivalent)",
+                                                            "Post-doc or Research Scientist", "PhD student", "Master's student", "Undergraduate student", 
+                                                            "Faculty (non-tenure track) full-time lecturer", "Private sector researcher"))
> 
> ### Change "Faculty (non-tenure track) full-time lecturer" into "Assistant Professor (or equivalent)"
> tmp <- numeric()
> for(i in 1:length(fac.posi)) {
+   if(is.na(fac.posi[i] == TRUE)) { tmp[i] <- NA }
+   else if(as.character(fac.posi[i]) == "Faculty (non-tenure track) full-time lecturer") { tmp[i] <- "Assistant Professor (or equivalent)"
+   } else if (as.character(fac.posi[i]) == "Private sector researcher") { tmp[i] <- "Post-doc or Research Scientist"
+   } else { tmp[i] <- as.character(fac.posi[i]) }
+ }
> fac.posi <- as.factor(tmp)
> 
> ### Create the right order of the variable "Degree"
> fac.degr <- factor(MASTER$Degree..R., levels = c("PhD or equivalent", "Master's degree or equivalent", "Some graduate school", "Bachelor's degree or equivalent", "some college/university",
+                                                  "high school/equivalent"))
> 
> ### Create the right order of the variable "Domain expertise"
> fac.doma <- factor(MASTER$Domain.expertise..R., levels = c("No Expertise", "Slight Expertise", "Some Expertise", "Moderate Expertise", "High Expertise"))
> 
> ### Create the right order of the variable "Method expertise"
> fac.meth <- factor(MASTER$Method.expertise..R., levels = c("No Expertise", "Slight Expertise", "Some Expertise", "Moderate Expertise", "High Expertise"))
> 
> ### Create the right order of the variable "Implementation quality"
> fac.impl <- factor(MASTER$Implementation.quality..R., levels = c("was of much higher quality than the original study", "was of moderately higher quality than the original study",
+                                                                  "was of slightly higher quality than the original study", "was about the same quality as the original study", 
+                                                                  "was of slightly lower quality than the original study", "was of moderately lower quality than the original study"))
> 
> ### Create the right order of the variable "Data collection quality"
> fac.data <- factor(MASTER$Data.collection.quality..R., levels = c("was much better than the average study", "was better than the average study", "was slightly better than the average study",
+                                                                   "was about the same as the average study", "was slightly worse than the average study", "was worse than the average study",
+                                                                   "was much worse than the average study"))
> 
> ### Create the right order of the variable "Replication similarity"
> fac.repl <- factor(MASTER$Replication.similarity..R., levels = c("Not at all similar", "Slightly similar", "Somewhat similar", "Moderately similar", "Very similar", "Extremely similar",
+                                                                  "Virtually identical"))
> 
> ### Create the right order of the variable "Difficulty of implementation"
> fac.diff <- factor(MASTER$Difficulty.of.implimentation..R., levels = c("Extremely challenging", "Very challenging", "Moderately challenging", "Somewhat challenging", "Slightly challenging",
+                                                                        "Not at all challenging"))
> 
> ###########################################
> ### Prepare variables for meta-analyses ###
> ###########################################
> 
> ### Function for standardizing variables
> stand <- function(x) {
+   res <- (x-mean(x, na.rm = TRUE))/sd(x, na.rm = TRUE)
+   return(res)
+ }
> 
> # a. PUBLISHING JOURNAL AND SUBDISCIPLINE
> 
> ### Create dummy variables for "Publishing journal and subdiscipline"
> ### JPSP is reference category because it has the most cases
> d.JEP <- ifelse(jour == 1, 1, 0)
> d.PSCog <- ifelse(jour == 3, 1, 0)
> d.PSSoc <- ifelse(jour == 4, 1, 0)
> d.PSOth <- ifelse(jour == 5, 1, 0)
> 
> # b. IMPORTANCE OF THE EFFECT
> 
> ### Standardizing "Citation count, paper (O)"
> st.impa <- stand(MASTER$Citation.count..paper..O.)
> 
> ### Standardizing "Exciting/important effect"
> st.exci <- stand(as.numeric(levels(MASTER$Exciting.result..O.))[MASTER$Exciting.result..O.])
Warning message:
In stand(as.numeric(levels(MASTER$Exciting.result..O.))[MASTER$Exciting.result..O.]) :
  NAs introduced by coercion
> 
> ### Creating scale
> sc.impo <- (st.impa + st.exci)/2
> 
> # c. SURPRISING EFFECT
> 
> ### Standardizing "Surprising effect" and creating scale
> sc.surp <- stand(as.numeric(levels(MASTER$Surprising.result..O.))[MASTER$Surprising.result..O.])
Warning message:
In stand(as.numeric(levels(MASTER$Surprising.result..O.))[MASTER$Surprising.result..O.]) :
  NAs introduced by coercion
> 
> # d. EXPERIENCE AND EXPERTISE OF ORIGINAL TEAM
> 
> ### Taking the average and then standardizing "Institution prestige of 1st author and senior author" 
> ave.pres <- (MASTER$Institution.prestige..1st.author..O.+MASTER$Institution.prestige..senior.author..O.)/2
> st.pres <- stand(ave.pres)
> 
> ### Standardizing "Citation Count, 1st author (O)"
> st.impa.1st <- stand(MASTER$Citation.Count..1st.author..O.)
> 
> ### Standardizing "Citation count, senior author (O)"
> st.impa.sen <- stand(MASTER$Citation.count..senior.author..O.)
> 
> ### Creating scale
> sc.expe1 <- (st.pres + st.impa.1st + st.impa.sen)/3
> 
> # e. CHALLENGE OF CONDUCTING REPLICATION
> 
> ### Standardizing "Perceived expertise required"
> st.expe <- stand(as.numeric(fac.expe))
> 
> ### Standardizing "Perceived opportunity for expectancy biases"
> st.oppo.expe <- stand(as.numeric(fac.oppo.expe))
> 
> ### Standardizing "Perceived opportunity for impact of lack of diligence"
> st.oppo.dili <- stand(as.numeric(fac.oppo.dili))
> 
> ### Create scale
> sc.chal <- (st.expe + st.oppo.expe + st.oppo.dili)/3
> 
> # f. EXPERIENCE AND EXPERTISE OF REPLICATION TEAM
> 
> ### Standardizing "Position of senior member of replication team"
> st.posi <- stand(as.numeric(fac.posi))
> 
> ### Standardizing "Highest degree of replication team's senior member"
> st.degr <- stand(as.numeric(fac.degr))
> 
> ### Standardizing "Replication team domain expertise"
> st.doma <- stand(as.numeric(fac.doma))
> 
> ### Standardizing "Replication team method expertise"
> st.meth <- stand(as.numeric(fac.meth))
> 
> ### Standardizing "Replication team senior member's total publications"
> st.publ <- stand(MASTER$Total.publications..R.)
> 
> ### Standardizing "Replication team senior member's total publications and total number of peer-reviewed articles"
> st.peer <- stand(MASTER$Peer.reviewed.articles..R.)
> 
> ### Standardizing "Replication team senior member's total citations"
> st.cita <- stand(MASTER$Citations..R.)
> 
> ### Create scale
> sc.expe2 <- (st.posi + st.degr + st.doma + st.meth + st.publ + st.cita)/6
> 
> # g. SELF-ASSESSED QUALITY OF REPLICATION
> 
> ### Standardizing "Self-assessed quality of replication"
> st.impl <- stand(as.numeric(fac.impl))
> 
> ### Standardizing "Self-assessed data collection quality of replication"
> st.data <- stand(as.numeric(fac.data))
> 
> ### Standardizing "Self-assessed replication similarity to original"
> st.repl <- stand(as.numeric(fac.repl))
> 
> ### Standardizing "Self-assessed difficulty of implementation"
> st.diff <- stand(as.numeric(fac.diff))
> 
> ### Create a scale
> sc.self <- (st.impl + st.data + st.repl + st.diff)/4
> 
> ###########################################
> ### Transforming correlations to Fisher ###
> ###########################################
> 
> ri.o <- MASTER$T_r..O.
> ri.r <- MASTER$T_r..R.
> N.o <- MASTER$T_df2..O.+2
> N.r <- MASTER$T_df2..R.+2
> 
> ### Transform to Fisher's z
> fis.o <- 0.5*log((1 + ri.o) / (1 - ri.o)) 
Warning message:
In log((1 + ri.o)/(1 - ri.o)) : NaNs produced
> fis.r <- 0.5*log((1 + ri.r) / (1 - ri.r))
> 
> ### Difference in Fisher's z scores
> yi <- numeric()
> for(i in 1:length(fis.o)) {
+   
+   if(is.na(fis.o[i]) == TRUE | is.na(fis.r[i]) == TRUE) { yi[i] <- NA }
+   else if(fis.o[i] < 0 & fis.r[i] < 0) { yi[i] <- fis.o[i]*-1-fis.r[i]*-1 } 
+   else if(fis.o[i] < 0 & fis.r[i] > 0) { yi[i] <- fis.o[i]*-1+fis.r[i] }
+   else {  yi[i] <- fis.o[i]-fis.r[i] }
+   
+ }
> 
> ### Standard errors original and replication study
> sei.o <- sqrt(1/(N.o-3))
> sei.r <- sqrt(1/(N.r-3))
> 
> ### p-values original and replication study
> pval.o <- pnorm(fis.o, sd = sei.o, lower.tail = FALSE)
> pval.r <- pnorm(fis.r, sd = sei.r, lower.tail = FALSE)
> 
> ### Standard error of difference score
> sei <- sqrt(1/(N.o-3) + 1/(N.r-3))
> 
> #######################################
> ### Select studies for the analyses ###
> #######################################
> 
> df <- data.frame(ID = MASTER$ID, stat = as.character(MASTER$T_Test.Statistic..O.), df1 = MASTER$T_df1..O., yi, sei, fis.o, sei.o, N.o, pval.o, fis.r, sei.r, N.r, pval.r, 
+                  d.JEP, d.PSCog, d.PSSoc, d.PSOth, sc.impo, sc.surp, sc.expe1, sc.chal, sc.expe2, sc.self, power.r = as.numeric(levels(MASTER$Power..R.))[MASTER$Power..R.])
Warning message:
In data.frame(ID = MASTER$ID, stat = as.character(MASTER$T_Test.Statistic..O.),  :
  NAs introduced by coercion
> df[df$ID == 149, ] <- NA ### Remove duplicate
> 
> ### Select: F(df1 = 1, df2), t, and r
> sub <- subset(df, (df$stat == "F" & df$df1 == 1) | df$stat == "t" | df$stat == "r")
> 
> ### Remove rows when NA on yi
> final <- sub[!is.na(sub$yi) & !is.na(sub$sei), ]
> 
> ####################
> ### Tables Brian ###
> ####################
> 
> ### Load metafor package
> library(metafor)
> 
> ### Meta-analytic mean and sd of the estimate combining per pair the original study and replication 
> est <- pval <- numeric()
> 
> for(i in 1:length(final$fis.o)) {
+   tmp <- rma(yi = c(final$fis.o[i], final$fis.r[i]), sei = c(final$sei.o[i], final$sei.r[i]), method = "FE")
+   est[i] <- tmp$b[1]
+   if (tmp$pval < 0.05) { pval[i] <- TRUE
+   } else { pval[i] <- FALSE }
+ }
> 
> ### Transforming Fisher z values into raw correlations
> cor <- (exp(2*est)-1)/(exp(2*est)+1)
> 
> mean(cor)
[1] 0.3159775
> sd(cor)
[1] 0.2272029
> sum(pval)/length(pval) # Proportion of statistically significant studies
[1] 0.7058824
> 
> ### Per discipline
> mean(cor[final$d.JEP == 0 & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])
[1] 0.134083
> mean(cor[final$d.JEP == 1])
[1] 0.3930916
> mean(cor[final$d.PSSoc == 1])
[1] 0.3042094
> mean(cor[final$d.PSCog == 1])
[1] 0.4991458
> mean(cor[final$d.PSOth == 1])
[1] 0.4077556
> 
> sd(cor[final$d.JEP == 0 & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])
[1] 0.07869599
> sd(cor[final$d.JEP == 1])
[1] 0.2088261
> sd(cor[final$d.PSSoc == 1])
[1] 0.2479659
> sd(cor[final$d.PSCog == 1])
[1] 0.2012314
> sd(cor[final$d.PSOth == 1])
[1] 0.2629947
> 
> sum(pval[final$d.JEP == 0 & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])/length(pval[final$d.JEP == 0 
+                                                                                                        & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])
[1] 0.4210526
> sum(pval[final$d.JEP == 1])/length(pval[final$d.JEP == 1])
[1] 0.8636364
> sum(pval[final$d.PSSoc == 1])/length(pval[final$d.PSSoc == 1])
[1] 0.6428571
> sum(pval[final$d.PSCog == 1])/length(pval[final$d.PSCog == 1])
[1] 1
> sum(pval[final$d.PSOth == 1])/length(pval[final$d.PSOth == 1])
[1] 0.8
> 
> ### Subset of data with all cases which were replicated
> tmp <- subset(df, is.na(df$fis.r) == FALSE)
> summary(tmp$N.o)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
      9      30      56    2728      96  230000       9 
> summary(tmp$N.r)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.     NA's 
     9.0     33.0     70.0   5448.0    146.2 455300.0       10 
> mean(tmp$power.r, na.rm = TRUE)
[1] 0.9180645
> 
> ### Subset of data with all cases published in JPSP
> tmp.JPSP <- subset(tmp, tmp$d.JEP == 0 & tmp$d.PSSoc == 0 & tmp$d.PSCog == 0 & tmp$d.PSOth == 0)
> summary(tmp.JPSP$N.o)
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      NA's 
    28.00     53.75     81.00   8940.00    107.80 230000.00         3 
> summary(tmp.JPSP$N.r)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
     28      70     123   17680     190  455300       3 
> mean(tmp.JPSP$power.r, na.rm = TRUE)
[1] 0.8986207
> 
> ### Subset of data with all cases published in JEP
> tmp.JEP <- subset(tmp, tmp$d.JEP == 1)
> summary(tmp.JEP$N.o)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   9.00   25.50   38.00   57.78   94.50  192.00       1 
> summary(tmp.JEP$N.r)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  16.00   30.50   41.00   70.31   83.20  270.00       1 
> mean(tmp.JEP$power.r, na.rm = TRUE)
[1] 0.9333333
> 
> ### Subset of data with all cases published in PSSoc
> tmp.PSSoc <- subset(tmp, tmp$d.PSSoc == 1)
> summary(tmp.PSSoc$N.o)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   13.0    38.0    83.0   116.3   121.5   564.0       4 
> summary(tmp.PSSoc$N.r)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   32.0    67.0   135.0   312.8   172.0  3513.0       5 
> mean(tmp.PSSoc$power.r, na.rm = TRUE)
[1] 0.9121739
> 
> ### Subset of data with all cases published in PSCog
> tmp.PSCog <- subset(tmp, tmp$d.PSCog == 1)
> summary(tmp.PSCog$N.o)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   9.00   12.00   22.00  101.10   50.25  662.00 
> summary(tmp.PSCog$N.r)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   9.00   18.50   25.00  107.10   98.25  662.00 
> mean(tmp.PSCog$power.r, na.rm = TRUE)
[1] 0.974
> 
> ### Subset of data with all cases published in PSOth
> tmp.PSOth <- subset(tmp, tmp$d.PSOth == 1)
> summary(tmp.PSOth$N.o)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   11.0    16.0    33.0    28.4    36.0    46.0       1 
> summary(tmp.PSOth$N.r)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   10.0    11.0    13.0    25.4    46.0    47.0       1 
> mean(tmp.PSOth$power.r, na.rm = TRUE)
[1] 0.85
> 
> ### How often is original study within CI of replication
> ### Create confidence interval for replications
> ci.lb <- final$fis.r-qnorm(.975)*final$sei.r
> ci.ub <- final$fis.r+qnorm(.975)*final$sei.r
> 
> in.ci <- numeric()
> 
> for(i in 1:length(final$fis.r)) {
+   
+   if (final$fis.o[i] > ci.lb[i] & final$fis.o[i] < ci.ub[i]) {
+     in.ci[i] <- TRUE
+   } else { in.ci[i] <- FALSE }
+   
+ }
> 
> sum(in.ci)/length(in.ci) # Proportion of times the original study is within the CI of the replication
[1] 0.3970588
> 
> ### Per discipline
> sum(in.ci[final$d.JEP == 0 & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])/length(in.ci[final$d.JEP == 0 
+                                                                                                          & final$d.PSSoc == 0 & final$d.PSCog == 0 & final$d.PSOth == 0])
[1] 0.1578947
> sum(in.ci[final$d.JEP == 1])/length(in.ci[final$d.JEP == 1])
[1] 0.5909091
> sum(in.ci[final$d.PSSoc == 1])/length(in.ci[final$d.PSSoc == 1])
[1] 0.2857143
> sum(in.ci[final$d.PSCog == 1])/length(in.ci[final$d.PSCog == 1])
[1] 0.625
> sum(in.ci[final$d.PSOth == 1])/length(in.ci[final$d.PSOth == 1])
[1] 0.4
> 
> #################################################################################
> ### Meta-analyses based on differences between original study and replication ###
> #################################################################################
> 
> ### Meta-analysis of null model
> res <- rma(yi = final$yi, sei = final$sei, method = "REML")
> res

Random-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of total heterogeneity): 0.0244 (SE = 0.0095)
tau (square root of estimated tau^2 value):      0.1562
I^2 (total heterogeneity / total variability):   50.14%
H^2 (total variability / sampling variability):  2.01

Test for Heterogeneity: 
Q(df = 67) = 149.5144, p-val < .0001

Model Results:

estimate       se     zval     pval    ci.lb    ci.ub          
  0.2138   0.0300   7.1310   <.0001   0.1550   0.2726      *** 

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> # png("C:/Users/S787802/Desktop/Funnel RPP.png", width = 900, height = 900, res = 200, pointsize = 5)
> funnel(res, main = "Funnel plot based on difference original and replication study")
> # dev.off()
> 
> ### Meta-analysis with a. PUBLISHING JOURNAL AND SUBDISCIPLINE as moderator (JPSP is reference category)
> rma(yi = final$yi, sei = final$sei, mods = ~ final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0217 (SE = 0.0092)
tau (square root of estimated tau^2 value):             0.1473
I^2 (residual heterogeneity / unaccounted variability): 45.84%
H^2 (unaccounted variability / sampling variability):   1.85
R^2 (amount of heterogeneity accounted for):            11.13%

Test for Residual Heterogeneity: 
QE(df = 63) = 122.2409, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5): 
QM(df = 4) = 6.2163, p-val = 0.1836

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt          0.2558  0.0481   5.3142  <.0001   0.1615  0.3502  ***
final$d.JEP     -0.0337  0.0752  -0.4478  0.6543  -0.1812  0.1138     
final$d.PSCog   -0.1212  0.1159  -1.0455  0.2958  -0.3483  0.1060     
final$d.PSSoc   -0.1253  0.0740  -1.6929  0.0905  -0.2703  0.0198    .
final$d.PSOth    0.2111  0.1620   1.3036  0.1924  -0.1063  0.5286     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with sei.o as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sei.o, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0210 (SE = 0.0088)
tau (square root of estimated tau^2 value):             0.1450
I^2 (residual heterogeneity / unaccounted variability): 45.75%
H^2 (unaccounted variability / sampling variability):   1.84
R^2 (amount of heterogeneity accounted for):            13.84%

Test for Residual Heterogeneity: 
QE(df = 66) = 128.0109, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 3.5717, p-val = 0.0588

Model Results:

             estimate      se    zval    pval    ci.lb   ci.ub   
intrcpt        0.0989  0.0662  1.4950  0.1349  -0.0308  0.2285   
final$sei.o    0.8840  0.4678  1.8899  0.0588  -0.0328  1.8008  .

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with a. PUBLISHING JOURNAL AND SUBDISCIPLINE and sei.o as moderators (JPSP is reference category)
> rma(yi = final$yi, sei = final$sei, mods = ~ final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth + final$sei.o, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0186 (SE = 0.0086)
tau (square root of estimated tau^2 value):             0.1365
I^2 (residual heterogeneity / unaccounted variability): 41.74%
H^2 (unaccounted variability / sampling variability):   1.72
R^2 (amount of heterogeneity accounted for):            23.66%

Test for Residual Heterogeneity: 
QE(df = 62) = 109.9632, p-val = 0.0002

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 10.0237, p-val = 0.0746

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub   
intrcpt          0.1547  0.0721   2.1468  0.0318   0.0135  0.2959  *
final$d.JEP     -0.0742  0.0760  -0.9755  0.3293  -0.2232  0.0748   
final$d.PSCog   -0.1804  0.1167  -1.5456  0.1222  -0.4091  0.0483   
final$d.PSSoc   -0.1234  0.0710  -1.7371  0.0824  -0.2626  0.0158  .
final$d.PSOth    0.1333  0.1649   0.8085  0.4188  -0.1898  0.4564   
final$sei.o      0.9190  0.5083   1.8078  0.0706  -0.0773  1.9153  .

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with b. IMPORTANCE OF THE EFFECT as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.impo, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0252 (SE = 0.0097)
tau (square root of estimated tau^2 value):             0.1587
I^2 (residual heterogeneity / unaccounted variability): 50.36%
H^2 (unaccounted variability / sampling variability):   2.01
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity: 
QE(df = 66) = 147.1462, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.0433, p-val = 0.8351

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt          0.2149  0.0303   7.0816  <.0001   0.1554  0.2744  ***
final$sc.impo   -0.0077  0.0371  -0.2082  0.8351  -0.0805  0.0650     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with c. SURPRISING EFFECT as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.surp, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0251 (SE = 0.0097)
tau (square root of estimated tau^2 value):             0.1585
I^2 (residual heterogeneity / unaccounted variability): 50.65%
H^2 (unaccounted variability / sampling variability):   2.03
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity: 
QE(df = 66) = 149.2397, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.0012, p-val = 0.9720

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt          0.2143  0.0302   7.0944  <.0001   0.1551  0.2735  ***
final$sc.surp   -0.0010  0.0284  -0.0351  0.9720  -0.0567  0.0547     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with d. EXPERIENCE AND EXPERTISE OF ORIGINAL TEAM as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.expe1, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0253 (SE = 0.0098)
tau (square root of estimated tau^2 value):             0.1592
I^2 (residual heterogeneity / unaccounted variability): 50.57%
H^2 (unaccounted variability / sampling variability):   2.02
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity: 
QE(df = 66) = 149.4806, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.0029, p-val = 0.9574

Model Results:

                estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt           0.2145  0.0303   7.0829  <.0001   0.1551  0.2738  ***
final$sc.expe1   -0.0022  0.0408  -0.0535  0.9574  -0.0822  0.0778     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with e. CHALLENGE OF CONDUCTING REPLICATION as moderator
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.chal, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0250 (SE = 0.0097)
tau (square root of estimated tau^2 value):             0.1582
I^2 (residual heterogeneity / unaccounted variability): 50.55%
H^2 (unaccounted variability / sampling variability):   2.02
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity: 
QE(df = 66) = 149.4179, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.3303, p-val = 0.5655

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.2142  0.0302  7.0998  <.0001   0.1551  0.2733  ***
final$sc.chal    0.0202  0.0351  0.5747  0.5655  -0.0486  0.0889     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with f. EXPERIENCE AND EXPERTISE OF REPLICATION TEAM
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.expe2, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0201 (SE = 0.0086)
tau (square root of estimated tau^2 value):             0.1417
I^2 (residual heterogeneity / unaccounted variability): 44.94%
H^2 (unaccounted variability / sampling variability):   1.82
R^2 (amount of heterogeneity accounted for):            17.77%

Test for Residual Heterogeneity: 
QE(df = 66) = 129.8400, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 5.9692, p-val = 0.0146

Model Results:

                estimate      se    zval    pval   ci.lb   ci.ub     
intrcpt           0.2097  0.0286  7.3336  <.0001  0.1536  0.2657  ***
final$sc.expe2    0.1290  0.0528  2.4432  0.0146  0.0255  0.2325    *

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with g. SELF-ASSESSED QUALITY OF REPLICATION
> rma(yi = final$yi, sei = final$sei, mods = ~ final$sc.self, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0240 (SE = 0.0095)
tau (square root of estimated tau^2 value):             0.1549
I^2 (residual heterogeneity / unaccounted variability): 49.37%
H^2 (unaccounted variability / sampling variability):   1.98
R^2 (amount of heterogeneity accounted for):            1.66%

Test for Residual Heterogeneity: 
QE(df = 66) = 141.5509, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 0.5059, p-val = 0.4769

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt          0.2143  0.0299   7.1728  <.0001   0.1557  0.2729  ***
final$sc.self   -0.0420  0.0590  -0.7113  0.4769  -0.1575  0.0736     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ####################################################
> ### Meta-analyses based on only original studies ###
> ####################################################
> 
> ### Meta-analysis of null model
> res <- rma(yi = final$fis.o, sei = final$sei.o, method = "REML")
> res

Random-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of total heterogeneity): 0.0395 (SE = 0.0105)
tau (square root of estimated tau^2 value):      0.1987
I^2 (total heterogeneity / total variability):   74.73%
H^2 (total variability / sampling variability):  3.96

Test for Heterogeneity: 
Q(df = 67) = 297.5265, p-val < .0001

Model Results:

estimate       se     zval     pval    ci.lb    ci.ub          
  0.4319   0.0306  14.1362   <.0001   0.3720   0.4918      *** 

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> # png("C:/Users/S787802/Desktop/Funnel original RPP.png", width = 900, height = 900, res = 200, pointsize = 5)
> funnel(res, main = "Funnel plot based on original studies")
> # dev.off()
> 
> ### Meta-analysis with se in original study as moderator
> rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0253 (SE = 0.0077)
tau (square root of estimated tau^2 value):             0.1590
I^2 (residual heterogeneity / unaccounted variability): 65.17%
H^2 (unaccounted variability / sampling variability):   2.87
R^2 (amount of heterogeneity accounted for):            35.97%

Test for Residual Heterogeneity: 
QE(df = 66) = 203.0927, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 30.2926, p-val < .0001

Model Results:

             estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt        0.1176  0.0610  1.9293  0.0537  -0.0019  0.2372    .
final$sei.o    2.2498  0.4088  5.5039  <.0001   1.4486  3.0509  ***

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in original study as moderator with "ML" as estimator for tau2 (model comparison)
> res0 <- rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o, method = "ML")
> res0

Mixed-Effects Model (k = 68; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0243 (SE = 0.0074)
tau (square root of estimated tau^2 value):             0.1559
I^2 (residual heterogeneity / unaccounted variability): 64.28%
H^2 (unaccounted variability / sampling variability):   2.80
R^2 (amount of heterogeneity accounted for):            37.05%

Test for Residual Heterogeneity: 
QE(df = 66) = 203.0927, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 30.8467, p-val < .0001

Model Results:

             estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt        0.1175  0.0602  1.9513  0.0510  -0.0005  0.2356    .
final$sei.o    2.2505  0.4052  5.5540  <.0001   1.4563  3.0447  ***

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in original study and dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0247 (SE = 0.0079)
tau (square root of estimated tau^2 value):             0.1570
I^2 (residual heterogeneity / unaccounted variability): 63.67%
H^2 (unaccounted variability / sampling variability):   2.75
R^2 (amount of heterogeneity accounted for):            37.53%

Test for Residual Heterogeneity: 
QE(df = 62) = 193.7303, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 35.8662, p-val < .0001

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.0607  0.0680  0.8936  0.3716  -0.0725  0.1939     
final$sei.o      2.0383  0.4567  4.4628  <.0001   1.1431  2.9335  ***
final$d.JEP      0.1326  0.0697  1.9018  0.0572  -0.0041  0.2693    .
final$d.PSCog    0.1257  0.1079  1.1656  0.2438  -0.0857  0.3371     
final$d.PSSoc    0.1322  0.0695  1.9011  0.0573  -0.0041  0.2685    .
final$d.PSOth    0.0977  0.1320  0.7403  0.4591  -0.1609  0.3563     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in original study and dummy variables for journal and discipline (JPSP is reference category) with "ML" as estimator for tau2 (model comparison)
> res1 <- rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "ML")
> res1

Mixed-Effects Model (k = 68; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0218 (SE = 0.0069)
tau (square root of estimated tau^2 value):             0.1476
I^2 (residual heterogeneity / unaccounted variability): 60.74%
H^2 (unaccounted variability / sampling variability):   2.55
R^2 (amount of heterogeneity accounted for):            43.62%

Test for Residual Heterogeneity: 
QE(df = 62) = 193.7303, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 38.0199, p-val < .0001

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.0601  0.0654  0.9191  0.3580  -0.0681  0.1884     
final$sei.o      2.0479  0.4437  4.6159  <.0001   1.1783  2.9174  ***
final$d.JEP      0.1312  0.0672  1.9537  0.0507  -0.0004  0.2629    .
final$d.PSCog    0.1231  0.1042  1.1810  0.2376  -0.0812  0.3273     
final$d.PSSoc    0.1321  0.0667  1.9796  0.0477   0.0013  0.2628    *
final$d.PSOth    0.0964  0.1284  0.7502  0.4532  -0.1554  0.3481     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Comparing models with and without discipline
> anova(res0, res1)
        df      AIC     BIC     AICc  logLik    LRT   pval       QE  tau^2
Full     7 -12.6940  2.8426 -10.8273 13.3470               193.7303 0.0218
Reduced  3 -15.2719 -8.6134 -14.8969 10.6360 5.4221 0.2467 203.0927 0.0243
           R^2
Full          
Reduced 10.43%
> 
> ### Meta-analysis with dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0351 (SE = 0.0100)
tau (square root of estimated tau^2 value):             0.1873
I^2 (residual heterogeneity / unaccounted variability): 71.54%
H^2 (unaccounted variability / sampling variability):   3.51
R^2 (amount of heterogeneity accounted for):            11.11%

Test for Residual Heterogeneity: 
QE(df = 63) = 264.3581, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5): 
QM(df = 4) = 13.7824, p-val = 0.0080

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.2902  0.0511  5.6838  <.0001   0.1901  0.3902  ***
final$d.JEP      0.2304  0.0746  3.0879  0.0020   0.0841  0.3766   **
final$d.PSCog    0.2910  0.1132  2.5711  0.0101   0.0692  0.5129    *
final$d.PSSoc    0.1328  0.0788  1.6856  0.0919  -0.0216  0.2872    .
final$d.PSOth    0.2820  0.1367  2.0638  0.0390   0.0142  0.5499    *

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in original study, dummy variables for journal and discipline (JPSP is reference category), and its interactions as moderators
> rma(yi = final$fis.o, sei = final$sei.o, mods = ~ final$sei.o + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth + final$sei.o*final$d.JEP + final$sei.o*final$d.PSSoc + final$sei.o*final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0260 (SE = 0.0083)
tau (square root of estimated tau^2 value):             0.1611
I^2 (residual heterogeneity / unaccounted variability): 64.61%
H^2 (unaccounted variability / sampling variability):   2.83
R^2 (amount of heterogeneity accounted for):            34.20%

Test for Residual Heterogeneity: 
QE(df = 59) = 190.3223, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6,7,8,9): 
QM(df = 8) = 35.1612, p-val < .0001

Model Results:

                           estimate      se     zval    pval    ci.lb   ci.ub
intrcpt                      0.0606  0.0941   0.6446  0.5192  -0.1238  0.2450
final$sei.o                  2.0372  0.7358   2.7687  0.0056   0.5951  3.4794
final$d.JEP                  0.1064  0.1596   0.6666  0.5050  -0.2065  0.4193
final$d.PSCog                0.1266  0.1173   1.0800  0.2801  -0.1032  0.3564
final$d.PSSoc                0.1763  0.1636   1.0780  0.2811  -0.1443  0.4969
final$d.PSOth                0.0850  0.4101   0.2072  0.8359  -0.7188  0.8887
final$sei.o:final$d.JEP      0.1705  1.0581   0.1611  0.8720  -1.9034  2.2443
final$sei.o:final$d.PSSoc   -0.3970  1.3261  -0.2994  0.7647  -2.9961  2.2021
final$sei.o:final$d.PSOth    0.0650  2.0369   0.0319  0.9745  -3.9273  4.0572
                             
intrcpt                      
final$sei.o                **
final$d.JEP                  
final$d.PSCog                
final$d.PSSoc                
final$d.PSOth                
final$sei.o:final$d.JEP      
final$sei.o:final$d.PSSoc    
final$sei.o:final$d.PSOth    

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> #######################################################
> ### Meta-analyses based on only replication studies ###
> #######################################################
> 
> ### Meta-analysis of null model
> res <- rma(yi = final$fis.r, sei = final$sei.r, method = "REML")
> res

Random-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of total heterogeneity): 0.0707 (SE = 0.0156)
tau (square root of estimated tau^2 value):      0.2660
I^2 (total heterogeneity / total variability):   90.80%
H^2 (total variability / sampling variability):  10.87

Test for Heterogeneity: 
Q(df = 67) = 443.4520, p-val < .0001

Model Results:

estimate       se     zval     pval    ci.lb    ci.ub          
  0.2094   0.0369   5.6794   <.0001   0.1372   0.2817      *** 

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> # png("C:/Users/S787802/Desktop/Funnel replication RPP.png", width = 900, height = 900, res = 200, pointsize = 5)
> funnel(res, main = "Funnel plot based on replication studies")
> # dev.off()
> 
> ### Meta-analysis with se in replication study as moderator
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0576 (SE = 0.0133)
tau (square root of estimated tau^2 value):             0.2400
I^2 (residual heterogeneity / unaccounted variability): 87.96%
H^2 (unaccounted variability / sampling variability):   8.31
R^2 (amount of heterogeneity accounted for):            18.62%

Test for Residual Heterogeneity: 
QE(df = 66) = 395.7621, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 11.3652, p-val = 0.0007

Model Results:

             estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt       -0.0060  0.0714  -0.0838  0.9332  -0.1459  0.1339     
final$sei.r    1.6608  0.4926   3.3712  0.0007   0.6952  2.6263  ***

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in replication study as moderator with "ML" as estimator for tau2 (model comparison)
> res0 <- rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r, method = "ML")
> res0

Mixed-Effects Model (k = 68; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0552 (SE = 0.0126)
tau (square root of estimated tau^2 value):             0.2349
I^2 (residual heterogeneity / unaccounted variability): 87.50%
H^2 (unaccounted variability / sampling variability):   8.00
R^2 (amount of heterogeneity accounted for):            20.16%

Test for Residual Heterogeneity: 
QE(df = 66) = 395.7621, p-val < .0001

Test of Moderators (coefficient(s) 2): 
QM(df = 1) = 11.6932, p-val = 0.0006

Model Results:

             estimate      se     zval    pval    ci.lb   ci.ub     
intrcpt       -0.0063  0.0702  -0.0902  0.9282  -0.1439  0.1313     
final$sei.r    1.6631  0.4864   3.4195  0.0006   0.7099  2.6164  ***

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in replication study and dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0481 (SE = 0.0119)
tau (square root of estimated tau^2 value):             0.2194
I^2 (residual heterogeneity / unaccounted variability): 84.12%
H^2 (unaccounted variability / sampling variability):   6.30
R^2 (amount of heterogeneity accounted for):            31.95%

Test for Residual Heterogeneity: 
QE(df = 62) = 310.4820, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 25.2349, p-val = 0.0001

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub    
intrcpt         -0.1126  0.0768  -1.4663  0.1426  -0.2632  0.0379    
final$sei.r      1.5667  0.5788   2.7069  0.0068   0.4323  2.7012  **
final$d.JEP      0.1468  0.0890   1.6499  0.0990  -0.0276  0.3212   .
final$d.PSCog    0.2866  0.1272   2.2528  0.0243   0.0372  0.5359   *
final$d.PSSoc    0.2243  0.0851   2.6348  0.0084   0.0574  0.3911  **
final$d.PSOth   -0.1105  0.1759  -0.6281  0.5299  -0.4553  0.2343    

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in replication study and dummy variables for journal and discipline (JPSP is reference category) with "ML" as estimator for tau2 (model comparison)
> res1 <- rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "ML")
> res1

Mixed-Effects Model (k = 68; tau^2 estimator: ML)

tau^2 (estimated amount of residual heterogeneity):     0.0417 (SE = 0.0101)
tau (square root of estimated tau^2 value):             0.2041
I^2 (residual heterogeneity / unaccounted variability): 82.10%
H^2 (unaccounted variability / sampling variability):   5.59
R^2 (amount of heterogeneity accounted for):            39.68%

Test for Residual Heterogeneity: 
QE(df = 62) = 310.4820, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 27.6720, p-val < .0001

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub    
intrcpt         -0.1123  0.0727  -1.5458  0.1222  -0.2547  0.0301    
final$sei.r      1.5723  0.5536   2.8403  0.0045   0.4873  2.6573  **
final$d.JEP      0.1449  0.0843   1.7188  0.0857  -0.0203  0.3101   .
final$d.PSCog    0.2853  0.1209   2.3597  0.0183   0.0483  0.5222   *
final$d.PSSoc    0.2229  0.0802   2.7807  0.0054   0.0658  0.3801  **
final$d.PSOth   -0.1129  0.1684  -0.6703  0.5027  -0.4430  0.2172    

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Comparing models with and without discipline
> anova(res0, res1)
        df     AIC     BIC    AICc   logLik     LRT   pval       QE  tau^2
Full     7 30.5650 46.1015 32.4316  -8.2825                310.4820 0.0417
Reduced  3 35.0419 41.7004 35.4169 -14.5210 12.4769 0.0141 395.7621 0.0552
           R^2
Full          
Reduced 24.45%
> 
> ### Meta-analysis with se in replication study and dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0481 (SE = 0.0119)
tau (square root of estimated tau^2 value):             0.2194
I^2 (residual heterogeneity / unaccounted variability): 84.12%
H^2 (unaccounted variability / sampling variability):   6.30
R^2 (amount of heterogeneity accounted for):            31.95%

Test for Residual Heterogeneity: 
QE(df = 62) = 310.4820, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6): 
QM(df = 5) = 25.2349, p-val = 0.0001

Model Results:

               estimate      se     zval    pval    ci.lb   ci.ub    
intrcpt         -0.1126  0.0768  -1.4663  0.1426  -0.2632  0.0379    
final$sei.r      1.5667  0.5788   2.7069  0.0068   0.4323  2.7012  **
final$d.JEP      0.1468  0.0890   1.6499  0.0990  -0.0276  0.3212   .
final$d.PSCog    0.2866  0.1272   2.2528  0.0243   0.0372  0.5359   *
final$d.PSSoc    0.2243  0.0851   2.6348  0.0084   0.0574  0.3911  **
final$d.PSOth   -0.1105  0.1759  -0.6281  0.5299  -0.4553  0.2343    

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with dummy variables for journal and discipline (JPSP is reference category)
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0559 (SE = 0.0133)
tau (square root of estimated tau^2 value):             0.2365
I^2 (residual heterogeneity / unaccounted variability): 86.74%
H^2 (unaccounted variability / sampling variability):   7.54
R^2 (amount of heterogeneity accounted for):            20.95%

Test for Residual Heterogeneity: 
QE(df = 63) = 358.4831, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5): 
QM(df = 4) = 16.2364, p-val = 0.0027

Model Results:

               estimate      se    zval    pval    ci.lb   ci.ub     
intrcpt          0.0318  0.0589  0.5394  0.5896  -0.0837  0.1473     
final$d.JEP      0.2507  0.0855  2.9316  0.0034   0.0831  0.4183   **
final$d.PSCog    0.4215  0.1238  3.4036  0.0007   0.1788  0.6642  ***
final$d.PSSoc    0.2286  0.0907  2.5203  0.0117   0.0508  0.4064    *
final$d.PSOth    0.1060  0.1646  0.6436  0.5198  -0.2167  0.4286     

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ### Meta-analysis with se in replication study, dummy variables for journal and discipline (JPSP is reference category), and its interactions as moderators
> rma(yi = final$fis.r, sei = final$sei.r, mods = ~ final$sei.r + final$d.JEP + final$d.PSCog + final$d.PSSoc + final$d.PSOth + final$sei.r*final$d.JEP + final$sei.r*final$d.PSSoc + final$sei.r*final$d.PSOth, method = "REML")

Mixed-Effects Model (k = 68; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0508 (SE = 0.0126)
tau (square root of estimated tau^2 value):             0.2255
I^2 (residual heterogeneity / unaccounted variability): 83.34%
H^2 (unaccounted variability / sampling variability):   6.00
R^2 (amount of heterogeneity accounted for):            28.13%

Test for Residual Heterogeneity: 
QE(df = 59) = 307.0384, p-val < .0001

Test of Moderators (coefficient(s) 2,3,4,5,6,7,8,9): 
QM(df = 8) = 25.5954, p-val = 0.0012

Model Results:

                           estimate      se     zval    pval    ci.lb   ci.ub
intrcpt                     -0.0374  0.1053  -0.3553  0.7224  -0.2437  0.1689
final$sei.r                  0.7488  0.9611   0.7792  0.4359  -1.1348  2.6324
final$d.JEP                 -0.0111  0.1985  -0.0557  0.9556  -0.4001  0.3780
final$d.PSCog                0.3559  0.1447   2.4592  0.0139   0.0723  0.6396
final$d.PSSoc                0.0740  0.1960   0.3778  0.7056  -0.3100  0.4581
final$d.PSOth               -0.2088  0.3985  -0.5239  0.6003  -0.9898  0.5722
final$sei.r:final$d.JEP      1.3454  1.3874   0.9697  0.3322  -1.3738  4.0646
final$sei.r:final$d.PSSoc    1.6169  1.8735   0.8631  0.3881  -2.0550  5.2889
final$sei.r:final$d.PSOth    0.9201  1.8251   0.5041  0.6142  -2.6571  4.4974
                            
intrcpt                     
final$sei.r                 
final$d.JEP                 
final$d.PSCog              *
final$d.PSSoc               
final$d.PSOth               
final$sei.r:final$d.JEP     
final$sei.r:final$d.PSSoc   
final$sei.r:final$d.PSOth   

---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> 
> ##############################
> ### Meta-analyses per pair ###
> ##############################
> 
> ### How often is the null hypotheses rejected in the meta-analysis
> in.ci <- es.meta <- se.meta <- ci.lb.meta <- ci.ub.meta <- pval.meta <- numeric()
> 
> for(i in 1:length(final$fis.o)) {
+   tmp <- rma(yi = c(final$fis.o[i], final$fis.r[i]), sei = c(final$sei.o[i], final$sei.r[i]), method = "FE")
+   es.meta[i] <- tmp$b[1]
+   se.meta[i] <- tmp$se
+   ci.lb.meta[i] <- tmp$ci.lb
+   ci.ub.meta[i] <- tmp$ci.ub
+   pval.meta[i] <- tmp$pval
+   
+   if(tmp$pval < 0.05) { in.ci[i] <- 1
+   } else { in.ci[i] <- 0 }
+ }
> 
> sum(in.ci)/length(in.ci) # Proportion of times the null hypothesis of no effect is rejected
[1] 0.7058824
> 
> ### Create data frame
> tab <- data.frame(ID = final$ID, fis.o = final$fis.o, sei.o = final$sei.o, pval.o = final$pval.o, fis.r = final$fis.r, sei.r = final$sei.r, 
+                   pval.r = final$pval.r, diff = final$yi, es.meta = es.meta, se.meta = se.meta, ci.lb.meta = ci.lb.meta, ci.ub.meta = ci.ub.meta, pval.meta = pval.meta)
> 
> ### Check how often effect size original study is within CI of meta-analysis
> in.ci.meta <- numeric()
> 
> for(i in 1:length(final$fis.o)) {
+   
+   if(final$fis.o[i] > ci.lb.meta[i] & final$fis.o[i] < ci.ub.meta[i]) {
+     in.ci.meta[i] <- TRUE
+   } else { in.ci.meta[i] <- FALSE }
+   
+ }
> 
> sum(in.ci.meta)/length(in.ci.meta) # Proportion of times the original study is within the CI of meta-analysis
[1] 0.5735294
> 
> ######################################################################################
> ### Predicting how often effect size of original study is within CI of replication ###
> ######################################################################################
> 
> ### Predicting how often effect size of original study is within CI of replication
> overlap <- numeric()
> points <- 1000000
> p <- 1:points/(points+1)
> 
> for (i in 1:length(final$N.r)) {
+   zu <- qnorm(p,0,1/sqrt(final$N.r[i]-3)) + qnorm(.975)/sqrt(final$N.r[i]-3)
+   zl <- zu - 2*qnorm(.975)/sqrt(final$N.r[i]-3)
+   overlap[i] <- mean(pnorm(zu,0,1/sqrt(final$N.o[i]-3))) - mean(pnorm(zl,0,1/sqrt(final$N.o[i]-3)))
+ }
> overlap
 [1] 0.7230489 0.8342246 0.8033464 0.7929864 0.7818304 0.7976371 0.9344699
 [8] 0.8522521 0.8303252 0.7941837 0.6996958 0.8787363 0.8208099 0.9130317
[15] 0.8365067 0.7193794 0.6749298 0.7292801 0.8312130 0.8342246 0.8342246
[22] 0.7758322 0.6949578 0.7344564 0.7000259 0.8508379 0.7121914 0.9050646
[29] 0.7820982 0.7385099 0.7306008 0.6582552 0.7484706 0.8942939 0.8383796
[36] 0.7823072 0.8427805 0.8342246 0.8540522 0.7179258 0.3265906 0.8005429
[43] 0.7529083 0.8894029 0.7320969 0.8342246 0.7928042 0.8342246 0.9224120
[50] 0.8551690 0.7916176 0.7051984 0.7397986 0.8461565 0.7038225 0.7726095
[57] 0.7387346 0.5331224 0.7392696 0.8944217 0.8593898 0.8002104 0.7926131
[64] 0.6684134 0.8342246 0.7061323 0.8342246 0.8086667
> mean(overlap)
[1] 0.7826559
> 
> #######################################
> ### Correlations between moderators ###
> #######################################
> 
> ### Load package for correlation table
> library(Hmisc)
> 
> ### Create variable with meta-analysis estimate with NAs
> es.meta.all <- vector(length = nrow(df))
> s <- 1
> for(i in 1:max(final$ID)) {
+   if (i == final$ID[s]) {
+     es.meta.all[i] <- es.meta[s]
+     s <- s + 1
+   } else {
+     es.meta.all[i] <- NA
+   }
+ }
> 
> ### Create matrix for correlation table
> mat <- cbind(df$fis.o, df$fis.r, df$yi, es.meta.all, df$sc.imp, df$sc.surp, df$sc.expe1, df$sc.chal, df$sc.expe2, df$sc.self)
> colnames(mat) <- c("fis.o", "fis.r", "diff", "es.meta", "importance", "surprising", "experience.O", "challenge", "experience.R", "quality")
> 
> ### Subset of only the replicated studies
> mat <- subset(mat, is.na(df$fis.r) == FALSE)
> 
> ### Create table with correlations
> rcorr(mat, type = "spearman")
             fis.o fis.r  diff es.meta importance surprising experience.O
fis.o         1.00  0.51  0.31    0.80      -0.13      -0.15        -0.11
fis.r         0.51  1.00 -0.57    0.85      -0.15      -0.14        -0.11
diff          0.31 -0.57  1.00   -0.21       0.02       0.06        -0.03
es.meta       0.80  0.85 -0.21    1.00      -0.29      -0.24        -0.13
importance   -0.13 -0.15  0.02   -0.29       1.00       0.44         0.36
surprising   -0.15 -0.14  0.06   -0.24       0.44       1.00         0.10
experience.O -0.11 -0.11 -0.03   -0.13       0.36       0.10         1.00
challenge    -0.19 -0.24  0.09   -0.30       0.22       0.19         0.12
experience.R  0.15  0.05  0.13    0.00       0.05       0.12        -0.11
quality      -0.10 -0.04  0.01    0.03       0.17       0.03         0.22
             challenge experience.R quality
fis.o            -0.19         0.15   -0.10
fis.r            -0.24         0.05   -0.04
diff              0.09         0.13    0.01
es.meta          -0.30         0.00    0.03
importance        0.22         0.05    0.17
surprising        0.19         0.12    0.03
experience.O      0.12        -0.11    0.22
challenge         1.00         0.06    0.12
experience.R      0.06         1.00   -0.09
quality           0.12        -0.09    1.00

n
             fis.o fis.r diff es.meta importance surprising experience.O
fis.o           96    96   96      68         96         96           96
fis.r           96    96   96      68         96         96           96
diff            96    96   96      68         96         96           96
es.meta         68    68   68      96         68         68           68
importance      96    96   96      68         96         96           96
surprising      96    96   96      68         96         96           96
experience.O    96    96   96      68         96         96           96
challenge       96    96   96      68         96         96           96
experience.R    95    95   95      68         95         95           95
quality         96    96   96      68         96         96           96
             challenge experience.R quality
fis.o               96           95      96
fis.r               96           95      96
diff                96           95      96
es.meta             68           68      68
importance          96           95      96
surprising          96           95      96
experience.O        96           95      96
challenge           96           95      96
experience.R        95           96      95
quality             96           95      96

P
             fis.o  fis.r  diff   es.meta importance surprising experience.O
fis.o               0.0000 0.0023 0.0000  0.2211     0.1330     0.2958      
fis.r        0.0000        0.0000 0.0000  0.1506     0.1630     0.2968      
diff         0.0023 0.0000        0.0827  0.8560     0.5618     0.7575      
es.meta      0.0000 0.0000 0.0827         0.0160     0.0514     0.2946      
importance   0.2211 0.1506 0.8560 0.0160             0.0000     0.0004      
surprising   0.1330 0.1630 0.5618 0.0514  0.0000                0.3290      
experience.O 0.2958 0.2968 0.7575 0.2946  0.0004     0.3290                 
challenge    0.0620 0.0178 0.3792 0.0137  0.0348     0.0604     0.2622      
experience.R 0.1378 0.6375 0.2001 0.9931  0.6288     0.2383     0.2976      
quality      0.3107 0.6850 0.9047 0.8367  0.0882     0.7856     0.0325      
             challenge experience.R quality
fis.o        0.0620    0.1378       0.3107 
fis.r        0.0178    0.6375       0.6850 
diff         0.3792    0.2001       0.9047 
es.meta      0.0137    0.9931       0.8367 
importance   0.0348    0.6288       0.0882 
surprising   0.0604    0.2383       0.7856 
experience.O 0.2622    0.2976       0.0325 
challenge              0.5618       0.2485 
experience.R 0.5618                 0.3957 
quality      0.2485    0.3957              
> 
